"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/neural/stream";
exports.ids = ["pages/api/neural/stream"];
exports.modules = {

/***/ "(api-node)/../scing/bane/core/aggregate.ts":
/*!***************************************!*\
  !*** ../scing/bane/core/aggregate.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   aggregate: () => (/* binding */ aggregate)\n/* harmony export */ });\nconst severityRank = {\n    low: 1,\n    medium: 2,\n    high: 3,\n    critical: 4\n};\nconst verdictRank = {\n    allow: 1,\n    sanitize: 2,\n    review: 3,\n    deny: 4\n};\nfunction aggregate(findings) {\n    if (!findings.length) return {\n        verdict: 'allow',\n        severity: 'low'\n    };\n    let maxSeverity = 'low';\n    let maxVerdict = 'allow';\n    for (const f of findings){\n        if (severityRank[f.severity] > severityRank[maxSeverity]) maxSeverity = f.severity;\n        if (verdictRank[f.verdict] > verdictRank[maxVerdict]) maxVerdict = f.verdict;\n    }\n    return {\n        verdict: maxVerdict,\n        severity: maxSeverity\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvYWdncmVnYXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFFQSxNQUFNQSxlQUE2QztJQUNqREMsS0FBSztJQUNMQyxRQUFRO0lBQ1JDLE1BQU07SUFDTkMsVUFBVTtBQUNaO0FBRUEsTUFBTUMsY0FBMkM7SUFDL0NDLE9BQU87SUFDUEMsVUFBVTtJQUNWQyxRQUFRO0lBQ1JDLE1BQU07QUFDUjtBQUVPLFNBQVNDLFVBQVVDLFFBQXVCO0lBSS9DLElBQUksQ0FBQ0EsU0FBU0MsTUFBTSxFQUFFLE9BQU87UUFBRUMsU0FBUztRQUFTQyxVQUFVO0lBQU07SUFFakUsSUFBSUMsY0FBNEI7SUFDaEMsSUFBSUMsYUFBMEI7SUFFOUIsS0FBSyxNQUFNQyxLQUFLTixTQUFVO1FBQ3hCLElBQUlYLFlBQVksQ0FBQ2lCLEVBQUVILFFBQVEsQ0FBQyxHQUFHZCxZQUFZLENBQUNlLFlBQVksRUFBRUEsY0FBY0UsRUFBRUgsUUFBUTtRQUNsRixJQUFJVCxXQUFXLENBQUNZLEVBQUVKLE9BQU8sQ0FBQyxHQUFHUixXQUFXLENBQUNXLFdBQVcsRUFBRUEsYUFBYUMsRUFBRUosT0FBTztJQUM5RTtJQUVBLE9BQU87UUFBRUEsU0FBU0c7UUFBWUYsVUFBVUM7SUFBWTtBQUN0RCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcY29yZVxcYWdncmVnYXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZUZpbmRpbmcsIEJhbmVTZXZlcml0eSwgQmFuZVZlcmRpY3QgfSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IHNldmVyaXR5UmFuazogUmVjb3JkPEJhbmVTZXZlcml0eSwgbnVtYmVyPiA9IHtcbiAgbG93OiAxLFxuICBtZWRpdW06IDIsXG4gIGhpZ2g6IDMsXG4gIGNyaXRpY2FsOiA0LFxufTtcblxuY29uc3QgdmVyZGljdFJhbms6IFJlY29yZDxCYW5lVmVyZGljdCwgbnVtYmVyPiA9IHtcbiAgYWxsb3c6IDEsXG4gIHNhbml0aXplOiAyLFxuICByZXZpZXc6IDMsXG4gIGRlbnk6IDQsXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gYWdncmVnYXRlKGZpbmRpbmdzOiBCYW5lRmluZGluZ1tdKToge1xuICB2ZXJkaWN0OiBCYW5lVmVyZGljdDtcbiAgc2V2ZXJpdHk6IEJhbmVTZXZlcml0eTtcbn0ge1xuICBpZiAoIWZpbmRpbmdzLmxlbmd0aCkgcmV0dXJuIHsgdmVyZGljdDogJ2FsbG93Jywgc2V2ZXJpdHk6ICdsb3cnIH07XG5cbiAgbGV0IG1heFNldmVyaXR5OiBCYW5lU2V2ZXJpdHkgPSAnbG93JztcbiAgbGV0IG1heFZlcmRpY3Q6IEJhbmVWZXJkaWN0ID0gJ2FsbG93JztcblxuICBmb3IgKGNvbnN0IGYgb2YgZmluZGluZ3MpIHtcbiAgICBpZiAoc2V2ZXJpdHlSYW5rW2Yuc2V2ZXJpdHldID4gc2V2ZXJpdHlSYW5rW21heFNldmVyaXR5XSkgbWF4U2V2ZXJpdHkgPSBmLnNldmVyaXR5O1xuICAgIGlmICh2ZXJkaWN0UmFua1tmLnZlcmRpY3RdID4gdmVyZGljdFJhbmtbbWF4VmVyZGljdF0pIG1heFZlcmRpY3QgPSBmLnZlcmRpY3Q7XG4gIH1cblxuICByZXR1cm4geyB2ZXJkaWN0OiBtYXhWZXJkaWN0LCBzZXZlcml0eTogbWF4U2V2ZXJpdHkgfTtcbn1cbiJdLCJuYW1lcyI6WyJzZXZlcml0eVJhbmsiLCJsb3ciLCJtZWRpdW0iLCJoaWdoIiwiY3JpdGljYWwiLCJ2ZXJkaWN0UmFuayIsImFsbG93Iiwic2FuaXRpemUiLCJyZXZpZXciLCJkZW55IiwiYWdncmVnYXRlIiwiZmluZGluZ3MiLCJsZW5ndGgiLCJ2ZXJkaWN0Iiwic2V2ZXJpdHkiLCJtYXhTZXZlcml0eSIsIm1heFZlcmRpY3QiLCJmIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/aggregate.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/core/detectors.baseline.ts":
/*!************************************************!*\
  !*** ../scing/bane/core/detectors.baseline.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   baselineDetectors: () => (/* binding */ baselineDetectors)\n/* harmony export */ });\n/* harmony import */ var _detectors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./detectors */ \"(api-node)/../scing/bane/core/detectors.ts\");\n\nfunction txt(input) {\n    return (input.text || '').toLowerCase();\n}\nfunction hasAny(t, needles) {\n    return needles.some((n)=>t.includes(n));\n}\n// High-level indicators only (do not expose internal rules to requesters).\nconst INTRUSION_HINTS = [\n    'ignore previous',\n    'system prompt',\n    'developer message',\n    'override policy',\n    'bypass',\n    'jailbreak',\n    'disable safety',\n    'act as'\n];\nconst EXFIL_HINTS = [\n    'api key',\n    'secret',\n    'token',\n    'password',\n    'credentials',\n    'private key',\n    'dump'\n];\nconst MALWARE_HINTS = [\n    'malware',\n    'ransomware',\n    'keylogger',\n    'exploit',\n    'payload',\n    'backdoor'\n];\nconst PRIV_ESC_HINTS = [\n    'admin',\n    'elevate privilege',\n    'root access',\n    'operator mode',\n    'policy admin'\n];\nfunction baselineDetectors() {\n    return [\n        {\n            id: 'BASE_INTRUSION_LANGUAGE',\n            order: 10,\n            detect: (input)=>{\n                const t = txt({\n                    text: input.text\n                });\n                if (!t) return [];\n                if (hasAny(t, INTRUSION_HINTS)) {\n                    return [\n                        (0,_detectors__WEBPACK_IMPORTED_MODULE_0__.finding)({\n                            id: 'INTRUSION_INDICATOR',\n                            title: 'Intrusion / override indicator detected',\n                            severity: 'high',\n                            verdict: 'deny',\n                            rationale: 'Input contains language commonly associated with bypassing controls.',\n                            tags: [\n                                'intrusion',\n                                'baseline'\n                            ]\n                        })\n                    ];\n                }\n                return [];\n            }\n        },\n        {\n            id: 'BASE_EXFIL_LANGUAGE',\n            order: 20,\n            detect: (input)=>{\n                const t = txt({\n                    text: input.text\n                });\n                if (!t) return [];\n                if (hasAny(t, EXFIL_HINTS)) {\n                    return [\n                        (0,_detectors__WEBPACK_IMPORTED_MODULE_0__.finding)({\n                            id: 'EXFIL_INDICATOR',\n                            title: 'Potential data exfiltration intent detected',\n                            severity: 'high',\n                            verdict: 'deny',\n                            rationale: 'Input suggests an attempt to obtain sensitive credentials or restricted data.',\n                            tags: [\n                                'exfil',\n                                'baseline'\n                            ]\n                        })\n                    ];\n                }\n                return [];\n            }\n        },\n        {\n            id: 'BASE_PRIV_ESC_LANGUAGE',\n            order: 30,\n            detect: (input)=>{\n                const t = txt({\n                    text: input.text\n                });\n                if (!t) return [];\n                if (hasAny(t, PRIV_ESC_HINTS)) {\n                    return [\n                        (0,_detectors__WEBPACK_IMPORTED_MODULE_0__.finding)({\n                            id: 'PRIV_ESC_INDICATOR',\n                            title: 'Privilege escalation indicator detected',\n                            severity: 'high',\n                            verdict: 'deny',\n                            rationale: 'Input indicates an attempt to access privileged operator/admin actions.',\n                            tags: [\n                                'privilege',\n                                'baseline'\n                            ]\n                        })\n                    ];\n                }\n                return [];\n            }\n        },\n        {\n            id: 'BASE_MALWARE_LANGUAGE',\n            order: 40,\n            detect: (input)=>{\n                const t = txt({\n                    text: input.text\n                });\n                if (!t) return [];\n                if (hasAny(t, MALWARE_HINTS)) {\n                    return [\n                        (0,_detectors__WEBPACK_IMPORTED_MODULE_0__.finding)({\n                            id: 'MALWARE_INDICATOR',\n                            title: 'Malicious content indicator detected',\n                            severity: 'critical',\n                            verdict: 'deny',\n                            rationale: 'Input contains terms commonly associated with malware/exploit activity.',\n                            tags: [\n                                'malware',\n                                'baseline'\n                            ]\n                        })\n                    ];\n                }\n                return [];\n            }\n        },\n        {\n            id: 'BASE_PII_REVIEW',\n            order: 50,\n            detect: (input)=>{\n                const t = input.text || '';\n                const looksLikeEmail = /\\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\b/i.test(t);\n                const looksLikePhone = /\\b(\\+?1[\\s-]?)?(\\(?\\d{3}\\)?[\\s-]?)\\d{3}[\\s-]?\\d{4}\\b/.test(t);\n                if (looksLikeEmail || looksLikePhone) {\n                    return [\n                        (0,_detectors__WEBPACK_IMPORTED_MODULE_0__.finding)({\n                            id: 'PII_POSSIBLE',\n                            title: 'Possible personal data detected',\n                            severity: 'medium',\n                            verdict: 'sanitize',\n                            rationale: 'Input may contain personal contact information; redaction recommended.',\n                            tags: [\n                                'pii',\n                                'baseline'\n                            ],\n                            evidence: looksLikeEmail ? 'email-like pattern' : 'phone-like pattern'\n                        })\n                    ];\n                }\n                return [];\n            }\n        }\n    ];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvZGV0ZWN0b3JzLmJhc2VsaW5lLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQ3NDO0FBRXRDLFNBQVNDLElBQUlDLEtBQXVCO0lBQ2xDLE9BQU8sQ0FBQ0EsTUFBTUMsSUFBSSxJQUFJLEVBQUMsRUFBR0MsV0FBVztBQUN2QztBQUVBLFNBQVNDLE9BQU9DLENBQVMsRUFBRUMsT0FBaUI7SUFDMUMsT0FBT0EsUUFBUUMsSUFBSSxDQUFDLENBQUNDLElBQU1ILEVBQUVJLFFBQVEsQ0FBQ0Q7QUFDeEM7QUFFQSwyRUFBMkU7QUFDM0UsTUFBTUUsa0JBQWtCO0lBQ3RCO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUVELE1BQU1DLGNBQWM7SUFDbEI7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUVELE1BQU1DLGdCQUFnQjtJQUFDO0lBQVc7SUFBYztJQUFhO0lBQVc7SUFBVztDQUFXO0FBRTlGLE1BQU1DLGlCQUFpQjtJQUNyQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0Q7QUFFTSxTQUFTQztJQUNkLE9BQU87UUFDTDtZQUNFQyxJQUFJO1lBQ0pDLE9BQU87WUFDUEMsUUFBUSxDQUFDaEI7Z0JBQ1AsTUFBTUksSUFBSUwsSUFBSTtvQkFBRUUsTUFBTUQsTUFBTUMsSUFBSTtnQkFBQztnQkFDakMsSUFBSSxDQUFDRyxHQUFHLE9BQU8sRUFBRTtnQkFDakIsSUFBSUQsT0FBT0MsR0FBR0ssa0JBQWtCO29CQUM5QixPQUFPO3dCQUNMWCxtREFBT0EsQ0FBQzs0QkFDTmdCLElBQUk7NEJBQ0pHLE9BQU87NEJBQ1BDLFVBQVU7NEJBQ1ZDLFNBQVM7NEJBQ1RDLFdBQVc7NEJBQ1hDLE1BQU07Z0NBQUM7Z0NBQWE7NkJBQVc7d0JBQ2pDO3FCQUNEO2dCQUNIO2dCQUNBLE9BQU8sRUFBRTtZQUNYO1FBQ0Y7UUFDQTtZQUNFUCxJQUFJO1lBQ0pDLE9BQU87WUFDUEMsUUFBUSxDQUFDaEI7Z0JBQ1AsTUFBTUksSUFBSUwsSUFBSTtvQkFBRUUsTUFBTUQsTUFBTUMsSUFBSTtnQkFBQztnQkFDakMsSUFBSSxDQUFDRyxHQUFHLE9BQU8sRUFBRTtnQkFDakIsSUFBSUQsT0FBT0MsR0FBR00sY0FBYztvQkFDMUIsT0FBTzt3QkFDTFosbURBQU9BLENBQUM7NEJBQ05nQixJQUFJOzRCQUNKRyxPQUFPOzRCQUNQQyxVQUFVOzRCQUNWQyxTQUFTOzRCQUNUQyxXQUNFOzRCQUNGQyxNQUFNO2dDQUFDO2dDQUFTOzZCQUFXO3dCQUM3QjtxQkFDRDtnQkFDSDtnQkFDQSxPQUFPLEVBQUU7WUFDWDtRQUNGO1FBQ0E7WUFDRVAsSUFBSTtZQUNKQyxPQUFPO1lBQ1BDLFFBQVEsQ0FBQ2hCO2dCQUNQLE1BQU1JLElBQUlMLElBQUk7b0JBQUVFLE1BQU1ELE1BQU1DLElBQUk7Z0JBQUM7Z0JBQ2pDLElBQUksQ0FBQ0csR0FBRyxPQUFPLEVBQUU7Z0JBQ2pCLElBQUlELE9BQU9DLEdBQUdRLGlCQUFpQjtvQkFDN0IsT0FBTzt3QkFDTGQsbURBQU9BLENBQUM7NEJBQ05nQixJQUFJOzRCQUNKRyxPQUFPOzRCQUNQQyxVQUFVOzRCQUNWQyxTQUFTOzRCQUNUQyxXQUFXOzRCQUNYQyxNQUFNO2dDQUFDO2dDQUFhOzZCQUFXO3dCQUNqQztxQkFDRDtnQkFDSDtnQkFDQSxPQUFPLEVBQUU7WUFDWDtRQUNGO1FBQ0E7WUFDRVAsSUFBSTtZQUNKQyxPQUFPO1lBQ1BDLFFBQVEsQ0FBQ2hCO2dCQUNQLE1BQU1JLElBQUlMLElBQUk7b0JBQUVFLE1BQU1ELE1BQU1DLElBQUk7Z0JBQUM7Z0JBQ2pDLElBQUksQ0FBQ0csR0FBRyxPQUFPLEVBQUU7Z0JBQ2pCLElBQUlELE9BQU9DLEdBQUdPLGdCQUFnQjtvQkFDNUIsT0FBTzt3QkFDTGIsbURBQU9BLENBQUM7NEJBQ05nQixJQUFJOzRCQUNKRyxPQUFPOzRCQUNQQyxVQUFVOzRCQUNWQyxTQUFTOzRCQUNUQyxXQUFXOzRCQUNYQyxNQUFNO2dDQUFDO2dDQUFXOzZCQUFXO3dCQUMvQjtxQkFDRDtnQkFDSDtnQkFDQSxPQUFPLEVBQUU7WUFDWDtRQUNGO1FBQ0E7WUFDRVAsSUFBSTtZQUNKQyxPQUFPO1lBQ1BDLFFBQVEsQ0FBQ2hCO2dCQUNQLE1BQU1JLElBQUlKLE1BQU1DLElBQUksSUFBSTtnQkFDeEIsTUFBTXFCLGlCQUFpQiw2Q0FBNkNDLElBQUksQ0FBQ25CO2dCQUN6RSxNQUFNb0IsaUJBQWlCLHVEQUF1REQsSUFBSSxDQUFDbkI7Z0JBQ25GLElBQUlrQixrQkFBa0JFLGdCQUFnQjtvQkFDcEMsT0FBTzt3QkFDTDFCLG1EQUFPQSxDQUFDOzRCQUNOZ0IsSUFBSTs0QkFDSkcsT0FBTzs0QkFDUEMsVUFBVTs0QkFDVkMsU0FBUzs0QkFDVEMsV0FBVzs0QkFDWEMsTUFBTTtnQ0FBQztnQ0FBTzs2QkFBVzs0QkFDekJJLFVBQVVILGlCQUFpQix1QkFBdUI7d0JBQ3BEO3FCQUNEO2dCQUNIO2dCQUNBLE9BQU8sRUFBRTtZQUNYO1FBQ0Y7S0FDRDtBQUNIIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxjb3JlXFxkZXRlY3RvcnMuYmFzZWxpbmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBEZXRlY3RvciB9IGZyb20gJy4vZGV0ZWN0b3JzJztcbmltcG9ydCB7IGZpbmRpbmcgfSBmcm9tICcuL2RldGVjdG9ycyc7XG5cbmZ1bmN0aW9uIHR4dChpbnB1dDogeyB0ZXh0OiBzdHJpbmcgfSkge1xuICByZXR1cm4gKGlucHV0LnRleHQgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIGhhc0FueSh0OiBzdHJpbmcsIG5lZWRsZXM6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gIHJldHVybiBuZWVkbGVzLnNvbWUoKG4pID0+IHQuaW5jbHVkZXMobikpO1xufVxuXG4vLyBIaWdoLWxldmVsIGluZGljYXRvcnMgb25seSAoZG8gbm90IGV4cG9zZSBpbnRlcm5hbCBydWxlcyB0byByZXF1ZXN0ZXJzKS5cbmNvbnN0IElOVFJVU0lPTl9ISU5UUyA9IFtcbiAgJ2lnbm9yZSBwcmV2aW91cycsXG4gICdzeXN0ZW0gcHJvbXB0JyxcbiAgJ2RldmVsb3BlciBtZXNzYWdlJyxcbiAgJ292ZXJyaWRlIHBvbGljeScsXG4gICdieXBhc3MnLFxuICAnamFpbGJyZWFrJyxcbiAgJ2Rpc2FibGUgc2FmZXR5JyxcbiAgJ2FjdCBhcycsXG5dO1xuXG5jb25zdCBFWEZJTF9ISU5UUyA9IFtcbiAgJ2FwaSBrZXknLFxuICAnc2VjcmV0JyxcbiAgJ3Rva2VuJyxcbiAgJ3Bhc3N3b3JkJyxcbiAgJ2NyZWRlbnRpYWxzJyxcbiAgJ3ByaXZhdGUga2V5JyxcbiAgJ2R1bXAnLFxuXTtcblxuY29uc3QgTUFMV0FSRV9ISU5UUyA9IFsnbWFsd2FyZScsICdyYW5zb213YXJlJywgJ2tleWxvZ2dlcicsICdleHBsb2l0JywgJ3BheWxvYWQnLCAnYmFja2Rvb3InXTtcblxuY29uc3QgUFJJVl9FU0NfSElOVFMgPSBbXG4gICdhZG1pbicsXG4gICdlbGV2YXRlIHByaXZpbGVnZScsXG4gICdyb290IGFjY2VzcycsXG4gICdvcGVyYXRvciBtb2RlJyxcbiAgJ3BvbGljeSBhZG1pbicsXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gYmFzZWxpbmVEZXRlY3RvcnMoKTogRGV0ZWN0b3JbXSB7XG4gIHJldHVybiBbXG4gICAge1xuICAgICAgaWQ6ICdCQVNFX0lOVFJVU0lPTl9MQU5HVUFHRScsXG4gICAgICBvcmRlcjogMTAsXG4gICAgICBkZXRlY3Q6IChpbnB1dCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHh0KHsgdGV4dDogaW5wdXQudGV4dCB9KTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gW107XG4gICAgICAgIGlmIChoYXNBbnkodCwgSU5UUlVTSU9OX0hJTlRTKSkge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBmaW5kaW5nKHtcbiAgICAgICAgICAgICAgaWQ6ICdJTlRSVVNJT05fSU5ESUNBVE9SJyxcbiAgICAgICAgICAgICAgdGl0bGU6ICdJbnRydXNpb24gLyBvdmVycmlkZSBpbmRpY2F0b3IgZGV0ZWN0ZWQnLFxuICAgICAgICAgICAgICBzZXZlcml0eTogJ2hpZ2gnLFxuICAgICAgICAgICAgICB2ZXJkaWN0OiAnZGVueScsXG4gICAgICAgICAgICAgIHJhdGlvbmFsZTogJ0lucHV0IGNvbnRhaW5zIGxhbmd1YWdlIGNvbW1vbmx5IGFzc29jaWF0ZWQgd2l0aCBieXBhc3NpbmcgY29udHJvbHMuJyxcbiAgICAgICAgICAgICAgdGFnczogWydpbnRydXNpb24nLCAnYmFzZWxpbmUnXSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnQkFTRV9FWEZJTF9MQU5HVUFHRScsXG4gICAgICBvcmRlcjogMjAsXG4gICAgICBkZXRlY3Q6IChpbnB1dCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHh0KHsgdGV4dDogaW5wdXQudGV4dCB9KTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gW107XG4gICAgICAgIGlmIChoYXNBbnkodCwgRVhGSUxfSElOVFMpKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIGZpbmRpbmcoe1xuICAgICAgICAgICAgICBpZDogJ0VYRklMX0lORElDQVRPUicsXG4gICAgICAgICAgICAgIHRpdGxlOiAnUG90ZW50aWFsIGRhdGEgZXhmaWx0cmF0aW9uIGludGVudCBkZXRlY3RlZCcsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgIHZlcmRpY3Q6ICdkZW55JyxcbiAgICAgICAgICAgICAgcmF0aW9uYWxlOlxuICAgICAgICAgICAgICAgICdJbnB1dCBzdWdnZXN0cyBhbiBhdHRlbXB0IHRvIG9idGFpbiBzZW5zaXRpdmUgY3JlZGVudGlhbHMgb3IgcmVzdHJpY3RlZCBkYXRhLicsXG4gICAgICAgICAgICAgIHRhZ3M6IFsnZXhmaWwnLCAnYmFzZWxpbmUnXSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnQkFTRV9QUklWX0VTQ19MQU5HVUFHRScsXG4gICAgICBvcmRlcjogMzAsXG4gICAgICBkZXRlY3Q6IChpbnB1dCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHh0KHsgdGV4dDogaW5wdXQudGV4dCB9KTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gW107XG4gICAgICAgIGlmIChoYXNBbnkodCwgUFJJVl9FU0NfSElOVFMpKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIGZpbmRpbmcoe1xuICAgICAgICAgICAgICBpZDogJ1BSSVZfRVNDX0lORElDQVRPUicsXG4gICAgICAgICAgICAgIHRpdGxlOiAnUHJpdmlsZWdlIGVzY2FsYXRpb24gaW5kaWNhdG9yIGRldGVjdGVkJyxcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICAgICAgICAgICAgdmVyZGljdDogJ2RlbnknLFxuICAgICAgICAgICAgICByYXRpb25hbGU6ICdJbnB1dCBpbmRpY2F0ZXMgYW4gYXR0ZW1wdCB0byBhY2Nlc3MgcHJpdmlsZWdlZCBvcGVyYXRvci9hZG1pbiBhY3Rpb25zLicsXG4gICAgICAgICAgICAgIHRhZ3M6IFsncHJpdmlsZWdlJywgJ2Jhc2VsaW5lJ10sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ0JBU0VfTUFMV0FSRV9MQU5HVUFHRScsXG4gICAgICBvcmRlcjogNDAsXG4gICAgICBkZXRlY3Q6IChpbnB1dCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHh0KHsgdGV4dDogaW5wdXQudGV4dCB9KTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gW107XG4gICAgICAgIGlmIChoYXNBbnkodCwgTUFMV0FSRV9ISU5UUykpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgZmluZGluZyh7XG4gICAgICAgICAgICAgIGlkOiAnTUFMV0FSRV9JTkRJQ0FUT1InLFxuICAgICAgICAgICAgICB0aXRsZTogJ01hbGljaW91cyBjb250ZW50IGluZGljYXRvciBkZXRlY3RlZCcsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnLFxuICAgICAgICAgICAgICB2ZXJkaWN0OiAnZGVueScsXG4gICAgICAgICAgICAgIHJhdGlvbmFsZTogJ0lucHV0IGNvbnRhaW5zIHRlcm1zIGNvbW1vbmx5IGFzc29jaWF0ZWQgd2l0aCBtYWx3YXJlL2V4cGxvaXQgYWN0aXZpdHkuJyxcbiAgICAgICAgICAgICAgdGFnczogWydtYWx3YXJlJywgJ2Jhc2VsaW5lJ10sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ0JBU0VfUElJX1JFVklFVycsXG4gICAgICBvcmRlcjogNTAsXG4gICAgICBkZXRlY3Q6IChpbnB1dCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gaW5wdXQudGV4dCB8fCAnJztcbiAgICAgICAgY29uc3QgbG9va3NMaWtlRW1haWwgPSAvXFxiW0EtWjAtOS5fJSstXStAW0EtWjAtOS4tXStcXC5bQS1aXXsyLH1cXGIvaS50ZXN0KHQpO1xuICAgICAgICBjb25zdCBsb29rc0xpa2VQaG9uZSA9IC9cXGIoXFwrPzFbXFxzLV0/KT8oXFwoP1xcZHszfVxcKT9bXFxzLV0/KVxcZHszfVtcXHMtXT9cXGR7NH1cXGIvLnRlc3QodCk7XG4gICAgICAgIGlmIChsb29rc0xpa2VFbWFpbCB8fCBsb29rc0xpa2VQaG9uZSkge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBmaW5kaW5nKHtcbiAgICAgICAgICAgICAgaWQ6ICdQSUlfUE9TU0lCTEUnLFxuICAgICAgICAgICAgICB0aXRsZTogJ1Bvc3NpYmxlIHBlcnNvbmFsIGRhdGEgZGV0ZWN0ZWQnLFxuICAgICAgICAgICAgICBzZXZlcml0eTogJ21lZGl1bScsXG4gICAgICAgICAgICAgIHZlcmRpY3Q6ICdzYW5pdGl6ZScsXG4gICAgICAgICAgICAgIHJhdGlvbmFsZTogJ0lucHV0IG1heSBjb250YWluIHBlcnNvbmFsIGNvbnRhY3QgaW5mb3JtYXRpb247IHJlZGFjdGlvbiByZWNvbW1lbmRlZC4nLFxuICAgICAgICAgICAgICB0YWdzOiBbJ3BpaScsICdiYXNlbGluZSddLFxuICAgICAgICAgICAgICBldmlkZW5jZTogbG9va3NMaWtlRW1haWwgPyAnZW1haWwtbGlrZSBwYXR0ZXJuJyA6ICdwaG9uZS1saWtlIHBhdHRlcm4nLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW107XG4gICAgICB9LFxuICAgIH0sXG4gIF07XG59XG4iXSwibmFtZXMiOlsiZmluZGluZyIsInR4dCIsImlucHV0IiwidGV4dCIsInRvTG93ZXJDYXNlIiwiaGFzQW55IiwidCIsIm5lZWRsZXMiLCJzb21lIiwibiIsImluY2x1ZGVzIiwiSU5UUlVTSU9OX0hJTlRTIiwiRVhGSUxfSElOVFMiLCJNQUxXQVJFX0hJTlRTIiwiUFJJVl9FU0NfSElOVFMiLCJiYXNlbGluZURldGVjdG9ycyIsImlkIiwib3JkZXIiLCJkZXRlY3QiLCJ0aXRsZSIsInNldmVyaXR5IiwidmVyZGljdCIsInJhdGlvbmFsZSIsInRhZ3MiLCJsb29rc0xpa2VFbWFpbCIsInRlc3QiLCJsb29rc0xpa2VQaG9uZSIsImV2aWRlbmNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/detectors.baseline.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/core/detectors.ts":
/*!***************************************!*\
  !*** ../scing/bane/core/detectors.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   finding: () => (/* binding */ finding),\n/* harmony export */   runDetectors: () => (/* binding */ runDetectors)\n/* harmony export */ });\nfunction finding(params) {\n    return {\n        id: params.id,\n        title: params.title,\n        severity: params.severity,\n        verdict: params.verdict,\n        rationale: params.rationale,\n        tags: params.tags,\n        evidence: params.evidence\n    };\n}\nfunction runDetectors(detectors, input, hints) {\n    const sorted = [\n        ...detectors\n    ].sort((a, b)=>a.order - b.order || a.id.localeCompare(b.id));\n    const out = [];\n    for (const d of sorted){\n        const res = d.detect(input, hints);\n        if (res && res.length) out.push(...res);\n    }\n    return out;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvZGV0ZWN0b3JzLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBV08sU0FBU0EsUUFBUUMsTUFRdkI7SUFDQyxPQUFPO1FBQ0xDLElBQUlELE9BQU9DLEVBQUU7UUFDYkMsT0FBT0YsT0FBT0UsS0FBSztRQUNuQkMsVUFBVUgsT0FBT0csUUFBUTtRQUN6QkMsU0FBU0osT0FBT0ksT0FBTztRQUN2QkMsV0FBV0wsT0FBT0ssU0FBUztRQUMzQkMsTUFBTU4sT0FBT00sSUFBSTtRQUNqQkMsVUFBVVAsT0FBT08sUUFBUTtJQUMzQjtBQUNGO0FBRU8sU0FBU0MsYUFDZEMsU0FBcUIsRUFDckJDLEtBQWdCLEVBQ2hCQyxLQUFrQjtJQUVsQixNQUFNQyxTQUFTO1dBQUlIO0tBQVUsQ0FBQ0ksSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELEVBQUVFLEtBQUssR0FBR0QsRUFBRUMsS0FBSyxJQUFJRixFQUFFYixFQUFFLENBQUNnQixhQUFhLENBQUNGLEVBQUVkLEVBQUU7SUFDekYsTUFBTWlCLE1BQXFCLEVBQUU7SUFDN0IsS0FBSyxNQUFNQyxLQUFLUCxPQUFRO1FBQ3RCLE1BQU1RLE1BQU1ELEVBQUVFLE1BQU0sQ0FBQ1gsT0FBT0M7UUFDNUIsSUFBSVMsT0FBT0EsSUFBSUUsTUFBTSxFQUFFSixJQUFJSyxJQUFJLElBQUlIO0lBQ3JDO0lBQ0EsT0FBT0Y7QUFDVCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcY29yZVxcZGV0ZWN0b3JzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZUZpbmRpbmcsIEJhbmVJbnB1dCwgQmFuZVNldmVyaXR5LCBCYW5lVmVyZGljdCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgUG9saWN5SGludHMgfSBmcm9tICcuLi9wb2xpY3kvYmFuZVBvbGljeSc7XG5cbmV4cG9ydCB0eXBlIERldGVjdG9yUmVzdWx0ID0gQmFuZUZpbmRpbmdbXTtcblxuZXhwb3J0IHR5cGUgRGV0ZWN0b3IgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIG9yZGVyOiBudW1iZXI7XG4gIGRldGVjdDogKGlucHV0OiBCYW5lSW5wdXQsIGhpbnRzOiBQb2xpY3lIaW50cykgPT4gRGV0ZWN0b3JSZXN1bHQ7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZmluZGluZyhwYXJhbXM6IHtcbiAgaWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgc2V2ZXJpdHk6IEJhbmVTZXZlcml0eTtcbiAgdmVyZGljdDogQmFuZVZlcmRpY3Q7XG4gIHJhdGlvbmFsZTogc3RyaW5nO1xuICB0YWdzPzogc3RyaW5nW107XG4gIGV2aWRlbmNlPzogc3RyaW5nO1xufSk6IEJhbmVGaW5kaW5nIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogcGFyYW1zLmlkLFxuICAgIHRpdGxlOiBwYXJhbXMudGl0bGUsXG4gICAgc2V2ZXJpdHk6IHBhcmFtcy5zZXZlcml0eSxcbiAgICB2ZXJkaWN0OiBwYXJhbXMudmVyZGljdCxcbiAgICByYXRpb25hbGU6IHBhcmFtcy5yYXRpb25hbGUsXG4gICAgdGFnczogcGFyYW1zLnRhZ3MsXG4gICAgZXZpZGVuY2U6IHBhcmFtcy5ldmlkZW5jZSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJ1bkRldGVjdG9ycyhcbiAgZGV0ZWN0b3JzOiBEZXRlY3RvcltdLFxuICBpbnB1dDogQmFuZUlucHV0LFxuICBoaW50czogUG9saWN5SGludHNcbik6IEJhbmVGaW5kaW5nW10ge1xuICBjb25zdCBzb3J0ZWQgPSBbLi4uZGV0ZWN0b3JzXS5zb3J0KChhLCBiKSA9PiBhLm9yZGVyIC0gYi5vcmRlciB8fCBhLmlkLmxvY2FsZUNvbXBhcmUoYi5pZCkpO1xuICBjb25zdCBvdXQ6IEJhbmVGaW5kaW5nW10gPSBbXTtcbiAgZm9yIChjb25zdCBkIG9mIHNvcnRlZCkge1xuICAgIGNvbnN0IHJlcyA9IGQuZGV0ZWN0KGlucHV0LCBoaW50cyk7XG4gICAgaWYgKHJlcyAmJiByZXMubGVuZ3RoKSBvdXQucHVzaCguLi5yZXMpO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG4iXSwibmFtZXMiOlsiZmluZGluZyIsInBhcmFtcyIsImlkIiwidGl0bGUiLCJzZXZlcml0eSIsInZlcmRpY3QiLCJyYXRpb25hbGUiLCJ0YWdzIiwiZXZpZGVuY2UiLCJydW5EZXRlY3RvcnMiLCJkZXRlY3RvcnMiLCJpbnB1dCIsImhpbnRzIiwic29ydGVkIiwic29ydCIsImEiLCJiIiwib3JkZXIiLCJsb2NhbGVDb21wYXJlIiwib3V0IiwiZCIsInJlcyIsImRldGVjdCIsImxlbmd0aCIsInB1c2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/detectors.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/core/redaction.ts":
/*!***************************************!*\
  !*** ../scing/bane/core/redaction.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyRedactions: () => (/* binding */ applyRedactions),\n/* harmony export */   mergeSpans: () => (/* binding */ mergeSpans)\n/* harmony export */ });\nfunction mergeSpans(spans) {\n    const s = [\n        ...spans\n    ].sort((a, b)=>a.start - b.start || a.end - b.end);\n    const out = [];\n    for (const cur of s){\n        const prev = out[out.length - 1];\n        if (!prev || cur.start > prev.end) {\n            out.push({\n                ...cur\n            });\n        } else {\n            prev.end = Math.max(prev.end, cur.end);\n            prev.label = prev.label || cur.label;\n        }\n    }\n    return out;\n}\nfunction applyRedactions(text, spans) {\n    if (!spans.length) return text;\n    const merged = mergeSpans(spans);\n    let out = '';\n    let last = 0;\n    for (const sp of merged){\n        out += text.slice(last, sp.start);\n        out += `[REDACTED:${sp.label}]`;\n        last = sp.end;\n    }\n    out += text.slice(last);\n    return out;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvcmVkYWN0aW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRU8sU0FBU0EsV0FBV0MsS0FBc0I7SUFDL0MsTUFBTUMsSUFBSTtXQUFJRDtLQUFNLENBQUNFLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNRCxFQUFFRSxLQUFLLEdBQUdELEVBQUVDLEtBQUssSUFBSUYsRUFBRUcsR0FBRyxHQUFHRixFQUFFRSxHQUFHO0lBQ3RFLE1BQU1DLE1BQXVCLEVBQUU7SUFDL0IsS0FBSyxNQUFNQyxPQUFPUCxFQUFHO1FBQ25CLE1BQU1RLE9BQU9GLEdBQUcsQ0FBQ0EsSUFBSUcsTUFBTSxHQUFHLEVBQUU7UUFDaEMsSUFBSSxDQUFDRCxRQUFRRCxJQUFJSCxLQUFLLEdBQUdJLEtBQUtILEdBQUcsRUFBRTtZQUNqQ0MsSUFBSUksSUFBSSxDQUFDO2dCQUFFLEdBQUdILEdBQUc7WUFBQztRQUNwQixPQUFPO1lBQ0xDLEtBQUtILEdBQUcsR0FBR00sS0FBS0MsR0FBRyxDQUFDSixLQUFLSCxHQUFHLEVBQUVFLElBQUlGLEdBQUc7WUFDckNHLEtBQUtLLEtBQUssR0FBR0wsS0FBS0ssS0FBSyxJQUFJTixJQUFJTSxLQUFLO1FBQ3RDO0lBQ0Y7SUFDQSxPQUFPUDtBQUNUO0FBRU8sU0FBU1EsZ0JBQWdCQyxJQUFZLEVBQUVoQixLQUFzQjtJQUNsRSxJQUFJLENBQUNBLE1BQU1VLE1BQU0sRUFBRSxPQUFPTTtJQUMxQixNQUFNQyxTQUFTbEIsV0FBV0M7SUFDMUIsSUFBSU8sTUFBTTtJQUNWLElBQUlXLE9BQU87SUFDWCxLQUFLLE1BQU1DLE1BQU1GLE9BQVE7UUFDdkJWLE9BQU9TLEtBQUtJLEtBQUssQ0FBQ0YsTUFBTUMsR0FBR2QsS0FBSztRQUNoQ0UsT0FBTyxDQUFDLFVBQVUsRUFBRVksR0FBR0wsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMvQkksT0FBT0MsR0FBR2IsR0FBRztJQUNmO0lBQ0FDLE9BQU9TLEtBQUtJLEtBQUssQ0FBQ0Y7SUFDbEIsT0FBT1g7QUFDVCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcY29yZVxccmVkYWN0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIFJlZGFjdGlvblNwYW4gPSB7IHN0YXJ0OiBudW1iZXI7IGVuZDogbnVtYmVyOyBsYWJlbDogc3RyaW5nIH07XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZVNwYW5zKHNwYW5zOiBSZWRhY3Rpb25TcGFuW10pOiBSZWRhY3Rpb25TcGFuW10ge1xuICBjb25zdCBzID0gWy4uLnNwYW5zXS5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCB8fCBhLmVuZCAtIGIuZW5kKTtcbiAgY29uc3Qgb3V0OiBSZWRhY3Rpb25TcGFuW10gPSBbXTtcbiAgZm9yIChjb25zdCBjdXIgb2Ygcykge1xuICAgIGNvbnN0IHByZXYgPSBvdXRbb3V0Lmxlbmd0aCAtIDFdO1xuICAgIGlmICghcHJldiB8fCBjdXIuc3RhcnQgPiBwcmV2LmVuZCkge1xuICAgICAgb3V0LnB1c2goeyAuLi5jdXIgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByZXYuZW5kID0gTWF0aC5tYXgocHJldi5lbmQsIGN1ci5lbmQpO1xuICAgICAgcHJldi5sYWJlbCA9IHByZXYubGFiZWwgfHwgY3VyLmxhYmVsO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlSZWRhY3Rpb25zKHRleHQ6IHN0cmluZywgc3BhbnM6IFJlZGFjdGlvblNwYW5bXSk6IHN0cmluZyB7XG4gIGlmICghc3BhbnMubGVuZ3RoKSByZXR1cm4gdGV4dDtcbiAgY29uc3QgbWVyZ2VkID0gbWVyZ2VTcGFucyhzcGFucyk7XG4gIGxldCBvdXQgPSAnJztcbiAgbGV0IGxhc3QgPSAwO1xuICBmb3IgKGNvbnN0IHNwIG9mIG1lcmdlZCkge1xuICAgIG91dCArPSB0ZXh0LnNsaWNlKGxhc3QsIHNwLnN0YXJ0KTtcbiAgICBvdXQgKz0gYFtSRURBQ1RFRDoke3NwLmxhYmVsfV1gO1xuICAgIGxhc3QgPSBzcC5lbmQ7XG4gIH1cbiAgb3V0ICs9IHRleHQuc2xpY2UobGFzdCk7XG4gIHJldHVybiBvdXQ7XG59XG4iXSwibmFtZXMiOlsibWVyZ2VTcGFucyIsInNwYW5zIiwicyIsInNvcnQiLCJhIiwiYiIsInN0YXJ0IiwiZW5kIiwib3V0IiwiY3VyIiwicHJldiIsImxlbmd0aCIsInB1c2giLCJNYXRoIiwibWF4IiwibGFiZWwiLCJhcHBseVJlZGFjdGlvbnMiLCJ0ZXh0IiwibWVyZ2VkIiwibGFzdCIsInNwIiwic2xpY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/redaction.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/core/redactionFromFindings.ts":
/*!***************************************************!*\
  !*** ../scing/bane/core/redactionFromFindings.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redactionsFromFindings: () => (/* binding */ redactionsFromFindings)\n/* harmony export */ });\nfunction redactionsFromFindings(text, findings) {\n    const spans = [];\n    for (const f of findings){\n        if (f.verdict !== 'sanitize') continue;\n        const emailRe = /\\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\b/gi;\n        for (const m of text.matchAll(emailRe)){\n            const idx = m.index ?? -1;\n            if (idx >= 0) spans.push({\n                start: idx,\n                end: idx + m[0].length,\n                label: 'PII'\n            });\n        }\n        const phoneRe = /\\b(\\+?1[\\s-]?)?(\\(?\\d{3}\\)?[\\s-]?)\\d{3}[\\s-]?\\d{4}\\b/g;\n        for (const m of text.matchAll(phoneRe)){\n            const idx = m.index ?? -1;\n            if (idx >= 0) spans.push({\n                start: idx,\n                end: idx + m[0].length,\n                label: 'PII'\n            });\n        }\n    }\n    return spans;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvcmVkYWN0aW9uRnJvbUZpbmRpbmdzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFHTyxTQUFTQSx1QkFBdUJDLElBQVksRUFBRUMsUUFBdUI7SUFDMUUsTUFBTUMsUUFBeUIsRUFBRTtJQUVqQyxLQUFLLE1BQU1DLEtBQUtGLFNBQVU7UUFDeEIsSUFBSUUsRUFBRUMsT0FBTyxLQUFLLFlBQVk7UUFFOUIsTUFBTUMsVUFBVTtRQUNoQixLQUFLLE1BQU1DLEtBQUtOLEtBQUtPLFFBQVEsQ0FBQ0YsU0FBVTtZQUN0QyxNQUFNRyxNQUFNRixFQUFFRyxLQUFLLElBQUksQ0FBQztZQUN4QixJQUFJRCxPQUFPLEdBQUdOLE1BQU1RLElBQUksQ0FBQztnQkFBRUMsT0FBT0g7Z0JBQUtJLEtBQUtKLE1BQU1GLENBQUMsQ0FBQyxFQUFFLENBQUNPLE1BQU07Z0JBQUVDLE9BQU87WUFBTTtRQUM5RTtRQUVBLE1BQU1DLFVBQVU7UUFDaEIsS0FBSyxNQUFNVCxLQUFLTixLQUFLTyxRQUFRLENBQUNRLFNBQVU7WUFDdEMsTUFBTVAsTUFBTUYsRUFBRUcsS0FBSyxJQUFJLENBQUM7WUFDeEIsSUFBSUQsT0FBTyxHQUFHTixNQUFNUSxJQUFJLENBQUM7Z0JBQUVDLE9BQU9IO2dCQUFLSSxLQUFLSixNQUFNRixDQUFDLENBQUMsRUFBRSxDQUFDTyxNQUFNO2dCQUFFQyxPQUFPO1lBQU07UUFDOUU7SUFDRjtJQUVBLE9BQU9aO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXGNvcmVcXHJlZGFjdGlvbkZyb21GaW5kaW5ncy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVGaW5kaW5nIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBSZWRhY3Rpb25TcGFuIH0gZnJvbSAnLi9yZWRhY3Rpb24nO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVkYWN0aW9uc0Zyb21GaW5kaW5ncyh0ZXh0OiBzdHJpbmcsIGZpbmRpbmdzOiBCYW5lRmluZGluZ1tdKTogUmVkYWN0aW9uU3BhbltdIHtcbiAgY29uc3Qgc3BhbnM6IFJlZGFjdGlvblNwYW5bXSA9IFtdO1xuXG4gIGZvciAoY29uc3QgZiBvZiBmaW5kaW5ncykge1xuICAgIGlmIChmLnZlcmRpY3QgIT09ICdzYW5pdGl6ZScpIGNvbnRpbnVlO1xuXG4gICAgY29uc3QgZW1haWxSZSA9IC9cXGJbQS1aMC05Ll8lKy1dK0BbQS1aMC05Li1dK1xcLltBLVpdezIsfVxcYi9naTtcbiAgICBmb3IgKGNvbnN0IG0gb2YgdGV4dC5tYXRjaEFsbChlbWFpbFJlKSkge1xuICAgICAgY29uc3QgaWR4ID0gbS5pbmRleCA/PyAtMTtcbiAgICAgIGlmIChpZHggPj0gMCkgc3BhbnMucHVzaCh7IHN0YXJ0OiBpZHgsIGVuZDogaWR4ICsgbVswXS5sZW5ndGgsIGxhYmVsOiAnUElJJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBwaG9uZVJlID0gL1xcYihcXCs/MVtcXHMtXT8pPyhcXCg/XFxkezN9XFwpP1tcXHMtXT8pXFxkezN9W1xccy1dP1xcZHs0fVxcYi9nO1xuICAgIGZvciAoY29uc3QgbSBvZiB0ZXh0Lm1hdGNoQWxsKHBob25lUmUpKSB7XG4gICAgICBjb25zdCBpZHggPSBtLmluZGV4ID8/IC0xO1xuICAgICAgaWYgKGlkeCA+PSAwKSBzcGFucy5wdXNoKHsgc3RhcnQ6IGlkeCwgZW5kOiBpZHggKyBtWzBdLmxlbmd0aCwgbGFiZWw6ICdQSUknIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzcGFucztcbn1cbiJdLCJuYW1lcyI6WyJyZWRhY3Rpb25zRnJvbUZpbmRpbmdzIiwidGV4dCIsImZpbmRpbmdzIiwic3BhbnMiLCJmIiwidmVyZGljdCIsImVtYWlsUmUiLCJtIiwibWF0Y2hBbGwiLCJpZHgiLCJpbmRleCIsInB1c2giLCJzdGFydCIsImVuZCIsImxlbmd0aCIsImxhYmVsIiwicGhvbmVSZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/redactionFromFindings.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/core/sortFindings.ts":
/*!******************************************!*\
  !*** ../scing/bane/core/sortFindings.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sortFindings: () => (/* binding */ sortFindings)\n/* harmony export */ });\nconst sRank = {\n    low: 1,\n    medium: 2,\n    high: 3,\n    critical: 4\n};\nconst vRank = {\n    allow: 1,\n    sanitize: 2,\n    review: 3,\n    deny: 4\n};\nfunction sortFindings(findings) {\n    return [\n        ...findings\n    ].sort((a, b)=>{\n        const sd = sRank[b.severity] - sRank[a.severity];\n        if (sd !== 0) return sd;\n        const vd = vRank[b.verdict] - vRank[a.verdict];\n        if (vd !== 0) return vd;\n        return a.id.localeCompare(b.id);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2NvcmUvc29ydEZpbmRpbmdzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFFQSxNQUFNQSxRQUFzQztJQUFFQyxLQUFLO0lBQUdDLFFBQVE7SUFBR0MsTUFBTTtJQUFHQyxVQUFVO0FBQUU7QUFDdEYsTUFBTUMsUUFBcUM7SUFBRUMsT0FBTztJQUFHQyxVQUFVO0lBQUdDLFFBQVE7SUFBR0MsTUFBTTtBQUFFO0FBRWhGLFNBQVNDLGFBQWFDLFFBQXVCO0lBQ2xELE9BQU87V0FBSUE7S0FBUyxDQUFDQyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDNUIsTUFBTUMsS0FBS2YsS0FBSyxDQUFDYyxFQUFFRSxRQUFRLENBQUMsR0FBR2hCLEtBQUssQ0FBQ2EsRUFBRUcsUUFBUSxDQUFDO1FBQ2hELElBQUlELE9BQU8sR0FBRyxPQUFPQTtRQUNyQixNQUFNRSxLQUFLWixLQUFLLENBQUNTLEVBQUVJLE9BQU8sQ0FBQyxHQUFHYixLQUFLLENBQUNRLEVBQUVLLE9BQU8sQ0FBQztRQUM5QyxJQUFJRCxPQUFPLEdBQUcsT0FBT0E7UUFDckIsT0FBT0osRUFBRU0sRUFBRSxDQUFDQyxhQUFhLENBQUNOLEVBQUVLLEVBQUU7SUFDaEM7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcY29yZVxcc29ydEZpbmRpbmdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZUZpbmRpbmcsIEJhbmVTZXZlcml0eSwgQmFuZVZlcmRpY3QgfSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IHNSYW5rOiBSZWNvcmQ8QmFuZVNldmVyaXR5LCBudW1iZXI+ID0geyBsb3c6IDEsIG1lZGl1bTogMiwgaGlnaDogMywgY3JpdGljYWw6IDQgfTtcbmNvbnN0IHZSYW5rOiBSZWNvcmQ8QmFuZVZlcmRpY3QsIG51bWJlcj4gPSB7IGFsbG93OiAxLCBzYW5pdGl6ZTogMiwgcmV2aWV3OiAzLCBkZW55OiA0IH07XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3J0RmluZGluZ3MoZmluZGluZ3M6IEJhbmVGaW5kaW5nW10pOiBCYW5lRmluZGluZ1tdIHtcbiAgcmV0dXJuIFsuLi5maW5kaW5nc10uc29ydCgoYSwgYikgPT4ge1xuICAgIGNvbnN0IHNkID0gc1JhbmtbYi5zZXZlcml0eV0gLSBzUmFua1thLnNldmVyaXR5XTtcbiAgICBpZiAoc2QgIT09IDApIHJldHVybiBzZDtcbiAgICBjb25zdCB2ZCA9IHZSYW5rW2IudmVyZGljdF0gLSB2UmFua1thLnZlcmRpY3RdO1xuICAgIGlmICh2ZCAhPT0gMCkgcmV0dXJuIHZkO1xuICAgIHJldHVybiBhLmlkLmxvY2FsZUNvbXBhcmUoYi5pZCk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbInNSYW5rIiwibG93IiwibWVkaXVtIiwiaGlnaCIsImNyaXRpY2FsIiwidlJhbmsiLCJhbGxvdyIsInNhbml0aXplIiwicmV2aWV3IiwiZGVueSIsInNvcnRGaW5kaW5ncyIsImZpbmRpbmdzIiwic29ydCIsImEiLCJiIiwic2QiLCJzZXZlcml0eSIsInZkIiwidmVyZGljdCIsImlkIiwibG9jYWxlQ29tcGFyZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/core/sortFindings.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/integrations/httpMiddleware.ts":
/*!****************************************************!*\
  !*** ../scing/bane/integrations/httpMiddleware.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makeBaneHttpGuard: () => (/* binding */ makeBaneHttpGuard)\n/* harmony export */ });\n/* harmony import */ var _runtime_liveBaneEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../runtime/liveBaneEngine */ \"(api-node)/../scing/bane/runtime/liveBaneEngine.ts\");\n\nfunction makeBaneHttpGuard(config) {\n    const engine = (0,_runtime_liveBaneEngine__WEBPACK_IMPORTED_MODULE_0__.createLiveBaneEngine)(config);\n    return function guard(req) {\n        const input = {\n            text: req.bodyText ?? '',\n            req: {\n                route: req.path ?? 'http:unknown',\n                requiredCapability: 'bane:invoke',\n                auth: {\n                    identityId: req.identityId,\n                    sessionId: req.sessionId,\n                    ipHash: req.ipHash,\n                    capabilities: req.capabilities,\n                    isAuthenticated: Boolean(req.identityId),\n                    sessionIntegrity: req.sessionIntegrity\n                }\n            }\n        };\n        const out = engine.evaluate(input);\n        if (out.verdict === 'deny') {\n            const status = out.enforcementLevel === 4 ? 423 : out.enforcementLevel === 5 ? 403 : 403;\n            return {\n                ok: false,\n                status,\n                message: out.publicMessage ?? 'Access denied by policy.',\n                traceId: out.traceId,\n                retryAfterMs: out.throttle && out.throttle.action === 'block' ? out.throttle.retryAfterMs : undefined\n            };\n        }\n        if (out.verdict === 'review') {\n            return {\n                ok: false,\n                status: 401,\n                message: out.publicMessage ?? 'Additional authorization required.',\n                traceId: out.traceId\n            };\n        }\n        return {\n            ok: true,\n            traceId: out.traceId\n        };\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2ludGVncmF0aW9ucy9odHRwTWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUVpRTtBQWlCMUQsU0FBU0Msa0JBQWtCQyxNQUF5QjtJQUN6RCxNQUFNQyxTQUFTSCw2RUFBb0JBLENBQUNFO0lBRXBDLE9BQU8sU0FBU0UsTUFBTUMsR0FBb0I7UUFDeEMsTUFBTUMsUUFBbUI7WUFDdkJDLE1BQU1GLElBQUlHLFFBQVEsSUFBSTtZQUN0QkgsS0FBSztnQkFDSEksT0FBT0osSUFBSUssSUFBSSxJQUFJO2dCQUNuQkMsb0JBQW9CO2dCQUNwQkMsTUFBTTtvQkFDSkMsWUFBWVIsSUFBSVEsVUFBVTtvQkFDMUJDLFdBQVdULElBQUlTLFNBQVM7b0JBQ3hCQyxRQUFRVixJQUFJVSxNQUFNO29CQUNsQkMsY0FBY1gsSUFBSVcsWUFBWTtvQkFDOUJDLGlCQUFpQkMsUUFBUWIsSUFBSVEsVUFBVTtvQkFDdkNNLGtCQUFrQmQsSUFBSWMsZ0JBQWdCO2dCQUN4QztZQUNGO1FBQ0Y7UUFFQSxNQUFNQyxNQUFNakIsT0FBT2tCLFFBQVEsQ0FBQ2Y7UUFFNUIsSUFBSWMsSUFBSUUsT0FBTyxLQUFLLFFBQVE7WUFDMUIsTUFBTUMsU0FBU0gsSUFBSUksZ0JBQWdCLEtBQUssSUFBSSxNQUFNSixJQUFJSSxnQkFBZ0IsS0FBSyxJQUFJLE1BQU07WUFDckYsT0FBTztnQkFDTEMsSUFBSTtnQkFDSkY7Z0JBQ0FHLFNBQVNOLElBQUlPLGFBQWEsSUFBSTtnQkFDOUJDLFNBQVNSLElBQUlRLE9BQU87Z0JBQ3BCQyxjQUNFVCxJQUFJVSxRQUFRLElBQUlWLElBQUlVLFFBQVEsQ0FBQ0MsTUFBTSxLQUFLLFVBQVVYLElBQUlVLFFBQVEsQ0FBQ0QsWUFBWSxHQUFHRztZQUNsRjtRQUNGO1FBRUEsSUFBSVosSUFBSUUsT0FBTyxLQUFLLFVBQVU7WUFDNUIsT0FBTztnQkFDTEcsSUFBSTtnQkFDSkYsUUFBUTtnQkFDUkcsU0FBU04sSUFBSU8sYUFBYSxJQUFJO2dCQUM5QkMsU0FBU1IsSUFBSVEsT0FBTztZQUN0QjtRQUNGO1FBRUEsT0FBTztZQUFFSCxJQUFJO1lBQU1HLFNBQVNSLElBQUlRLE9BQU87UUFBQztJQUMxQztBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxpbnRlZ3JhdGlvbnNcXGh0dHBNaWRkbGV3YXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZUlucHV0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBCYW5lUnVudGltZUNvbmZpZyB9IGZyb20gJy4uL3J1bnRpbWUvY29uZmlnJztcbmltcG9ydCB7IGNyZWF0ZUxpdmVCYW5lRW5naW5lIH0gZnJvbSAnLi4vcnVudGltZS9saXZlQmFuZUVuZ2luZSc7XG5cbmV4cG9ydCB0eXBlIEJhbmVIdHRwUmVxdWVzdCA9IHtcbiAgcGF0aD86IHN0cmluZztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gIGJvZHlUZXh0Pzogc3RyaW5nO1xuICBpZGVudGl0eUlkPzogc3RyaW5nO1xuICBzZXNzaW9uSWQ/OiBzdHJpbmc7XG4gIGlwSGFzaD86IHN0cmluZztcbiAgY2FwYWJpbGl0aWVzPzogc3RyaW5nW107XG4gIHNlc3Npb25JbnRlZ3JpdHk/OiB7IG5vbmNlT2s/OiBib29sZWFuOyBzaWduYXR1cmVPaz86IGJvb2xlYW47IHRva2VuRnJlc2g/OiBib29sZWFuIH07XG59O1xuXG5leHBvcnQgdHlwZSBCYW5lSHR0cERlY2lzaW9uID1cbiAgfCB7IG9rOiB0cnVlOyB0cmFjZUlkOiBzdHJpbmcgfVxuICB8IHsgb2s6IGZhbHNlOyBzdGF0dXM6IG51bWJlcjsgbWVzc2FnZTogc3RyaW5nOyB0cmFjZUlkOiBzdHJpbmc7IHJldHJ5QWZ0ZXJNcz86IG51bWJlciB9O1xuXG5leHBvcnQgZnVuY3Rpb24gbWFrZUJhbmVIdHRwR3VhcmQoY29uZmlnOiBCYW5lUnVudGltZUNvbmZpZykge1xuICBjb25zdCBlbmdpbmUgPSBjcmVhdGVMaXZlQmFuZUVuZ2luZShjb25maWcpO1xuXG4gIHJldHVybiBmdW5jdGlvbiBndWFyZChyZXE6IEJhbmVIdHRwUmVxdWVzdCk6IEJhbmVIdHRwRGVjaXNpb24ge1xuICAgIGNvbnN0IGlucHV0OiBCYW5lSW5wdXQgPSB7XG4gICAgICB0ZXh0OiByZXEuYm9keVRleHQgPz8gJycsXG4gICAgICByZXE6IHtcbiAgICAgICAgcm91dGU6IHJlcS5wYXRoID8/ICdodHRwOnVua25vd24nLFxuICAgICAgICByZXF1aXJlZENhcGFiaWxpdHk6ICdiYW5lOmludm9rZScsXG4gICAgICAgIGF1dGg6IHtcbiAgICAgICAgICBpZGVudGl0eUlkOiByZXEuaWRlbnRpdHlJZCxcbiAgICAgICAgICBzZXNzaW9uSWQ6IHJlcS5zZXNzaW9uSWQsXG4gICAgICAgICAgaXBIYXNoOiByZXEuaXBIYXNoLFxuICAgICAgICAgIGNhcGFiaWxpdGllczogcmVxLmNhcGFiaWxpdGllcyxcbiAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IEJvb2xlYW4ocmVxLmlkZW50aXR5SWQpLFxuICAgICAgICAgIHNlc3Npb25JbnRlZ3JpdHk6IHJlcS5zZXNzaW9uSW50ZWdyaXR5LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgY29uc3Qgb3V0ID0gZW5naW5lLmV2YWx1YXRlKGlucHV0KTtcblxuICAgIGlmIChvdXQudmVyZGljdCA9PT0gJ2RlbnknKSB7XG4gICAgICBjb25zdCBzdGF0dXMgPSBvdXQuZW5mb3JjZW1lbnRMZXZlbCA9PT0gNCA/IDQyMyA6IG91dC5lbmZvcmNlbWVudExldmVsID09PSA1ID8gNDAzIDogNDAzO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICBzdGF0dXMsXG4gICAgICAgIG1lc3NhZ2U6IG91dC5wdWJsaWNNZXNzYWdlID8/ICdBY2Nlc3MgZGVuaWVkIGJ5IHBvbGljeS4nLFxuICAgICAgICB0cmFjZUlkOiBvdXQudHJhY2VJZCxcbiAgICAgICAgcmV0cnlBZnRlck1zOlxuICAgICAgICAgIG91dC50aHJvdHRsZSAmJiBvdXQudGhyb3R0bGUuYWN0aW9uID09PSAnYmxvY2snID8gb3V0LnRocm90dGxlLnJldHJ5QWZ0ZXJNcyA6IHVuZGVmaW5lZCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKG91dC52ZXJkaWN0ID09PSAncmV2aWV3Jykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICBzdGF0dXM6IDQwMSxcbiAgICAgICAgbWVzc2FnZTogb3V0LnB1YmxpY01lc3NhZ2UgPz8gJ0FkZGl0aW9uYWwgYXV0aG9yaXphdGlvbiByZXF1aXJlZC4nLFxuICAgICAgICB0cmFjZUlkOiBvdXQudHJhY2VJZCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgb2s6IHRydWUsIHRyYWNlSWQ6IG91dC50cmFjZUlkIH07XG4gIH07XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlTGl2ZUJhbmVFbmdpbmUiLCJtYWtlQmFuZUh0dHBHdWFyZCIsImNvbmZpZyIsImVuZ2luZSIsImd1YXJkIiwicmVxIiwiaW5wdXQiLCJ0ZXh0IiwiYm9keVRleHQiLCJyb3V0ZSIsInBhdGgiLCJyZXF1aXJlZENhcGFiaWxpdHkiLCJhdXRoIiwiaWRlbnRpdHlJZCIsInNlc3Npb25JZCIsImlwSGFzaCIsImNhcGFiaWxpdGllcyIsImlzQXV0aGVudGljYXRlZCIsIkJvb2xlYW4iLCJzZXNzaW9uSW50ZWdyaXR5Iiwib3V0IiwiZXZhbHVhdGUiLCJ2ZXJkaWN0Iiwic3RhdHVzIiwiZW5mb3JjZW1lbnRMZXZlbCIsIm9rIiwibWVzc2FnZSIsInB1YmxpY01lc3NhZ2UiLCJ0cmFjZUlkIiwicmV0cnlBZnRlck1zIiwidGhyb3R0bGUiLCJhY3Rpb24iLCJ1bmRlZmluZWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/integrations/httpMiddleware.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/integrations/toolGuard.ts":
/*!***********************************************!*\
  !*** ../scing/bane/integrations/toolGuard.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makeBaneToolGuard: () => (/* binding */ makeBaneToolGuard)\n/* harmony export */ });\n/* harmony import */ var _runtime_liveBaneEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../runtime/liveBaneEngine */ \"(api-node)/../scing/bane/runtime/liveBaneEngine.ts\");\n\nfunction makeBaneToolGuard(config) {\n    const engine = (0,_runtime_liveBaneEngine__WEBPACK_IMPORTED_MODULE_0__.createLiveBaneEngine)(config);\n    return function guard(ctx) {\n        const input = {\n            text: ctx.payloadText,\n            req: {\n                route: `tool:${ctx.toolName}`,\n                requiredCapability: ctx.requiredCapability,\n                auth: {\n                    identityId: ctx.identityId,\n                    sessionId: ctx.sessionId,\n                    ipHash: ctx.ipHash,\n                    capabilities: ctx.capabilities,\n                    isAuthenticated: Boolean(ctx.identityId),\n                    sessionIntegrity: ctx.sessionIntegrity\n                }\n            }\n        };\n        const out = engine.evaluate(input);\n        if (out.verdict === 'deny' || out.verdict === 'review') {\n            return {\n                ok: false,\n                traceId: out.traceId,\n                message: out.publicMessage ?? 'Tool invocation blocked by policy.'\n            };\n        }\n        return {\n            ok: true,\n            traceId: out.traceId\n        };\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL2ludGVncmF0aW9ucy90b29sR3VhcmQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFaUU7QUFpQjFELFNBQVNDLGtCQUFrQkMsTUFBeUI7SUFDekQsTUFBTUMsU0FBU0gsNkVBQW9CQSxDQUFDRTtJQUVwQyxPQUFPLFNBQVNFLE1BQU1DLEdBQW9CO1FBQ3hDLE1BQU1DLFFBQW1CO1lBQ3ZCQyxNQUFNRixJQUFJRyxXQUFXO1lBQ3JCQyxLQUFLO2dCQUNIQyxPQUFPLENBQUMsS0FBSyxFQUFFTCxJQUFJTSxRQUFRLEVBQUU7Z0JBQzdCQyxvQkFBb0JQLElBQUlPLGtCQUFrQjtnQkFDMUNDLE1BQU07b0JBQ0pDLFlBQVlULElBQUlTLFVBQVU7b0JBQzFCQyxXQUFXVixJQUFJVSxTQUFTO29CQUN4QkMsUUFBUVgsSUFBSVcsTUFBTTtvQkFDbEJDLGNBQWNaLElBQUlZLFlBQVk7b0JBQzlCQyxpQkFBaUJDLFFBQVFkLElBQUlTLFVBQVU7b0JBQ3ZDTSxrQkFBa0JmLElBQUllLGdCQUFnQjtnQkFDeEM7WUFDRjtRQUNGO1FBRUEsTUFBTUMsTUFBTWxCLE9BQU9tQixRQUFRLENBQUNoQjtRQUM1QixJQUFJZSxJQUFJRSxPQUFPLEtBQUssVUFBVUYsSUFBSUUsT0FBTyxLQUFLLFVBQVU7WUFDdEQsT0FBTztnQkFDTEMsSUFBSTtnQkFDSkMsU0FBU0osSUFBSUksT0FBTztnQkFDcEJDLFNBQVNMLElBQUlNLGFBQWEsSUFBSTtZQUNoQztRQUNGO1FBRUEsT0FBTztZQUFFSCxJQUFJO1lBQU1DLFNBQVNKLElBQUlJLE9BQU87UUFBQztJQUMxQztBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxpbnRlZ3JhdGlvbnNcXHRvb2xHdWFyZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVJbnB1dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgQmFuZVJ1bnRpbWVDb25maWcgfSBmcm9tICcuLi9ydW50aW1lL2NvbmZpZyc7XG5pbXBvcnQgeyBjcmVhdGVMaXZlQmFuZUVuZ2luZSB9IGZyb20gJy4uL3J1bnRpbWUvbGl2ZUJhbmVFbmdpbmUnO1xuXG5leHBvcnQgdHlwZSBUb29sQ2FsbENvbnRleHQgPSB7XG4gIHRvb2xOYW1lOiBzdHJpbmc7XG4gIHBheWxvYWRUZXh0OiBzdHJpbmc7XG4gIGlkZW50aXR5SWQ/OiBzdHJpbmc7XG4gIHNlc3Npb25JZD86IHN0cmluZztcbiAgaXBIYXNoPzogc3RyaW5nO1xuICBjYXBhYmlsaXRpZXM/OiBzdHJpbmdbXTtcbiAgc2Vzc2lvbkludGVncml0eT86IHsgbm9uY2VPaz86IGJvb2xlYW47IHNpZ25hdHVyZU9rPzogYm9vbGVhbjsgdG9rZW5GcmVzaD86IGJvb2xlYW4gfTtcbiAgcmVxdWlyZWRDYXBhYmlsaXR5OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBUb29sR3VhcmREZWNpc2lvbiA9XG4gIHwgeyBvazogdHJ1ZTsgdHJhY2VJZDogc3RyaW5nIH1cbiAgfCB7IG9rOiBmYWxzZTsgdHJhY2VJZDogc3RyaW5nOyBtZXNzYWdlOiBzdHJpbmcgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VCYW5lVG9vbEd1YXJkKGNvbmZpZzogQmFuZVJ1bnRpbWVDb25maWcpIHtcbiAgY29uc3QgZW5naW5lID0gY3JlYXRlTGl2ZUJhbmVFbmdpbmUoY29uZmlnKTtcblxuICByZXR1cm4gZnVuY3Rpb24gZ3VhcmQoY3R4OiBUb29sQ2FsbENvbnRleHQpOiBUb29sR3VhcmREZWNpc2lvbiB7XG4gICAgY29uc3QgaW5wdXQ6IEJhbmVJbnB1dCA9IHtcbiAgICAgIHRleHQ6IGN0eC5wYXlsb2FkVGV4dCxcbiAgICAgIHJlcToge1xuICAgICAgICByb3V0ZTogYHRvb2w6JHtjdHgudG9vbE5hbWV9YCxcbiAgICAgICAgcmVxdWlyZWRDYXBhYmlsaXR5OiBjdHgucmVxdWlyZWRDYXBhYmlsaXR5LFxuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgaWRlbnRpdHlJZDogY3R4LmlkZW50aXR5SWQsXG4gICAgICAgICAgc2Vzc2lvbklkOiBjdHguc2Vzc2lvbklkLFxuICAgICAgICAgIGlwSGFzaDogY3R4LmlwSGFzaCxcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IGN0eC5jYXBhYmlsaXRpZXMsXG4gICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBCb29sZWFuKGN0eC5pZGVudGl0eUlkKSxcbiAgICAgICAgICBzZXNzaW9uSW50ZWdyaXR5OiBjdHguc2Vzc2lvbkludGVncml0eSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IG91dCA9IGVuZ2luZS5ldmFsdWF0ZShpbnB1dCk7XG4gICAgaWYgKG91dC52ZXJkaWN0ID09PSAnZGVueScgfHwgb3V0LnZlcmRpY3QgPT09ICdyZXZpZXcnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvazogZmFsc2UsXG4gICAgICAgIHRyYWNlSWQ6IG91dC50cmFjZUlkLFxuICAgICAgICBtZXNzYWdlOiBvdXQucHVibGljTWVzc2FnZSA/PyAnVG9vbCBpbnZvY2F0aW9uIGJsb2NrZWQgYnkgcG9saWN5LicsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IG9rOiB0cnVlLCB0cmFjZUlkOiBvdXQudHJhY2VJZCB9O1xuICB9O1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUxpdmVCYW5lRW5naW5lIiwibWFrZUJhbmVUb29sR3VhcmQiLCJjb25maWciLCJlbmdpbmUiLCJndWFyZCIsImN0eCIsImlucHV0IiwidGV4dCIsInBheWxvYWRUZXh0IiwicmVxIiwicm91dGUiLCJ0b29sTmFtZSIsInJlcXVpcmVkQ2FwYWJpbGl0eSIsImF1dGgiLCJpZGVudGl0eUlkIiwic2Vzc2lvbklkIiwiaXBIYXNoIiwiY2FwYWJpbGl0aWVzIiwiaXNBdXRoZW50aWNhdGVkIiwiQm9vbGVhbiIsInNlc3Npb25JbnRlZ3JpdHkiLCJvdXQiLCJldmFsdWF0ZSIsInZlcmRpY3QiLCJvayIsInRyYWNlSWQiLCJtZXNzYWdlIiwicHVibGljTWVzc2FnZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/integrations/toolGuard.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/policy/banePolicy.ts":
/*!******************************************!*\
  !*** ../scing/bane/policy/banePolicy.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   policyForProfile: () => (/* binding */ policyForProfile)\n/* harmony export */ });\n/* harmony import */ var _profiles__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./profiles */ \"(api-node)/../scing/bane/policy/profiles.ts\");\n\nfunction policyForProfile(profileId) {\n    const id = profileId?.trim() || 'bane_fog_v1';\n    const profile = _profiles__WEBPACK_IMPORTED_MODULE_0__.BANE_POLICY_PROFILES[id] ?? _profiles__WEBPACK_IMPORTED_MODULE_0__.BANE_POLICY_PROFILES['bane_fog_v1'];\n    const d = profile.defaults;\n    return {\n        strictMode: d.strictMode,\n        defaultVerdict: d.defaultVerdict === 'deny' ? 'deny' : 'allow',\n        escalationEnabled: d.escalationEnabled,\n        quarantineOnDeny: d.quarantineOnDeny,\n        lockoutOnRepeat: d.lockoutOnRepeat,\n        incidentOnCritical: d.incidentOnCritical\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3BvbGljeS9iYW5lUG9saWN5LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWtEO0FBVzNDLFNBQVNDLGlCQUFpQkMsU0FBaUI7SUFDaEQsTUFBTUMsS0FBS0QsV0FBV0UsVUFBVTtJQUNoQyxNQUFNQyxVQUFVTCwyREFBb0IsQ0FBQ0csR0FBRyxJQUFJSCwyREFBb0IsQ0FBQyxjQUFjO0lBQy9FLE1BQU1NLElBQUlELFFBQVFFLFFBQVE7SUFDMUIsT0FBTztRQUNMQyxZQUFZRixFQUFFRSxVQUFVO1FBQ3hCQyxnQkFBZ0JILEVBQUVHLGNBQWMsS0FBSyxTQUFTLFNBQVM7UUFDdkRDLG1CQUFtQkosRUFBRUksaUJBQWlCO1FBQ3RDQyxrQkFBa0JMLEVBQUVLLGdCQUFnQjtRQUNwQ0MsaUJBQWlCTixFQUFFTSxlQUFlO1FBQ2xDQyxvQkFBb0JQLEVBQUVPLGtCQUFrQjtJQUMxQztBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxwb2xpY3lcXGJhbmVQb2xpY3kudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQkFORV9QT0xJQ1lfUFJPRklMRVMgfSBmcm9tICcuL3Byb2ZpbGVzJztcblxuZXhwb3J0IHR5cGUgUG9saWN5SGludHMgPSB7XG4gIHN0cmljdE1vZGU6IGJvb2xlYW47XG4gIGRlZmF1bHRWZXJkaWN0OiAnZGVueScgfCAnYWxsb3cnO1xuICBlc2NhbGF0aW9uRW5hYmxlZDogYm9vbGVhbjtcbiAgcXVhcmFudGluZU9uRGVueTogYm9vbGVhbjtcbiAgbG9ja291dE9uUmVwZWF0OiBib29sZWFuO1xuICBpbmNpZGVudE9uQ3JpdGljYWw6IGJvb2xlYW47XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gcG9saWN5Rm9yUHJvZmlsZShwcm9maWxlSWQ6IHN0cmluZyk6IFBvbGljeUhpbnRzIHtcbiAgY29uc3QgaWQgPSBwcm9maWxlSWQ/LnRyaW0oKSB8fCAnYmFuZV9mb2dfdjEnO1xuICBjb25zdCBwcm9maWxlID0gQkFORV9QT0xJQ1lfUFJPRklMRVNbaWRdID8/IEJBTkVfUE9MSUNZX1BST0ZJTEVTWydiYW5lX2ZvZ192MSddO1xuICBjb25zdCBkID0gcHJvZmlsZS5kZWZhdWx0cztcbiAgcmV0dXJuIHtcbiAgICBzdHJpY3RNb2RlOiBkLnN0cmljdE1vZGUsXG4gICAgZGVmYXVsdFZlcmRpY3Q6IGQuZGVmYXVsdFZlcmRpY3QgPT09ICdkZW55JyA/ICdkZW55JyA6ICdhbGxvdycsXG4gICAgZXNjYWxhdGlvbkVuYWJsZWQ6IGQuZXNjYWxhdGlvbkVuYWJsZWQsXG4gICAgcXVhcmFudGluZU9uRGVueTogZC5xdWFyYW50aW5lT25EZW55LFxuICAgIGxvY2tvdXRPblJlcGVhdDogZC5sb2Nrb3V0T25SZXBlYXQsXG4gICAgaW5jaWRlbnRPbkNyaXRpY2FsOiBkLmluY2lkZW50T25Dcml0aWNhbCxcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJCQU5FX1BPTElDWV9QUk9GSUxFUyIsInBvbGljeUZvclByb2ZpbGUiLCJwcm9maWxlSWQiLCJpZCIsInRyaW0iLCJwcm9maWxlIiwiZCIsImRlZmF1bHRzIiwic3RyaWN0TW9kZSIsImRlZmF1bHRWZXJkaWN0IiwiZXNjYWxhdGlvbkVuYWJsZWQiLCJxdWFyYW50aW5lT25EZW55IiwibG9ja291dE9uUmVwZWF0IiwiaW5jaWRlbnRPbkNyaXRpY2FsIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/policy/banePolicy.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/policy/profiles.ts":
/*!****************************************!*\
  !*** ../scing/bane/policy/profiles.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BANE_POLICY_PROFILES: () => (/* binding */ BANE_POLICY_PROFILES)\n/* harmony export */ });\nconst BANE_POLICY_PROFILES = {\n    bane_fog_v1: {\n        id: 'bane_fog_v1',\n        name: 'BANE Fear-of-God Mode',\n        version: '1.0.0',\n        rulesetId: 'fog-core',\n        defaults: {\n            defaultVerdict: 'deny',\n            strictMode: true,\n            escalationEnabled: true,\n            quarantineOnDeny: true,\n            lockoutOnRepeat: true,\n            incidentOnCritical: true\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3BvbGljeS9wcm9maWxlcy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBZU8sTUFBTUEsdUJBQTBEO0lBQ3JFQyxhQUFhO1FBQ1hDLElBQUk7UUFDSkMsTUFBTTtRQUNOQyxTQUFTO1FBQ1RDLFdBQVc7UUFDWEMsVUFBVTtZQUNSQyxnQkFBZ0I7WUFDaEJDLFlBQVk7WUFDWkMsbUJBQW1CO1lBQ25CQyxrQkFBa0I7WUFDbEJDLGlCQUFpQjtZQUNqQkMsb0JBQW9CO1FBQ3RCO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxwb2xpY3lcXHByb2ZpbGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIEJhbmVQb2xpY3lQcm9maWxlID0ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHZlcnNpb246IHN0cmluZztcbiAgcnVsZXNldElkOiBzdHJpbmc7XG4gIGRlZmF1bHRzOiB7XG4gICAgZGVmYXVsdFZlcmRpY3Q6ICdkZW55JztcbiAgICBzdHJpY3RNb2RlOiBib29sZWFuO1xuICAgIGVzY2FsYXRpb25FbmFibGVkOiBib29sZWFuO1xuICAgIHF1YXJhbnRpbmVPbkRlbnk6IGJvb2xlYW47XG4gICAgbG9ja291dE9uUmVwZWF0OiBib29sZWFuO1xuICAgIGluY2lkZW50T25Dcml0aWNhbDogYm9vbGVhbjtcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBCQU5FX1BPTElDWV9QUk9GSUxFUzogUmVjb3JkPHN0cmluZywgQmFuZVBvbGljeVByb2ZpbGU+ID0ge1xuICBiYW5lX2ZvZ192MToge1xuICAgIGlkOiAnYmFuZV9mb2dfdjEnLFxuICAgIG5hbWU6ICdCQU5FIEZlYXItb2YtR29kIE1vZGUnLFxuICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgcnVsZXNldElkOiAnZm9nLWNvcmUnLFxuICAgIGRlZmF1bHRzOiB7XG4gICAgICBkZWZhdWx0VmVyZGljdDogJ2RlbnknLFxuICAgICAgc3RyaWN0TW9kZTogdHJ1ZSxcbiAgICAgIGVzY2FsYXRpb25FbmFibGVkOiB0cnVlLFxuICAgICAgcXVhcmFudGluZU9uRGVueTogdHJ1ZSxcbiAgICAgIGxvY2tvdXRPblJlcGVhdDogdHJ1ZSxcbiAgICAgIGluY2lkZW50T25Dcml0aWNhbDogdHJ1ZSxcbiAgICB9LFxuICB9LFxufTtcbiJdLCJuYW1lcyI6WyJCQU5FX1BPTElDWV9QUk9GSUxFUyIsImJhbmVfZm9nX3YxIiwiaWQiLCJuYW1lIiwidmVyc2lvbiIsInJ1bGVzZXRJZCIsImRlZmF1bHRzIiwiZGVmYXVsdFZlcmRpY3QiLCJzdHJpY3RNb2RlIiwiZXNjYWxhdGlvbkVuYWJsZWQiLCJxdWFyYW50aW5lT25EZW55IiwibG9ja291dE9uUmVwZWF0IiwiaW5jaWRlbnRPbkNyaXRpY2FsIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/policy/profiles.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/containment.ts":
/*!********************************************!*\
  !*** ../scing/bane/runtime/containment.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   disableGlobalLockdown: () => (/* binding */ disableGlobalLockdown),\n/* harmony export */   enableGlobalLockdown: () => (/* binding */ enableGlobalLockdown),\n/* harmony export */   isGlobalLockdown: () => (/* binding */ isGlobalLockdown)\n/* harmony export */ });\nlet GLOBAL_LOCKDOWN = false;\nlet LOCKDOWN_REASON = 'unspecified';\nfunction enableGlobalLockdown(reason) {\n    GLOBAL_LOCKDOWN = true;\n    LOCKDOWN_REASON = reason || 'unspecified';\n}\nfunction disableGlobalLockdown() {\n    GLOBAL_LOCKDOWN = false;\n    LOCKDOWN_REASON = 'unspecified';\n}\nfunction isGlobalLockdown() {\n    return GLOBAL_LOCKDOWN ? {\n        active: true,\n        reason: LOCKDOWN_REASON\n    } : {\n        active: false\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvY29udGFpbm1lbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBSUEsa0JBQWtCO0FBQ3RCLElBQUlDLGtCQUFrQjtBQUVmLFNBQVNDLHFCQUFxQkMsTUFBYztJQUNqREgsa0JBQWtCO0lBQ2xCQyxrQkFBa0JFLFVBQVU7QUFDOUI7QUFFTyxTQUFTQztJQUNkSixrQkFBa0I7SUFDbEJDLGtCQUFrQjtBQUNwQjtBQUVPLFNBQVNJO0lBQ2QsT0FBT0wsa0JBQWtCO1FBQUVNLFFBQVE7UUFBTUgsUUFBUUY7SUFBZ0IsSUFBSTtRQUFFSyxRQUFRO0lBQU07QUFDdkYiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXGNvbnRhaW5tZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImxldCBHTE9CQUxfTE9DS0RPV04gPSBmYWxzZTtcbmxldCBMT0NLRE9XTl9SRUFTT04gPSAndW5zcGVjaWZpZWQnO1xuXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlR2xvYmFsTG9ja2Rvd24ocmVhc29uOiBzdHJpbmcpIHtcbiAgR0xPQkFMX0xPQ0tET1dOID0gdHJ1ZTtcbiAgTE9DS0RPV05fUkVBU09OID0gcmVhc29uIHx8ICd1bnNwZWNpZmllZCc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNhYmxlR2xvYmFsTG9ja2Rvd24oKSB7XG4gIEdMT0JBTF9MT0NLRE9XTiA9IGZhbHNlO1xuICBMT0NLRE9XTl9SRUFTT04gPSAndW5zcGVjaWZpZWQnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNHbG9iYWxMb2NrZG93bigpOiB7IGFjdGl2ZTogYm9vbGVhbjsgcmVhc29uPzogc3RyaW5nIH0ge1xuICByZXR1cm4gR0xPQkFMX0xPQ0tET1dOID8geyBhY3RpdmU6IHRydWUsIHJlYXNvbjogTE9DS0RPV05fUkVBU09OIH0gOiB7IGFjdGl2ZTogZmFsc2UgfTtcbn1cbiJdLCJuYW1lcyI6WyJHTE9CQUxfTE9DS0RPV04iLCJMT0NLRE9XTl9SRUFTT04iLCJlbmFibGVHbG9iYWxMb2NrZG93biIsInJlYXNvbiIsImRpc2FibGVHbG9iYWxMb2NrZG93biIsImlzR2xvYmFsTG9ja2Rvd24iLCJhY3RpdmUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/containment.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/escalation.ts":
/*!*******************************************!*\
  !*** ../scing/bane/runtime/escalation.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   escalate: () => (/* binding */ escalate)\n/* harmony export */ });\n/* harmony import */ var _riskLedger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./riskLedger */ \"(api-node)/../scing/bane/runtime/riskLedger.ts\");\n\nfunction escalate(identityId, severity) {\n    const rec = (0,_riskLedger__WEBPACK_IMPORTED_MODULE_0__.recordStrike)(identityId, severity);\n    if (severity === 'critical') {\n        (0,_riskLedger__WEBPACK_IMPORTED_MODULE_0__.lockIdentity)(identityId, 60 * 60 * 1000);\n        return 5;\n    }\n    if (rec.strikes >= 3) {\n        (0,_riskLedger__WEBPACK_IMPORTED_MODULE_0__.lockIdentity)(identityId, 15 * 60 * 1000);\n        return 4;\n    }\n    if (rec.strikes === 2) {\n        return 3;\n    }\n    return 2;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvZXNjYWxhdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUMwRDtBQUVuRCxTQUFTRSxTQUFTQyxVQUFrQixFQUFFQyxRQUFzQjtJQUNqRSxNQUFNQyxNQUFNTCx5REFBWUEsQ0FBQ0csWUFBWUM7SUFFckMsSUFBSUEsYUFBYSxZQUFZO1FBQzNCSCx5REFBWUEsQ0FBQ0UsWUFBWSxLQUFLLEtBQUs7UUFDbkMsT0FBTztJQUNUO0lBRUEsSUFBSUUsSUFBSUMsT0FBTyxJQUFJLEdBQUc7UUFDcEJMLHlEQUFZQSxDQUFDRSxZQUFZLEtBQUssS0FBSztRQUNuQyxPQUFPO0lBQ1Q7SUFFQSxJQUFJRSxJQUFJQyxPQUFPLEtBQUssR0FBRztRQUNyQixPQUFPO0lBQ1Q7SUFFQSxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXGVzY2FsYXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBCYW5lRW5mb3JjZW1lbnRMZXZlbCwgQmFuZVNldmVyaXR5IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgcmVjb3JkU3RyaWtlLCBsb2NrSWRlbnRpdHkgfSBmcm9tICcuL3Jpc2tMZWRnZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gZXNjYWxhdGUoaWRlbnRpdHlJZDogc3RyaW5nLCBzZXZlcml0eTogQmFuZVNldmVyaXR5KTogQmFuZUVuZm9yY2VtZW50TGV2ZWwge1xuICBjb25zdCByZWMgPSByZWNvcmRTdHJpa2UoaWRlbnRpdHlJZCwgc2V2ZXJpdHkpO1xuXG4gIGlmIChzZXZlcml0eSA9PT0gJ2NyaXRpY2FsJykge1xuICAgIGxvY2tJZGVudGl0eShpZGVudGl0eUlkLCA2MCAqIDYwICogMTAwMCk7XG4gICAgcmV0dXJuIDU7XG4gIH1cblxuICBpZiAocmVjLnN0cmlrZXMgPj0gMykge1xuICAgIGxvY2tJZGVudGl0eShpZGVudGl0eUlkLCAxNSAqIDYwICogMTAwMCk7XG4gICAgcmV0dXJuIDQ7XG4gIH1cblxuICBpZiAocmVjLnN0cmlrZXMgPT09IDIpIHtcbiAgICByZXR1cm4gMztcbiAgfVxuXG4gIHJldHVybiAyO1xufVxuIl0sIm5hbWVzIjpbInJlY29yZFN0cmlrZSIsImxvY2tJZGVudGl0eSIsImVzY2FsYXRlIiwiaWRlbnRpdHlJZCIsInNldmVyaXR5IiwicmVjIiwic3RyaWtlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/escalation.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/incident.ts":
/*!*****************************************!*\
  !*** ../scing/bane/runtime/incident.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toIncidentRecord: () => (/* binding */ toIncidentRecord)\n/* harmony export */ });\nfunction toIncidentRecord(out, ctx) {\n    return {\n        traceId: out.traceId,\n        occurredAt: Date.now(),\n        identityId: ctx?.identityId,\n        sessionId: ctx?.sessionId,\n        ipHash: ctx?.ipHash,\n        enforcementLevel: out.enforcementLevel ?? 0,\n        verdict: out.verdict,\n        severity: out.severity,\n        findingsSummary: (out.findings ?? []).map((f)=>({\n                id: f.id,\n                severity: f.severity,\n                verdict: f.verdict\n            }))\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvaW5jaWRlbnQudHMiLCJtYXBwaW5ncyI6Ijs7OztBQWNPLFNBQVNBLGlCQUNkQyxHQUFlLEVBQ2ZDLEdBQWtFO0lBRWxFLE9BQU87UUFDTEMsU0FBU0YsSUFBSUUsT0FBTztRQUNwQkMsWUFBWUMsS0FBS0MsR0FBRztRQUNwQkMsWUFBWUwsS0FBS0s7UUFDakJDLFdBQVdOLEtBQUtNO1FBQ2hCQyxRQUFRUCxLQUFLTztRQUNiQyxrQkFBa0JULElBQUlTLGdCQUFnQixJQUFJO1FBQzFDQyxTQUFTVixJQUFJVSxPQUFPO1FBQ3BCQyxVQUFVWCxJQUFJVyxRQUFRO1FBQ3RCQyxpQkFBaUIsQ0FBQ1osSUFBSWEsUUFBUSxJQUFJLEVBQUUsRUFBRUMsR0FBRyxDQUFDLENBQUNDLElBQU87Z0JBQ2hEQyxJQUFJRCxFQUFFQyxFQUFFO2dCQUNSTCxVQUFVSSxFQUFFSixRQUFRO2dCQUNwQkQsU0FBU0ssRUFBRUwsT0FBTztZQUNwQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXGluY2lkZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZU91dHB1dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IHR5cGUgQmFuZUluY2lkZW50UmVjb3JkID0ge1xuICB0cmFjZUlkOiBzdHJpbmc7XG4gIG9jY3VycmVkQXQ6IG51bWJlcjtcbiAgaWRlbnRpdHlJZD86IHN0cmluZztcbiAgc2Vzc2lvbklkPzogc3RyaW5nO1xuICBpcEhhc2g/OiBzdHJpbmc7XG4gIGVuZm9yY2VtZW50TGV2ZWw6IG51bWJlcjtcbiAgdmVyZGljdDogc3RyaW5nO1xuICBzZXZlcml0eTogc3RyaW5nO1xuICBmaW5kaW5nc1N1bW1hcnk6IEFycmF5PHsgaWQ6IHN0cmluZzsgc2V2ZXJpdHk6IHN0cmluZzsgdmVyZGljdDogc3RyaW5nIH0+O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHRvSW5jaWRlbnRSZWNvcmQoXG4gIG91dDogQmFuZU91dHB1dCxcbiAgY3R4PzogeyBpZGVudGl0eUlkPzogc3RyaW5nOyBzZXNzaW9uSWQ/OiBzdHJpbmc7IGlwSGFzaD86IHN0cmluZyB9XG4pOiBCYW5lSW5jaWRlbnRSZWNvcmQge1xuICByZXR1cm4ge1xuICAgIHRyYWNlSWQ6IG91dC50cmFjZUlkLFxuICAgIG9jY3VycmVkQXQ6IERhdGUubm93KCksXG4gICAgaWRlbnRpdHlJZDogY3R4Py5pZGVudGl0eUlkLFxuICAgIHNlc3Npb25JZDogY3R4Py5zZXNzaW9uSWQsXG4gICAgaXBIYXNoOiBjdHg/LmlwSGFzaCxcbiAgICBlbmZvcmNlbWVudExldmVsOiBvdXQuZW5mb3JjZW1lbnRMZXZlbCA/PyAwLFxuICAgIHZlcmRpY3Q6IG91dC52ZXJkaWN0LFxuICAgIHNldmVyaXR5OiBvdXQuc2V2ZXJpdHksXG4gICAgZmluZGluZ3NTdW1tYXJ5OiAob3V0LmZpbmRpbmdzID8/IFtdKS5tYXAoKGYpID0+ICh7XG4gICAgICBpZDogZi5pZCxcbiAgICAgIHNldmVyaXR5OiBmLnNldmVyaXR5LFxuICAgICAgdmVyZGljdDogZi52ZXJkaWN0LFxuICAgIH0pKSxcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJ0b0luY2lkZW50UmVjb3JkIiwib3V0IiwiY3R4IiwidHJhY2VJZCIsIm9jY3VycmVkQXQiLCJEYXRlIiwibm93IiwiaWRlbnRpdHlJZCIsInNlc3Npb25JZCIsImlwSGFzaCIsImVuZm9yY2VtZW50TGV2ZWwiLCJ2ZXJkaWN0Iiwic2V2ZXJpdHkiLCJmaW5kaW5nc1N1bW1hcnkiLCJmaW5kaW5ncyIsIm1hcCIsImYiLCJpZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/incident.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/integrity.ts":
/*!******************************************!*\
  !*** ../scing/bane/runtime/integrity.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkIntegrity: () => (/* binding */ checkIntegrity)\n/* harmony export */ });\nconst seenNonces = new Map();\nfunction checkIntegrity(input) {\n    const auth = input.req?.auth;\n    const nonce = auth?.nonce;\n    const now = Date.now();\n    if (nonce) {\n        const prev = seenNonces.get(nonce);\n        if (prev && now - prev < 10 * 60 * 1000) return {\n            ok: false,\n            code: 'REPLAY'\n        };\n        seenNonces.set(nonce, now);\n        if (seenNonces.size > 10000) {\n            const firstKey = seenNonces.keys().next().value;\n            if (firstKey) seenNonces.delete(firstKey);\n        }\n    }\n    // Signature verification is environment-specific; hook only.\n    // If your gateway provides signature validation upstream, leave this as ok.\n    return {\n        ok: true\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvaW50ZWdyaXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFJQSxNQUFNQSxhQUFhLElBQUlDO0FBRWhCLFNBQVNDLGVBQWVDLEtBQWdCO0lBQzdDLE1BQU1DLE9BQU9ELE1BQU1FLEdBQUcsRUFBRUQ7SUFDeEIsTUFBTUUsUUFBUUYsTUFBTUU7SUFDcEIsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUVwQixJQUFJRCxPQUFPO1FBQ1QsTUFBTUcsT0FBT1QsV0FBV1UsR0FBRyxDQUFDSjtRQUM1QixJQUFJRyxRQUFRRixNQUFNRSxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU87WUFBRUUsSUFBSTtZQUFPQyxNQUFNO1FBQVM7UUFDNUVaLFdBQVdhLEdBQUcsQ0FBQ1AsT0FBT0M7UUFFdEIsSUFBSVAsV0FBV2MsSUFBSSxHQUFHLE9BQVE7WUFDNUIsTUFBTUMsV0FBV2YsV0FBV2dCLElBQUksR0FBR0MsSUFBSSxHQUFHQyxLQUFLO1lBQy9DLElBQUlILFVBQVVmLFdBQVdtQixNQUFNLENBQUNKO1FBQ2xDO0lBQ0Y7SUFFQSw2REFBNkQ7SUFDN0QsNEVBQTRFO0lBQzVFLE9BQU87UUFBRUosSUFBSTtJQUFLO0FBQ3BCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxydW50aW1lXFxpbnRlZ3JpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBCYW5lSW5wdXQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCB0eXBlIEludGVncml0eVJlc3VsdCA9IHsgb2s6IHRydWUgfSB8IHsgb2s6IGZhbHNlOyBjb2RlOiAnUkVQTEFZJyB8ICdCQURfU0lHTkFUVVJFJyB9O1xuXG5jb25zdCBzZWVuTm9uY2VzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSW50ZWdyaXR5KGlucHV0OiBCYW5lSW5wdXQpOiBJbnRlZ3JpdHlSZXN1bHQge1xuICBjb25zdCBhdXRoID0gaW5wdXQucmVxPy5hdXRoO1xuICBjb25zdCBub25jZSA9IGF1dGg/Lm5vbmNlO1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gIGlmIChub25jZSkge1xuICAgIGNvbnN0IHByZXYgPSBzZWVuTm9uY2VzLmdldChub25jZSk7XG4gICAgaWYgKHByZXYgJiYgbm93IC0gcHJldiA8IDEwICogNjAgKiAxMDAwKSByZXR1cm4geyBvazogZmFsc2UsIGNvZGU6ICdSRVBMQVknIH07XG4gICAgc2Vlbk5vbmNlcy5zZXQobm9uY2UsIG5vdyk7XG5cbiAgICBpZiAoc2Vlbk5vbmNlcy5zaXplID4gMTBfMDAwKSB7XG4gICAgICBjb25zdCBmaXJzdEtleSA9IHNlZW5Ob25jZXMua2V5cygpLm5leHQoKS52YWx1ZSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICBpZiAoZmlyc3RLZXkpIHNlZW5Ob25jZXMuZGVsZXRlKGZpcnN0S2V5KTtcbiAgICB9XG4gIH1cblxuICAvLyBTaWduYXR1cmUgdmVyaWZpY2F0aW9uIGlzIGVudmlyb25tZW50LXNwZWNpZmljOyBob29rIG9ubHkuXG4gIC8vIElmIHlvdXIgZ2F0ZXdheSBwcm92aWRlcyBzaWduYXR1cmUgdmFsaWRhdGlvbiB1cHN0cmVhbSwgbGVhdmUgdGhpcyBhcyBvay5cbiAgcmV0dXJuIHsgb2s6IHRydWUgfTtcbn1cbiJdLCJuYW1lcyI6WyJzZWVuTm9uY2VzIiwiTWFwIiwiY2hlY2tJbnRlZ3JpdHkiLCJpbnB1dCIsImF1dGgiLCJyZXEiLCJub25jZSIsIm5vdyIsIkRhdGUiLCJwcmV2IiwiZ2V0Iiwib2siLCJjb2RlIiwic2V0Iiwic2l6ZSIsImZpcnN0S2V5Iiwia2V5cyIsIm5leHQiLCJ2YWx1ZSIsImRlbGV0ZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/integrity.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/liveBaneEngine.ts":
/*!***********************************************!*\
  !*** ../scing/bane/runtime/liveBaneEngine.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLiveBaneEngine: () => (/* binding */ createLiveBaneEngine)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _policy_banePolicy__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../policy/banePolicy */ \"(api-node)/../scing/bane/policy/banePolicy.ts\");\n/* harmony import */ var _core_detectors_baseline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/detectors.baseline */ \"(api-node)/../scing/bane/core/detectors.baseline.ts\");\n/* harmony import */ var _core_detectors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/detectors */ \"(api-node)/../scing/bane/core/detectors.ts\");\n/* harmony import */ var _core_aggregate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/aggregate */ \"(api-node)/../scing/bane/core/aggregate.ts\");\n/* harmony import */ var _core_sortFindings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../core/sortFindings */ \"(api-node)/../scing/bane/core/sortFindings.ts\");\n/* harmony import */ var _core_redaction__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../core/redaction */ \"(api-node)/../scing/bane/core/redaction.ts\");\n/* harmony import */ var _core_redactionFromFindings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../core/redactionFromFindings */ \"(api-node)/../scing/bane/core/redactionFromFindings.ts\");\n/* harmony import */ var _preflight__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./preflight */ \"(api-node)/../scing/bane/runtime/preflight.ts\");\n/* harmony import */ var _escalation__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./escalation */ \"(api-node)/../scing/bane/runtime/escalation.ts\");\n/* harmony import */ var _throttle__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./throttle */ \"(api-node)/../scing/bane/runtime/throttle.ts\");\n/* harmony import */ var _incident__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./incident */ \"(api-node)/../scing/bane/runtime/incident.ts\");\n/* harmony import */ var _normalize__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./normalize */ \"(api-node)/../scing/bane/runtime/normalize.ts\");\n/* harmony import */ var _publicResponse__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./publicResponse */ \"(api-node)/../scing/bane/runtime/publicResponse.ts\");\n/* harmony import */ var _safeSideEffects__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./safeSideEffects */ \"(api-node)/../scing/bane/runtime/safeSideEffects.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction traceIdFromEntropy() {\n    if (typeof (node_crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID) === 'function') return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID();\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(16).toString('hex');\n}\nfunction publicMessageFor(params) {\n    if (params.verdict === 'deny') {\n        return params.enforcementLevel >= 4 ? 'Access revoked temporarily due to policy violations. Contact an authorized administrator.' : 'Request denied: unauthorized or unsafe operation. This attempt has been logged.';\n    }\n    if (params.verdict === 'review') {\n        return 'Request restricted by policy. Additional authorization is required.';\n    }\n    return undefined;\n}\nfunction createLiveBaneEngine(config) {\n    const hints = (0,_policy_banePolicy__WEBPACK_IMPORTED_MODULE_1__.policyForProfile)(config.profileId);\n    return {\n        evaluate (input) {\n            const t0 = Date.now();\n            const traceId = traceIdFromEntropy();\n            const normalized = (0,_normalize__WEBPACK_IMPORTED_MODULE_12__.normalizeForDetection)(input);\n            const pre = (0,_preflight__WEBPACK_IMPORTED_MODULE_8__.banePreflight)(config, input, traceId, t0);\n            if (pre) {\n                const auth = input.req?.auth;\n                if (pre.verdict === 'deny') {\n                    (0,_throttle__WEBPACK_IMPORTED_MODULE_10__.noteHostileAttempt)({\n                        identityId: auth?.identityId,\n                        ipHash: auth?.ipHash\n                    });\n                    const throttle = (0,_throttle__WEBPACK_IMPORTED_MODULE_10__.decideThrottle)({\n                        identityId: auth?.identityId,\n                        ipHash: auth?.ipHash\n                    });\n                    pre.throttle = throttle;\n                }\n                pre.findings = (0,_core_sortFindings__WEBPACK_IMPORTED_MODULE_5__.sortFindings)(pre.findings);\n                const final = (0,_publicResponse__WEBPACK_IMPORTED_MODULE_13__.finalizePublicFacing)(pre);\n                (0,_safeSideEffects__WEBPACK_IMPORTED_MODULE_14__.safeSideEffects)(config, input, final);\n                return final;\n            }\n            const detectors = (0,_core_detectors_baseline__WEBPACK_IMPORTED_MODULE_2__.baselineDetectors)();\n            const rawFindings = (0,_core_detectors__WEBPACK_IMPORTED_MODULE_3__.runDetectors)(detectors, normalized.forDetection, hints);\n            const findings = (0,_core_sortFindings__WEBPACK_IMPORTED_MODULE_5__.sortFindings)(rawFindings);\n            const agg = (0,_core_aggregate__WEBPACK_IMPORTED_MODULE_4__.aggregate)(findings);\n            let enforcementLevel = agg.verdict === 'deny' ? 3 : agg.verdict === 'review' ? 2 : agg.verdict === 'sanitize' ? 1 : 0;\n            const identityId = input.req?.auth?.identityId;\n            if (agg.verdict === 'deny' && identityId && hints.escalationEnabled) {\n                enforcementLevel = (0,_escalation__WEBPACK_IMPORTED_MODULE_9__.escalate)(identityId, agg.severity);\n            }\n            const spans = (0,_core_redactionFromFindings__WEBPACK_IMPORTED_MODULE_7__.redactionsFromFindings)(input.text, findings);\n            const safeText = (agg.verdict === 'sanitize' || agg.verdict === 'review') && spans.length ? (0,_core_redaction__WEBPACK_IMPORTED_MODULE_6__.applyRedactions)(input.text, spans) : undefined;\n            const out = {\n                verdict: agg.verdict,\n                severity: agg.severity,\n                findings,\n                redactions: spans.length ? spans : undefined,\n                safeText,\n                traceId,\n                timingMs: Date.now() - t0,\n                enforcementLevel,\n                publicMessage: publicMessageFor({\n                    verdict: agg.verdict,\n                    enforcementLevel\n                })\n            };\n            if (out.verdict === 'deny') {\n                (0,_throttle__WEBPACK_IMPORTED_MODULE_10__.noteHostileAttempt)({\n                    identityId,\n                    ipHash: input.req?.auth?.ipHash\n                });\n                out.throttle = (0,_throttle__WEBPACK_IMPORTED_MODULE_10__.decideThrottle)({\n                    identityId,\n                    ipHash: input.req?.auth?.ipHash\n                });\n            }\n            if (out.enforcementLevel === 5 && hints.incidentOnCritical) {\n                const incident = (0,_incident__WEBPACK_IMPORTED_MODULE_11__.toIncidentRecord)(out, {\n                    identityId,\n                    sessionId: input.req?.auth?.sessionId,\n                    ipHash: input.req?.auth?.ipHash\n                });\n                try {\n                    void config.store?.appendIncident?.(incident).catch(()=>{});\n                } catch  {\n                // swallow\n                }\n            }\n            const final = (0,_publicResponse__WEBPACK_IMPORTED_MODULE_13__.finalizePublicFacing)(out);\n            (0,_safeSideEffects__WEBPACK_IMPORTED_MODULE_14__.safeSideEffects)(config, input, final);\n            return final;\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvbGl2ZUJhbmVFbmdpbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUM7QUFJdUI7QUFDTztBQUNkO0FBQ0g7QUFDTTtBQUNBO0FBQ21CO0FBQzNCO0FBQ0o7QUFDd0I7QUFDbEI7QUFDTTtBQUNJO0FBQ0o7QUFFcEQsU0FBU2dCO0lBQ1AsSUFBSSxPQUFPaEIsK0RBQWlCLEtBQUssWUFBWSxPQUFPQSw2REFBaUI7SUFDckUsT0FBT0EsOERBQWtCLENBQUMsSUFBSW1CLFFBQVEsQ0FBQztBQUN6QztBQUVBLFNBQVNDLGlCQUFpQkMsTUFHekI7SUFDQyxJQUFJQSxPQUFPQyxPQUFPLEtBQUssUUFBUTtRQUM3QixPQUFPRCxPQUFPRSxnQkFBZ0IsSUFBSSxJQUM5Qiw4RkFDQTtJQUNOO0lBQ0EsSUFBSUYsT0FBT0MsT0FBTyxLQUFLLFVBQVU7UUFDL0IsT0FBTztJQUNUO0lBQ0EsT0FBT0U7QUFDVDtBQUVPLFNBQVNDLHFCQUFxQkMsTUFBeUI7SUFDNUQsTUFBTUMsUUFBUTFCLG9FQUFnQkEsQ0FBQ3lCLE9BQU9FLFNBQVM7SUFFL0MsT0FBTztRQUNMQyxVQUFTQyxLQUFnQjtZQUN2QixNQUFNQyxLQUFLQyxLQUFLQyxHQUFHO1lBQ25CLE1BQU1DLFVBQVVsQjtZQUVoQixNQUFNbUIsYUFBYXRCLGtFQUFxQkEsQ0FBQ2lCO1lBRXpDLE1BQU1NLE1BQU01Qix5REFBYUEsQ0FBQ2tCLFFBQVFJLE9BQU9JLFNBQVNIO1lBQ2xELElBQUlLLEtBQUs7Z0JBQ1AsTUFBTUMsT0FBT1AsTUFBTVEsR0FBRyxFQUFFRDtnQkFDeEIsSUFBSUQsSUFBSWQsT0FBTyxLQUFLLFFBQVE7b0JBQzFCWiw4REFBa0JBLENBQUM7d0JBQUU2QixZQUFZRixNQUFNRTt3QkFBWUMsUUFBUUgsTUFBTUc7b0JBQU87b0JBQ3hFLE1BQU1DLFdBQVc5QiwwREFBY0EsQ0FBQzt3QkFBRTRCLFlBQVlGLE1BQU1FO3dCQUFZQyxRQUFRSCxNQUFNRztvQkFBTztvQkFDckZKLElBQUlLLFFBQVEsR0FBR0E7Z0JBQ2pCO2dCQUVBTCxJQUFJTSxRQUFRLEdBQUdyQyxnRUFBWUEsQ0FBQytCLElBQUlNLFFBQVE7Z0JBQ3hDLE1BQU1DLFFBQVE3QixzRUFBb0JBLENBQUNzQjtnQkFDbkNyQixrRUFBZUEsQ0FBQ1csUUFBUUksT0FBT2E7Z0JBQy9CLE9BQU9BO1lBQ1Q7WUFFQSxNQUFNQyxZQUFZMUMsMkVBQWlCQTtZQUNuQyxNQUFNMkMsY0FBYzFDLDZEQUFZQSxDQUFDeUMsV0FBV1QsV0FBV1csWUFBWSxFQUFFbkI7WUFDckUsTUFBTWUsV0FBV3JDLGdFQUFZQSxDQUFDd0M7WUFDOUIsTUFBTUUsTUFBTTNDLDBEQUFTQSxDQUFDc0M7WUFFdEIsSUFBSW5CLG1CQUNGd0IsSUFBSXpCLE9BQU8sS0FBSyxTQUNaLElBQ0F5QixJQUFJekIsT0FBTyxLQUFLLFdBQ2QsSUFDQXlCLElBQUl6QixPQUFPLEtBQUssYUFDZCxJQUNBO1lBRVYsTUFBTWlCLGFBQWFULE1BQU1RLEdBQUcsRUFBRUQsTUFBTUU7WUFDcEMsSUFBSVEsSUFBSXpCLE9BQU8sS0FBSyxVQUFVaUIsY0FBY1osTUFBTXFCLGlCQUFpQixFQUFFO2dCQUNuRXpCLG1CQUFtQmQscURBQVFBLENBQUM4QixZQUFZUSxJQUFJRSxRQUFRO1lBQ3REO1lBRUEsTUFBTUMsUUFBUTNDLG1GQUFzQkEsQ0FBQ3VCLE1BQU1xQixJQUFJLEVBQUVUO1lBQ2pELE1BQU1VLFdBQ0osQ0FBQ0wsSUFBSXpCLE9BQU8sS0FBSyxjQUFjeUIsSUFBSXpCLE9BQU8sS0FBSyxRQUFPLEtBQU00QixNQUFNRyxNQUFNLEdBQ3BFL0MsZ0VBQWVBLENBQUN3QixNQUFNcUIsSUFBSSxFQUFFRCxTQUM1QjFCO1lBRU4sTUFBTThCLE1BQWtCO2dCQUN0QmhDLFNBQVN5QixJQUFJekIsT0FBTztnQkFDcEIyQixVQUFVRixJQUFJRSxRQUFRO2dCQUN0QlA7Z0JBQ0FhLFlBQVlMLE1BQU1HLE1BQU0sR0FBR0gsUUFBUTFCO2dCQUNuQzRCO2dCQUNBbEI7Z0JBQ0FzQixVQUFVeEIsS0FBS0MsR0FBRyxLQUFLRjtnQkFDdkJSO2dCQUNBa0MsZUFBZXJDLGlCQUFpQjtvQkFBRUUsU0FBU3lCLElBQUl6QixPQUFPO29CQUFFQztnQkFBaUI7WUFDM0U7WUFFQSxJQUFJK0IsSUFBSWhDLE9BQU8sS0FBSyxRQUFRO2dCQUMxQlosOERBQWtCQSxDQUFDO29CQUFFNkI7b0JBQVlDLFFBQVFWLE1BQU1RLEdBQUcsRUFBRUQsTUFBTUc7Z0JBQU87Z0JBQ2pFYyxJQUFJYixRQUFRLEdBQUc5QiwwREFBY0EsQ0FBQztvQkFBRTRCO29CQUFZQyxRQUFRVixNQUFNUSxHQUFHLEVBQUVELE1BQU1HO2dCQUFPO1lBQzlFO1lBRUEsSUFBSWMsSUFBSS9CLGdCQUFnQixLQUFLLEtBQUtJLE1BQU0rQixrQkFBa0IsRUFBRTtnQkFDMUQsTUFBTUMsV0FBVy9DLDREQUFnQkEsQ0FBQzBDLEtBQUs7b0JBQ3JDZjtvQkFDQXFCLFdBQVc5QixNQUFNUSxHQUFHLEVBQUVELE1BQU11QjtvQkFDNUJwQixRQUFRVixNQUFNUSxHQUFHLEVBQUVELE1BQU1HO2dCQUMzQjtnQkFDQSxJQUFJO29CQUNGLEtBQUtkLE9BQU9tQyxLQUFLLEVBQUVDLGlCQUFpQkgsVUFBaUJJLE1BQU0sS0FBTztnQkFDcEUsRUFBRSxPQUFNO2dCQUNOLFVBQVU7Z0JBQ1o7WUFDRjtZQUVBLE1BQU1wQixRQUFRN0Isc0VBQW9CQSxDQUFDd0M7WUFDbkN2QyxrRUFBZUEsQ0FBQ1csUUFBUUksT0FBT2E7WUFDL0IsT0FBT0E7UUFDVDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXGxpdmVCYW5lRW5naW5lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnbm9kZTpjcnlwdG8nO1xuXG5pbXBvcnQgdHlwZSB7IEJhbmVJbnB1dCwgQmFuZU91dHB1dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgQmFuZVJ1bnRpbWVDb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgeyBwb2xpY3lGb3JQcm9maWxlIH0gZnJvbSAnLi4vcG9saWN5L2JhbmVQb2xpY3knO1xuaW1wb3J0IHsgYmFzZWxpbmVEZXRlY3RvcnMgfSBmcm9tICcuLi9jb3JlL2RldGVjdG9ycy5iYXNlbGluZSc7XG5pbXBvcnQgeyBydW5EZXRlY3RvcnMgfSBmcm9tICcuLi9jb3JlL2RldGVjdG9ycyc7XG5pbXBvcnQgeyBhZ2dyZWdhdGUgfSBmcm9tICcuLi9jb3JlL2FnZ3JlZ2F0ZSc7XG5pbXBvcnQgeyBzb3J0RmluZGluZ3MgfSBmcm9tICcuLi9jb3JlL3NvcnRGaW5kaW5ncyc7XG5pbXBvcnQgeyBhcHBseVJlZGFjdGlvbnMgfSBmcm9tICcuLi9jb3JlL3JlZGFjdGlvbic7XG5pbXBvcnQgeyByZWRhY3Rpb25zRnJvbUZpbmRpbmdzIH0gZnJvbSAnLi4vY29yZS9yZWRhY3Rpb25Gcm9tRmluZGluZ3MnO1xuaW1wb3J0IHsgYmFuZVByZWZsaWdodCB9IGZyb20gJy4vcHJlZmxpZ2h0JztcbmltcG9ydCB7IGVzY2FsYXRlIH0gZnJvbSAnLi9lc2NhbGF0aW9uJztcbmltcG9ydCB7IG5vdGVIb3N0aWxlQXR0ZW1wdCwgZGVjaWRlVGhyb3R0bGUgfSBmcm9tICcuL3Rocm90dGxlJztcbmltcG9ydCB7IHRvSW5jaWRlbnRSZWNvcmQgfSBmcm9tICcuL2luY2lkZW50JztcbmltcG9ydCB7IG5vcm1hbGl6ZUZvckRldGVjdGlvbiB9IGZyb20gJy4vbm9ybWFsaXplJztcbmltcG9ydCB7IGZpbmFsaXplUHVibGljRmFjaW5nIH0gZnJvbSAnLi9wdWJsaWNSZXNwb25zZSc7XG5pbXBvcnQgeyBzYWZlU2lkZUVmZmVjdHMgfSBmcm9tICcuL3NhZmVTaWRlRWZmZWN0cyc7XG5cbmZ1bmN0aW9uIHRyYWNlSWRGcm9tRW50cm9weSgpOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIGNyeXB0by5yYW5kb21VVUlEID09PSAnZnVuY3Rpb24nKSByZXR1cm4gY3J5cHRvLnJhbmRvbVVVSUQoKTtcbiAgcmV0dXJuIGNyeXB0by5yYW5kb21CeXRlcygxNikudG9TdHJpbmcoJ2hleCcpO1xufVxuXG5mdW5jdGlvbiBwdWJsaWNNZXNzYWdlRm9yKHBhcmFtczoge1xuICB2ZXJkaWN0OiBCYW5lT3V0cHV0Wyd2ZXJkaWN0J107XG4gIGVuZm9yY2VtZW50TGV2ZWw6IG51bWJlcjtcbn0pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAocGFyYW1zLnZlcmRpY3QgPT09ICdkZW55Jykge1xuICAgIHJldHVybiBwYXJhbXMuZW5mb3JjZW1lbnRMZXZlbCA+PSA0XG4gICAgICA/ICdBY2Nlc3MgcmV2b2tlZCB0ZW1wb3JhcmlseSBkdWUgdG8gcG9saWN5IHZpb2xhdGlvbnMuIENvbnRhY3QgYW4gYXV0aG9yaXplZCBhZG1pbmlzdHJhdG9yLidcbiAgICAgIDogJ1JlcXVlc3QgZGVuaWVkOiB1bmF1dGhvcml6ZWQgb3IgdW5zYWZlIG9wZXJhdGlvbi4gVGhpcyBhdHRlbXB0IGhhcyBiZWVuIGxvZ2dlZC4nO1xuICB9XG4gIGlmIChwYXJhbXMudmVyZGljdCA9PT0gJ3JldmlldycpIHtcbiAgICByZXR1cm4gJ1JlcXVlc3QgcmVzdHJpY3RlZCBieSBwb2xpY3kuIEFkZGl0aW9uYWwgYXV0aG9yaXphdGlvbiBpcyByZXF1aXJlZC4nO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMaXZlQmFuZUVuZ2luZShjb25maWc6IEJhbmVSdW50aW1lQ29uZmlnKSB7XG4gIGNvbnN0IGhpbnRzID0gcG9saWN5Rm9yUHJvZmlsZShjb25maWcucHJvZmlsZUlkKTtcblxuICByZXR1cm4ge1xuICAgIGV2YWx1YXRlKGlucHV0OiBCYW5lSW5wdXQpOiBCYW5lT3V0cHV0IHtcbiAgICAgIGNvbnN0IHQwID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHRyYWNlSWQgPSB0cmFjZUlkRnJvbUVudHJvcHkoKTtcblxuICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUZvckRldGVjdGlvbihpbnB1dCk7XG5cbiAgICAgIGNvbnN0IHByZSA9IGJhbmVQcmVmbGlnaHQoY29uZmlnLCBpbnB1dCwgdHJhY2VJZCwgdDApO1xuICAgICAgaWYgKHByZSkge1xuICAgICAgICBjb25zdCBhdXRoID0gaW5wdXQucmVxPy5hdXRoO1xuICAgICAgICBpZiAocHJlLnZlcmRpY3QgPT09ICdkZW55Jykge1xuICAgICAgICAgIG5vdGVIb3N0aWxlQXR0ZW1wdCh7IGlkZW50aXR5SWQ6IGF1dGg/LmlkZW50aXR5SWQsIGlwSGFzaDogYXV0aD8uaXBIYXNoIH0pO1xuICAgICAgICAgIGNvbnN0IHRocm90dGxlID0gZGVjaWRlVGhyb3R0bGUoeyBpZGVudGl0eUlkOiBhdXRoPy5pZGVudGl0eUlkLCBpcEhhc2g6IGF1dGg/LmlwSGFzaCB9KTtcbiAgICAgICAgICBwcmUudGhyb3R0bGUgPSB0aHJvdHRsZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByZS5maW5kaW5ncyA9IHNvcnRGaW5kaW5ncyhwcmUuZmluZGluZ3MpO1xuICAgICAgICBjb25zdCBmaW5hbCA9IGZpbmFsaXplUHVibGljRmFjaW5nKHByZSk7XG4gICAgICAgIHNhZmVTaWRlRWZmZWN0cyhjb25maWcsIGlucHV0LCBmaW5hbCk7XG4gICAgICAgIHJldHVybiBmaW5hbDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGV0ZWN0b3JzID0gYmFzZWxpbmVEZXRlY3RvcnMoKTtcbiAgICAgIGNvbnN0IHJhd0ZpbmRpbmdzID0gcnVuRGV0ZWN0b3JzKGRldGVjdG9ycywgbm9ybWFsaXplZC5mb3JEZXRlY3Rpb24sIGhpbnRzKTtcbiAgICAgIGNvbnN0IGZpbmRpbmdzID0gc29ydEZpbmRpbmdzKHJhd0ZpbmRpbmdzKTtcbiAgICAgIGNvbnN0IGFnZyA9IGFnZ3JlZ2F0ZShmaW5kaW5ncyk7XG5cbiAgICAgIGxldCBlbmZvcmNlbWVudExldmVsOiBCYW5lT3V0cHV0WydlbmZvcmNlbWVudExldmVsJ10gPVxuICAgICAgICBhZ2cudmVyZGljdCA9PT0gJ2RlbnknXG4gICAgICAgICAgPyAzXG4gICAgICAgICAgOiBhZ2cudmVyZGljdCA9PT0gJ3JldmlldydcbiAgICAgICAgICAgID8gMlxuICAgICAgICAgICAgOiBhZ2cudmVyZGljdCA9PT0gJ3Nhbml0aXplJ1xuICAgICAgICAgICAgICA/IDFcbiAgICAgICAgICAgICAgOiAwO1xuXG4gICAgICBjb25zdCBpZGVudGl0eUlkID0gaW5wdXQucmVxPy5hdXRoPy5pZGVudGl0eUlkO1xuICAgICAgaWYgKGFnZy52ZXJkaWN0ID09PSAnZGVueScgJiYgaWRlbnRpdHlJZCAmJiBoaW50cy5lc2NhbGF0aW9uRW5hYmxlZCkge1xuICAgICAgICBlbmZvcmNlbWVudExldmVsID0gZXNjYWxhdGUoaWRlbnRpdHlJZCwgYWdnLnNldmVyaXR5KTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3BhbnMgPSByZWRhY3Rpb25zRnJvbUZpbmRpbmdzKGlucHV0LnRleHQsIGZpbmRpbmdzKTtcbiAgICAgIGNvbnN0IHNhZmVUZXh0ID1cbiAgICAgICAgKGFnZy52ZXJkaWN0ID09PSAnc2FuaXRpemUnIHx8IGFnZy52ZXJkaWN0ID09PSAncmV2aWV3JykgJiYgc3BhbnMubGVuZ3RoXG4gICAgICAgICAgPyBhcHBseVJlZGFjdGlvbnMoaW5wdXQudGV4dCwgc3BhbnMpXG4gICAgICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IG91dDogQmFuZU91dHB1dCA9IHtcbiAgICAgICAgdmVyZGljdDogYWdnLnZlcmRpY3QsXG4gICAgICAgIHNldmVyaXR5OiBhZ2cuc2V2ZXJpdHksXG4gICAgICAgIGZpbmRpbmdzLFxuICAgICAgICByZWRhY3Rpb25zOiBzcGFucy5sZW5ndGggPyBzcGFucyA6IHVuZGVmaW5lZCxcbiAgICAgICAgc2FmZVRleHQsXG4gICAgICAgIHRyYWNlSWQsXG4gICAgICAgIHRpbWluZ01zOiBEYXRlLm5vdygpIC0gdDAsXG4gICAgICAgIGVuZm9yY2VtZW50TGV2ZWwsXG4gICAgICAgIHB1YmxpY01lc3NhZ2U6IHB1YmxpY01lc3NhZ2VGb3IoeyB2ZXJkaWN0OiBhZ2cudmVyZGljdCwgZW5mb3JjZW1lbnRMZXZlbCB9KSxcbiAgICAgIH07XG5cbiAgICAgIGlmIChvdXQudmVyZGljdCA9PT0gJ2RlbnknKSB7XG4gICAgICAgIG5vdGVIb3N0aWxlQXR0ZW1wdCh7IGlkZW50aXR5SWQsIGlwSGFzaDogaW5wdXQucmVxPy5hdXRoPy5pcEhhc2ggfSk7XG4gICAgICAgIG91dC50aHJvdHRsZSA9IGRlY2lkZVRocm90dGxlKHsgaWRlbnRpdHlJZCwgaXBIYXNoOiBpbnB1dC5yZXE/LmF1dGg/LmlwSGFzaCB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG91dC5lbmZvcmNlbWVudExldmVsID09PSA1ICYmIGhpbnRzLmluY2lkZW50T25Dcml0aWNhbCkge1xuICAgICAgICBjb25zdCBpbmNpZGVudCA9IHRvSW5jaWRlbnRSZWNvcmQob3V0LCB7XG4gICAgICAgICAgaWRlbnRpdHlJZCxcbiAgICAgICAgICBzZXNzaW9uSWQ6IGlucHV0LnJlcT8uYXV0aD8uc2Vzc2lvbklkLFxuICAgICAgICAgIGlwSGFzaDogaW5wdXQucmVxPy5hdXRoPy5pcEhhc2gsXG4gICAgICAgIH0pO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZvaWQgY29uZmlnLnN0b3JlPy5hcHBlbmRJbmNpZGVudD8uKGluY2lkZW50IGFzIGFueSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAvLyBzd2FsbG93XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgZmluYWwgPSBmaW5hbGl6ZVB1YmxpY0ZhY2luZyhvdXQpO1xuICAgICAgc2FmZVNpZGVFZmZlY3RzKGNvbmZpZywgaW5wdXQsIGZpbmFsKTtcbiAgICAgIHJldHVybiBmaW5hbDtcbiAgICB9LFxuICB9O1xufVxuIl0sIm5hbWVzIjpbImNyeXB0byIsInBvbGljeUZvclByb2ZpbGUiLCJiYXNlbGluZURldGVjdG9ycyIsInJ1bkRldGVjdG9ycyIsImFnZ3JlZ2F0ZSIsInNvcnRGaW5kaW5ncyIsImFwcGx5UmVkYWN0aW9ucyIsInJlZGFjdGlvbnNGcm9tRmluZGluZ3MiLCJiYW5lUHJlZmxpZ2h0IiwiZXNjYWxhdGUiLCJub3RlSG9zdGlsZUF0dGVtcHQiLCJkZWNpZGVUaHJvdHRsZSIsInRvSW5jaWRlbnRSZWNvcmQiLCJub3JtYWxpemVGb3JEZXRlY3Rpb24iLCJmaW5hbGl6ZVB1YmxpY0ZhY2luZyIsInNhZmVTaWRlRWZmZWN0cyIsInRyYWNlSWRGcm9tRW50cm9weSIsInJhbmRvbVVVSUQiLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwicHVibGljTWVzc2FnZUZvciIsInBhcmFtcyIsInZlcmRpY3QiLCJlbmZvcmNlbWVudExldmVsIiwidW5kZWZpbmVkIiwiY3JlYXRlTGl2ZUJhbmVFbmdpbmUiLCJjb25maWciLCJoaW50cyIsInByb2ZpbGVJZCIsImV2YWx1YXRlIiwiaW5wdXQiLCJ0MCIsIkRhdGUiLCJub3ciLCJ0cmFjZUlkIiwibm9ybWFsaXplZCIsInByZSIsImF1dGgiLCJyZXEiLCJpZGVudGl0eUlkIiwiaXBIYXNoIiwidGhyb3R0bGUiLCJmaW5kaW5ncyIsImZpbmFsIiwiZGV0ZWN0b3JzIiwicmF3RmluZGluZ3MiLCJmb3JEZXRlY3Rpb24iLCJhZ2ciLCJlc2NhbGF0aW9uRW5hYmxlZCIsInNldmVyaXR5Iiwic3BhbnMiLCJ0ZXh0Iiwic2FmZVRleHQiLCJsZW5ndGgiLCJvdXQiLCJyZWRhY3Rpb25zIiwidGltaW5nTXMiLCJwdWJsaWNNZXNzYWdlIiwiaW5jaWRlbnRPbkNyaXRpY2FsIiwiaW5jaWRlbnQiLCJzZXNzaW9uSWQiLCJzdG9yZSIsImFwcGVuZEluY2lkZW50IiwiY2F0Y2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/liveBaneEngine.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/normalize.ts":
/*!******************************************!*\
  !*** ../scing/bane/runtime/normalize.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   normalizeForDetection: () => (/* binding */ normalizeForDetection)\n/* harmony export */ });\nfunction normalizeForDetection(input) {\n    const text = input.text ?? '';\n    const normalized = text.replace(/\\s+/g, ' ').trim().toLowerCase();\n    return {\n        original: input,\n        forDetection: {\n            ...input,\n            // detectors use normalized text; redactions apply to original\n            text: normalized\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvbm9ybWFsaXplLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFPTyxTQUFTQSxzQkFBc0JDLEtBQWdCO0lBQ3BELE1BQU1DLE9BQU9ELE1BQU1DLElBQUksSUFBSTtJQUMzQixNQUFNQyxhQUFhRCxLQUFLRSxPQUFPLENBQUMsUUFBUSxLQUFLQyxJQUFJLEdBQUdDLFdBQVc7SUFFL0QsT0FBTztRQUNMQyxVQUFVTjtRQUNWTyxjQUFjO1lBQ1osR0FBR1AsS0FBSztZQUNSLDhEQUE4RDtZQUM5REMsTUFBTUM7UUFDUjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXG5vcm1hbGl6ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVJbnB1dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IHR5cGUgTm9ybWFsaXplZEJhbmVJbnB1dCA9IHtcbiAgb3JpZ2luYWw6IEJhbmVJbnB1dDtcbiAgZm9yRGV0ZWN0aW9uOiBCYW5lSW5wdXQ7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplRm9yRGV0ZWN0aW9uKGlucHV0OiBCYW5lSW5wdXQpOiBOb3JtYWxpemVkQmFuZUlucHV0IHtcbiAgY29uc3QgdGV4dCA9IGlucHV0LnRleHQgPz8gJyc7XG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSB0ZXh0LnJlcGxhY2UoL1xccysvZywgJyAnKS50cmltKCkudG9Mb3dlckNhc2UoKTtcblxuICByZXR1cm4ge1xuICAgIG9yaWdpbmFsOiBpbnB1dCxcbiAgICBmb3JEZXRlY3Rpb246IHtcbiAgICAgIC4uLmlucHV0LFxuICAgICAgLy8gZGV0ZWN0b3JzIHVzZSBub3JtYWxpemVkIHRleHQ7IHJlZGFjdGlvbnMgYXBwbHkgdG8gb3JpZ2luYWxcbiAgICAgIHRleHQ6IG5vcm1hbGl6ZWQsXG4gICAgfSxcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJub3JtYWxpemVGb3JEZXRlY3Rpb24iLCJpbnB1dCIsInRleHQiLCJub3JtYWxpemVkIiwicmVwbGFjZSIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsIm9yaWdpbmFsIiwiZm9yRGV0ZWN0aW9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/normalize.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/preflight.ts":
/*!******************************************!*\
  !*** ../scing/bane/runtime/preflight.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   banePreflight: () => (/* binding */ banePreflight)\n/* harmony export */ });\n/* harmony import */ var _policy_banePolicy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../policy/banePolicy */ \"(api-node)/../scing/bane/policy/banePolicy.ts\");\n/* harmony import */ var _riskLedger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./riskLedger */ \"(api-node)/../scing/bane/runtime/riskLedger.ts\");\n/* harmony import */ var _integrity__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./integrity */ \"(api-node)/../scing/bane/runtime/integrity.ts\");\n/* harmony import */ var _containment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./containment */ \"(api-node)/../scing/bane/runtime/containment.ts\");\n\n\n\n\nfunction deny(params) {\n    return {\n        verdict: 'deny',\n        severity: 'high',\n        findings: [\n            {\n                id: params.id,\n                title: params.title,\n                severity: 'high',\n                verdict: 'deny',\n                rationale: params.rationale,\n                tags: [\n                    'preflight'\n                ]\n            }\n        ],\n        traceId: params.traceId,\n        timingMs: params.timingMs,\n        enforcementLevel: params.enforcementLevel,\n        publicMessage: params.message\n    };\n}\nfunction banePreflight(config, input, traceId, t0) {\n    const hints = (0,_policy_banePolicy__WEBPACK_IMPORTED_MODULE_0__.policyForProfile)(config.profileId);\n    const lockdown = (0,_containment__WEBPACK_IMPORTED_MODULE_3__.isGlobalLockdown)();\n    if (lockdown.active) {\n        return {\n            verdict: 'deny',\n            severity: 'critical',\n            enforcementLevel: 5,\n            publicMessage: 'System temporarily unavailable due to a security event.',\n            findings: [\n                {\n                    id: 'GLOBAL_LOCKDOWN',\n                    title: 'Global containment active',\n                    severity: 'critical',\n                    verdict: 'deny',\n                    rationale: 'Emergency containment mode is active.',\n                    tags: [\n                        'containment',\n                        'global',\n                        'preflight'\n                    ]\n                }\n            ],\n            traceId,\n            timingMs: Date.now() - t0\n        };\n    }\n    const auth = input.req?.auth;\n    const requiredCapability = input.req?.requiredCapability;\n    if (!auth?.identityId) {\n        return deny({\n            traceId,\n            enforcementLevel: 2,\n            message: 'Request denied: unauthorized or unsafe operation. This attempt has been logged.',\n            id: 'NO_AUTH',\n            title: 'Authentication missing',\n            rationale: 'No authenticated identity was provided.',\n            timingMs: Date.now() - t0\n        });\n    }\n    const integrity = (0,_integrity__WEBPACK_IMPORTED_MODULE_2__.checkIntegrity)(input);\n    if (integrity.ok === false && integrity.code === 'REPLAY') {\n        return deny({\n            traceId,\n            enforcementLevel: 4,\n            message: 'Access revoked temporarily due to policy violations. Contact an authorized administrator.',\n            id: 'REPLAY_DETECTED',\n            title: 'Replay detected',\n            rationale: 'Request nonce has been seen recently.',\n            timingMs: Date.now() - t0\n        });\n    }\n    if ((0,_riskLedger__WEBPACK_IMPORTED_MODULE_1__.isLocked)(auth.identityId)) {\n        return {\n            verdict: 'deny',\n            severity: 'high',\n            findings: [\n                {\n                    id: 'IDENTITY_LOCKED',\n                    title: 'Identity temporarily locked',\n                    severity: 'high',\n                    verdict: 'deny',\n                    rationale: 'Prior violations triggered an automatic lockout.',\n                    tags: [\n                        'lockout',\n                        'preflight'\n                    ]\n                }\n            ],\n            traceId,\n            timingMs: Date.now() - t0,\n            enforcementLevel: 4,\n            publicMessage: 'Access revoked temporarily due to policy violations. Contact an authorized administrator.'\n        };\n    }\n    if (requiredCapability) {\n        const caps = Array.isArray(auth.capabilities) ? auth.capabilities : [];\n        if (!caps.includes(requiredCapability)) {\n            return deny({\n                traceId,\n                enforcementLevel: 3,\n                message: 'Request denied: unauthorized or unsafe operation. This attempt has been logged.',\n                id: 'MISSING_CAPABILITY',\n                title: 'Insufficient capability',\n                rationale: 'Authenticated identity lacks required capability.',\n                timingMs: Date.now() - t0\n            });\n        }\n    }\n    if (hints.strictMode) {\n        const si = auth.sessionIntegrity;\n        const ok = Boolean(si?.nonceOk) && Boolean(si?.signatureOk) && Boolean(si?.tokenFresh);\n        if (!ok) {\n            return deny({\n                traceId,\n                enforcementLevel: 3,\n                message: 'Request denied: unauthorized or unsafe operation. This attempt has been logged.',\n                id: 'SESSION_INTEGRITY_FAILED',\n                title: 'Session integrity validation failed',\n                rationale: 'Session integrity checks were missing or invalid.',\n                timingMs: Date.now() - t0\n            });\n        }\n    }\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvcHJlZmxpZ2h0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBRXdEO0FBQ2hCO0FBQ0s7QUFDSTtBQUVqRCxTQUFTSSxLQUFLQyxNQVFiO0lBQ0MsT0FBTztRQUNMQyxTQUFTO1FBQ1RDLFVBQVU7UUFDVkMsVUFBVTtZQUNSO2dCQUNFQyxJQUFJSixPQUFPSSxFQUFFO2dCQUNiQyxPQUFPTCxPQUFPSyxLQUFLO2dCQUNuQkgsVUFBVTtnQkFDVkQsU0FBUztnQkFDVEssV0FBV04sT0FBT00sU0FBUztnQkFDM0JDLE1BQU07b0JBQUM7aUJBQVk7WUFDckI7U0FDRDtRQUNEQyxTQUFTUixPQUFPUSxPQUFPO1FBQ3ZCQyxVQUFVVCxPQUFPUyxRQUFRO1FBQ3pCQyxrQkFBa0JWLE9BQU9VLGdCQUFnQjtRQUN6Q0MsZUFBZVgsT0FBT1ksT0FBTztJQUMvQjtBQUNGO0FBRU8sU0FBU0MsY0FDZEMsTUFBeUIsRUFDekJDLEtBQWdCLEVBQ2hCUCxPQUFlLEVBQ2ZRLEVBQVU7SUFFVixNQUFNQyxRQUFRdEIsb0VBQWdCQSxDQUFDbUIsT0FBT0ksU0FBUztJQUMvQyxNQUFNQyxXQUFXckIsOERBQWdCQTtJQUNqQyxJQUFJcUIsU0FBU0MsTUFBTSxFQUFFO1FBQ25CLE9BQU87WUFDTG5CLFNBQVM7WUFDVEMsVUFBVTtZQUNWUSxrQkFBa0I7WUFDbEJDLGVBQWU7WUFDZlIsVUFBVTtnQkFDUjtvQkFDRUMsSUFBSTtvQkFDSkMsT0FBTztvQkFDUEgsVUFBVTtvQkFDVkQsU0FBUztvQkFDVEssV0FBVztvQkFDWEMsTUFBTTt3QkFBQzt3QkFBZTt3QkFBVTtxQkFBWTtnQkFDOUM7YUFDRDtZQUNEQztZQUNBQyxVQUFVWSxLQUFLQyxHQUFHLEtBQUtOO1FBQ3pCO0lBQ0Y7SUFDQSxNQUFNTyxPQUFPUixNQUFNUyxHQUFHLEVBQUVEO0lBQ3hCLE1BQU1FLHFCQUFxQlYsTUFBTVMsR0FBRyxFQUFFQztJQUV0QyxJQUFJLENBQUNGLE1BQU1HLFlBQVk7UUFDckIsT0FBTzNCLEtBQUs7WUFDVlM7WUFDQUUsa0JBQWtCO1lBQ2xCRSxTQUFTO1lBQ1RSLElBQUk7WUFDSkMsT0FBTztZQUNQQyxXQUFXO1lBQ1hHLFVBQVVZLEtBQUtDLEdBQUcsS0FBS047UUFDekI7SUFDRjtJQUVBLE1BQU1XLFlBQVk5QiwwREFBY0EsQ0FBQ2tCO0lBQ2pDLElBQUlZLFVBQVVDLEVBQUUsS0FBSyxTQUFTRCxVQUFVRSxJQUFJLEtBQUssVUFBVTtRQUN6RCxPQUFPOUIsS0FBSztZQUNWUztZQUNBRSxrQkFBa0I7WUFDbEJFLFNBQ0U7WUFDRlIsSUFBSTtZQUNKQyxPQUFPO1lBQ1BDLFdBQVc7WUFDWEcsVUFBVVksS0FBS0MsR0FBRyxLQUFLTjtRQUN6QjtJQUNGO0lBRUEsSUFBSXBCLHFEQUFRQSxDQUFDMkIsS0FBS0csVUFBVSxHQUFHO1FBQzdCLE9BQU87WUFDTHpCLFNBQVM7WUFDVEMsVUFBVTtZQUNWQyxVQUFVO2dCQUNSO29CQUNFQyxJQUFJO29CQUNKQyxPQUFPO29CQUNQSCxVQUFVO29CQUNWRCxTQUFTO29CQUNUSyxXQUFXO29CQUNYQyxNQUFNO3dCQUFDO3dCQUFXO3FCQUFZO2dCQUNoQzthQUNEO1lBQ0RDO1lBQ0FDLFVBQVVZLEtBQUtDLEdBQUcsS0FBS047WUFDdkJOLGtCQUFrQjtZQUNsQkMsZUFDRTtRQUNKO0lBQ0Y7SUFFQSxJQUFJYyxvQkFBb0I7UUFDdEIsTUFBTUssT0FBaUJDLE1BQU1DLE9BQU8sQ0FBQ1QsS0FBS1UsWUFBWSxJQUFJVixLQUFLVSxZQUFZLEdBQUcsRUFBRTtRQUNoRixJQUFJLENBQUNILEtBQUtJLFFBQVEsQ0FBQ1QscUJBQXFCO1lBQ3RDLE9BQU8xQixLQUFLO2dCQUNWUztnQkFDQUUsa0JBQWtCO2dCQUNsQkUsU0FBUztnQkFDVFIsSUFBSTtnQkFDSkMsT0FBTztnQkFDUEMsV0FBVztnQkFDWEcsVUFBVVksS0FBS0MsR0FBRyxLQUFLTjtZQUN6QjtRQUNGO0lBQ0Y7SUFFQSxJQUFJQyxNQUFNa0IsVUFBVSxFQUFFO1FBQ3BCLE1BQU1DLEtBQUtiLEtBQUtjLGdCQUFnQjtRQUNoQyxNQUFNVCxLQUFLVSxRQUFRRixJQUFJRyxZQUFZRCxRQUFRRixJQUFJSSxnQkFBZ0JGLFFBQVFGLElBQUlLO1FBQzNFLElBQUksQ0FBQ2IsSUFBSTtZQUNQLE9BQU83QixLQUFLO2dCQUNWUztnQkFDQUUsa0JBQWtCO2dCQUNsQkUsU0FBUztnQkFDVFIsSUFBSTtnQkFDSkMsT0FBTztnQkFDUEMsV0FBVztnQkFDWEcsVUFBVVksS0FBS0MsR0FBRyxLQUFLTjtZQUN6QjtRQUNGO0lBQ0Y7SUFFQSxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXHByZWZsaWdodC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVJbnB1dCwgQmFuZU91dHB1dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgQmFuZVJ1bnRpbWVDb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgeyBwb2xpY3lGb3JQcm9maWxlIH0gZnJvbSAnLi4vcG9saWN5L2JhbmVQb2xpY3knO1xuaW1wb3J0IHsgaXNMb2NrZWQgfSBmcm9tICcuL3Jpc2tMZWRnZXInO1xuaW1wb3J0IHsgY2hlY2tJbnRlZ3JpdHkgfSBmcm9tICcuL2ludGVncml0eSc7XG5pbXBvcnQgeyBpc0dsb2JhbExvY2tkb3duIH0gZnJvbSAnLi9jb250YWlubWVudCc7XG5cbmZ1bmN0aW9uIGRlbnkocGFyYW1zOiB7XG4gIHRyYWNlSWQ6IHN0cmluZztcbiAgZW5mb3JjZW1lbnRMZXZlbDogMiB8IDMgfCA0IHwgNTtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICByYXRpb25hbGU6IHN0cmluZztcbiAgdGltaW5nTXM6IG51bWJlcjtcbn0pOiBCYW5lT3V0cHV0IHtcbiAgcmV0dXJuIHtcbiAgICB2ZXJkaWN0OiAnZGVueScsXG4gICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICBmaW5kaW5nczogW1xuICAgICAge1xuICAgICAgICBpZDogcGFyYW1zLmlkLFxuICAgICAgICB0aXRsZTogcGFyYW1zLnRpdGxlLFxuICAgICAgICBzZXZlcml0eTogJ2hpZ2gnLFxuICAgICAgICB2ZXJkaWN0OiAnZGVueScsXG4gICAgICAgIHJhdGlvbmFsZTogcGFyYW1zLnJhdGlvbmFsZSxcbiAgICAgICAgdGFnczogWydwcmVmbGlnaHQnXSxcbiAgICAgIH0sXG4gICAgXSxcbiAgICB0cmFjZUlkOiBwYXJhbXMudHJhY2VJZCxcbiAgICB0aW1pbmdNczogcGFyYW1zLnRpbWluZ01zLFxuICAgIGVuZm9yY2VtZW50TGV2ZWw6IHBhcmFtcy5lbmZvcmNlbWVudExldmVsLFxuICAgIHB1YmxpY01lc3NhZ2U6IHBhcmFtcy5tZXNzYWdlLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmFuZVByZWZsaWdodChcbiAgY29uZmlnOiBCYW5lUnVudGltZUNvbmZpZyxcbiAgaW5wdXQ6IEJhbmVJbnB1dCxcbiAgdHJhY2VJZDogc3RyaW5nLFxuICB0MDogbnVtYmVyXG4pOiBCYW5lT3V0cHV0IHwgbnVsbCB7XG4gIGNvbnN0IGhpbnRzID0gcG9saWN5Rm9yUHJvZmlsZShjb25maWcucHJvZmlsZUlkKTtcbiAgY29uc3QgbG9ja2Rvd24gPSBpc0dsb2JhbExvY2tkb3duKCk7XG4gIGlmIChsb2NrZG93bi5hY3RpdmUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmVyZGljdDogJ2RlbnknLFxuICAgICAgc2V2ZXJpdHk6ICdjcml0aWNhbCcsXG4gICAgICBlbmZvcmNlbWVudExldmVsOiA1LFxuICAgICAgcHVibGljTWVzc2FnZTogJ1N5c3RlbSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZSBkdWUgdG8gYSBzZWN1cml0eSBldmVudC4nLFxuICAgICAgZmluZGluZ3M6IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnR0xPQkFMX0xPQ0tET1dOJyxcbiAgICAgICAgICB0aXRsZTogJ0dsb2JhbCBjb250YWlubWVudCBhY3RpdmUnLFxuICAgICAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnLFxuICAgICAgICAgIHZlcmRpY3Q6ICdkZW55JyxcbiAgICAgICAgICByYXRpb25hbGU6ICdFbWVyZ2VuY3kgY29udGFpbm1lbnQgbW9kZSBpcyBhY3RpdmUuJyxcbiAgICAgICAgICB0YWdzOiBbJ2NvbnRhaW5tZW50JywgJ2dsb2JhbCcsICdwcmVmbGlnaHQnXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICB0cmFjZUlkLFxuICAgICAgdGltaW5nTXM6IERhdGUubm93KCkgLSB0MCxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGF1dGggPSBpbnB1dC5yZXE/LmF1dGg7XG4gIGNvbnN0IHJlcXVpcmVkQ2FwYWJpbGl0eSA9IGlucHV0LnJlcT8ucmVxdWlyZWRDYXBhYmlsaXR5O1xuXG4gIGlmICghYXV0aD8uaWRlbnRpdHlJZCkge1xuICAgIHJldHVybiBkZW55KHtcbiAgICAgIHRyYWNlSWQsXG4gICAgICBlbmZvcmNlbWVudExldmVsOiAyLFxuICAgICAgbWVzc2FnZTogJ1JlcXVlc3QgZGVuaWVkOiB1bmF1dGhvcml6ZWQgb3IgdW5zYWZlIG9wZXJhdGlvbi4gVGhpcyBhdHRlbXB0IGhhcyBiZWVuIGxvZ2dlZC4nLFxuICAgICAgaWQ6ICdOT19BVVRIJyxcbiAgICAgIHRpdGxlOiAnQXV0aGVudGljYXRpb24gbWlzc2luZycsXG4gICAgICByYXRpb25hbGU6ICdObyBhdXRoZW50aWNhdGVkIGlkZW50aXR5IHdhcyBwcm92aWRlZC4nLFxuICAgICAgdGltaW5nTXM6IERhdGUubm93KCkgLSB0MCxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGludGVncml0eSA9IGNoZWNrSW50ZWdyaXR5KGlucHV0KTtcbiAgaWYgKGludGVncml0eS5vayA9PT0gZmFsc2UgJiYgaW50ZWdyaXR5LmNvZGUgPT09ICdSRVBMQVknKSB7XG4gICAgcmV0dXJuIGRlbnkoe1xuICAgICAgdHJhY2VJZCxcbiAgICAgIGVuZm9yY2VtZW50TGV2ZWw6IDQsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICAnQWNjZXNzIHJldm9rZWQgdGVtcG9yYXJpbHkgZHVlIHRvIHBvbGljeSB2aW9sYXRpb25zLiBDb250YWN0IGFuIGF1dGhvcml6ZWQgYWRtaW5pc3RyYXRvci4nLFxuICAgICAgaWQ6ICdSRVBMQVlfREVURUNURUQnLFxuICAgICAgdGl0bGU6ICdSZXBsYXkgZGV0ZWN0ZWQnLFxuICAgICAgcmF0aW9uYWxlOiAnUmVxdWVzdCBub25jZSBoYXMgYmVlbiBzZWVuIHJlY2VudGx5LicsXG4gICAgICB0aW1pbmdNczogRGF0ZS5ub3coKSAtIHQwLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKGlzTG9ja2VkKGF1dGguaWRlbnRpdHlJZCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmVyZGljdDogJ2RlbnknLFxuICAgICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICAgIGZpbmRpbmdzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ0lERU5USVRZX0xPQ0tFRCcsXG4gICAgICAgICAgdGl0bGU6ICdJZGVudGl0eSB0ZW1wb3JhcmlseSBsb2NrZWQnLFxuICAgICAgICAgIHNldmVyaXR5OiAnaGlnaCcsXG4gICAgICAgICAgdmVyZGljdDogJ2RlbnknLFxuICAgICAgICAgIHJhdGlvbmFsZTogJ1ByaW9yIHZpb2xhdGlvbnMgdHJpZ2dlcmVkIGFuIGF1dG9tYXRpYyBsb2Nrb3V0LicsXG4gICAgICAgICAgdGFnczogWydsb2Nrb3V0JywgJ3ByZWZsaWdodCddLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHRyYWNlSWQsXG4gICAgICB0aW1pbmdNczogRGF0ZS5ub3coKSAtIHQwLFxuICAgICAgZW5mb3JjZW1lbnRMZXZlbDogNCxcbiAgICAgIHB1YmxpY01lc3NhZ2U6XG4gICAgICAgICdBY2Nlc3MgcmV2b2tlZCB0ZW1wb3JhcmlseSBkdWUgdG8gcG9saWN5IHZpb2xhdGlvbnMuIENvbnRhY3QgYW4gYXV0aG9yaXplZCBhZG1pbmlzdHJhdG9yLicsXG4gICAgfTtcbiAgfVxuXG4gIGlmIChyZXF1aXJlZENhcGFiaWxpdHkpIHtcbiAgICBjb25zdCBjYXBzOiBzdHJpbmdbXSA9IEFycmF5LmlzQXJyYXkoYXV0aC5jYXBhYmlsaXRpZXMpID8gYXV0aC5jYXBhYmlsaXRpZXMgOiBbXTtcbiAgICBpZiAoIWNhcHMuaW5jbHVkZXMocmVxdWlyZWRDYXBhYmlsaXR5KSkge1xuICAgICAgcmV0dXJuIGRlbnkoe1xuICAgICAgICB0cmFjZUlkLFxuICAgICAgICBlbmZvcmNlbWVudExldmVsOiAzLFxuICAgICAgICBtZXNzYWdlOiAnUmVxdWVzdCBkZW5pZWQ6IHVuYXV0aG9yaXplZCBvciB1bnNhZmUgb3BlcmF0aW9uLiBUaGlzIGF0dGVtcHQgaGFzIGJlZW4gbG9nZ2VkLicsXG4gICAgICAgIGlkOiAnTUlTU0lOR19DQVBBQklMSVRZJyxcbiAgICAgICAgdGl0bGU6ICdJbnN1ZmZpY2llbnQgY2FwYWJpbGl0eScsXG4gICAgICAgIHJhdGlvbmFsZTogJ0F1dGhlbnRpY2F0ZWQgaWRlbnRpdHkgbGFja3MgcmVxdWlyZWQgY2FwYWJpbGl0eS4nLFxuICAgICAgICB0aW1pbmdNczogRGF0ZS5ub3coKSAtIHQwLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGhpbnRzLnN0cmljdE1vZGUpIHtcbiAgICBjb25zdCBzaSA9IGF1dGguc2Vzc2lvbkludGVncml0eTtcbiAgICBjb25zdCBvayA9IEJvb2xlYW4oc2k/Lm5vbmNlT2spICYmIEJvb2xlYW4oc2k/LnNpZ25hdHVyZU9rKSAmJiBCb29sZWFuKHNpPy50b2tlbkZyZXNoKTtcbiAgICBpZiAoIW9rKSB7XG4gICAgICByZXR1cm4gZGVueSh7XG4gICAgICAgIHRyYWNlSWQsXG4gICAgICAgIGVuZm9yY2VtZW50TGV2ZWw6IDMsXG4gICAgICAgIG1lc3NhZ2U6ICdSZXF1ZXN0IGRlbmllZDogdW5hdXRob3JpemVkIG9yIHVuc2FmZSBvcGVyYXRpb24uIFRoaXMgYXR0ZW1wdCBoYXMgYmVlbiBsb2dnZWQuJyxcbiAgICAgICAgaWQ6ICdTRVNTSU9OX0lOVEVHUklUWV9GQUlMRUQnLFxuICAgICAgICB0aXRsZTogJ1Nlc3Npb24gaW50ZWdyaXR5IHZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgcmF0aW9uYWxlOiAnU2Vzc2lvbiBpbnRlZ3JpdHkgY2hlY2tzIHdlcmUgbWlzc2luZyBvciBpbnZhbGlkLicsXG4gICAgICAgIHRpbWluZ01zOiBEYXRlLm5vdygpIC0gdDAsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbiJdLCJuYW1lcyI6WyJwb2xpY3lGb3JQcm9maWxlIiwiaXNMb2NrZWQiLCJjaGVja0ludGVncml0eSIsImlzR2xvYmFsTG9ja2Rvd24iLCJkZW55IiwicGFyYW1zIiwidmVyZGljdCIsInNldmVyaXR5IiwiZmluZGluZ3MiLCJpZCIsInRpdGxlIiwicmF0aW9uYWxlIiwidGFncyIsInRyYWNlSWQiLCJ0aW1pbmdNcyIsImVuZm9yY2VtZW50TGV2ZWwiLCJwdWJsaWNNZXNzYWdlIiwibWVzc2FnZSIsImJhbmVQcmVmbGlnaHQiLCJjb25maWciLCJpbnB1dCIsInQwIiwiaGludHMiLCJwcm9maWxlSWQiLCJsb2NrZG93biIsImFjdGl2ZSIsIkRhdGUiLCJub3ciLCJhdXRoIiwicmVxIiwicmVxdWlyZWRDYXBhYmlsaXR5IiwiaWRlbnRpdHlJZCIsImludGVncml0eSIsIm9rIiwiY29kZSIsImNhcHMiLCJBcnJheSIsImlzQXJyYXkiLCJjYXBhYmlsaXRpZXMiLCJpbmNsdWRlcyIsInN0cmljdE1vZGUiLCJzaSIsInNlc3Npb25JbnRlZ3JpdHkiLCJCb29sZWFuIiwibm9uY2VPayIsInNpZ25hdHVyZU9rIiwidG9rZW5GcmVzaCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/preflight.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/publicResponse.ts":
/*!***********************************************!*\
  !*** ../scing/bane/runtime/publicResponse.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   finalizePublicFacing: () => (/* binding */ finalizePublicFacing),\n/* harmony export */   sanitizePublicMessage: () => (/* binding */ sanitizePublicMessage)\n/* harmony export */ });\nconst FORBIDDEN_FRAGMENTS = [\n    'system prompt',\n    'developer message',\n    'detector',\n    'regex',\n    'pattern',\n    'rule',\n    'threshold',\n    'internal',\n    'policy id'\n];\nfunction sanitizePublicMessage(msg) {\n    const lower = msg.toLowerCase();\n    for (const f of FORBIDDEN_FRAGMENTS){\n        if (lower.includes(f)) {\n            return 'Request denied by security policy. This attempt has been logged.';\n        }\n    }\n    return msg;\n}\nfunction finalizePublicFacing(out) {\n    if (out.publicMessage) out.publicMessage = sanitizePublicMessage(out.publicMessage);\n    return out;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvcHVibGljUmVzcG9uc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQSxNQUFNQSxzQkFBc0I7SUFDMUI7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0Q7QUFFTSxTQUFTQyxzQkFBc0JDLEdBQVc7SUFDL0MsTUFBTUMsUUFBUUQsSUFBSUUsV0FBVztJQUM3QixLQUFLLE1BQU1DLEtBQUtMLG9CQUFxQjtRQUNuQyxJQUFJRyxNQUFNRyxRQUFRLENBQUNELElBQUk7WUFDckIsT0FBTztRQUNUO0lBQ0Y7SUFDQSxPQUFPSDtBQUNUO0FBRU8sU0FBU0sscUJBQXFCQyxHQUFlO0lBQ2xELElBQUlBLElBQUlDLGFBQWEsRUFBRUQsSUFBSUMsYUFBYSxHQUFHUixzQkFBc0JPLElBQUlDLGFBQWE7SUFDbEYsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxccnVudGltZVxccHVibGljUmVzcG9uc2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBCYW5lT3V0cHV0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5jb25zdCBGT1JCSURERU5fRlJBR01FTlRTID0gW1xuICAnc3lzdGVtIHByb21wdCcsXG4gICdkZXZlbG9wZXIgbWVzc2FnZScsXG4gICdkZXRlY3RvcicsXG4gICdyZWdleCcsXG4gICdwYXR0ZXJuJyxcbiAgJ3J1bGUnLFxuICAndGhyZXNob2xkJyxcbiAgJ2ludGVybmFsJyxcbiAgJ3BvbGljeSBpZCcsXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVQdWJsaWNNZXNzYWdlKG1zZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgbG93ZXIgPSBtc2cudG9Mb3dlckNhc2UoKTtcbiAgZm9yIChjb25zdCBmIG9mIEZPUkJJRERFTl9GUkFHTUVOVFMpIHtcbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoZikpIHtcbiAgICAgIHJldHVybiAnUmVxdWVzdCBkZW5pZWQgYnkgc2VjdXJpdHkgcG9saWN5LiBUaGlzIGF0dGVtcHQgaGFzIGJlZW4gbG9nZ2VkLic7XG4gICAgfVxuICB9XG4gIHJldHVybiBtc2c7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5hbGl6ZVB1YmxpY0ZhY2luZyhvdXQ6IEJhbmVPdXRwdXQpOiBCYW5lT3V0cHV0IHtcbiAgaWYgKG91dC5wdWJsaWNNZXNzYWdlKSBvdXQucHVibGljTWVzc2FnZSA9IHNhbml0aXplUHVibGljTWVzc2FnZShvdXQucHVibGljTWVzc2FnZSk7XG4gIHJldHVybiBvdXQ7XG59XG4iXSwibmFtZXMiOlsiRk9SQklEREVOX0ZSQUdNRU5UUyIsInNhbml0aXplUHVibGljTWVzc2FnZSIsIm1zZyIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJmIiwiaW5jbHVkZXMiLCJmaW5hbGl6ZVB1YmxpY0ZhY2luZyIsIm91dCIsInB1YmxpY01lc3NhZ2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/publicResponse.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/riskLedger.ts":
/*!*******************************************!*\
  !*** ../scing/bane/runtime/riskLedger.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isLocked: () => (/* binding */ isLocked),\n/* harmony export */   lockIdentity: () => (/* binding */ lockIdentity),\n/* harmony export */   recordStrike: () => (/* binding */ recordStrike),\n/* harmony export */   unlockIdentity: () => (/* binding */ unlockIdentity)\n/* harmony export */ });\nconst ledger = new Map();\nfunction recordStrike(identityId, severity, now = Date.now()) {\n    const prev = ledger.get(identityId);\n    const strikes = (prev?.strikes ?? 0) + 1;\n    const rec = {\n        identityId,\n        strikes,\n        lastSeverity: severity,\n        lastSeen: now,\n        lockedUntil: prev?.lockedUntil\n    };\n    ledger.set(identityId, rec);\n    return rec;\n}\nfunction isLocked(identityId, now = Date.now()) {\n    const rec = ledger.get(identityId);\n    if (!rec?.lockedUntil) return false;\n    return now < rec.lockedUntil;\n}\nfunction lockIdentity(identityId, ttlMs, now = Date.now()) {\n    const rec = ledger.get(identityId) ?? {\n        identityId,\n        strikes: 0,\n        lastSeverity: 'high',\n        lastSeen: now\n    };\n    rec.lockedUntil = now + Math.max(0, ttlMs);\n    ledger.set(identityId, rec);\n}\nfunction unlockIdentity(identityId) {\n    const rec = ledger.get(identityId);\n    if (!rec) return;\n    delete rec.lockedUntil;\n    ledger.set(identityId, rec);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvcmlza0xlZGdlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBVUEsTUFBTUEsU0FBUyxJQUFJQztBQUVaLFNBQVNDLGFBQ2RDLFVBQWtCLEVBQ2xCQyxRQUFzQixFQUN0QkMsTUFBTUMsS0FBS0QsR0FBRyxFQUFFO0lBRWhCLE1BQU1FLE9BQU9QLE9BQU9RLEdBQUcsQ0FBQ0w7SUFDeEIsTUFBTU0sVUFBVSxDQUFDRixNQUFNRSxXQUFXLEtBQUs7SUFFdkMsTUFBTUMsTUFBa0I7UUFDdEJQO1FBQ0FNO1FBQ0FFLGNBQWNQO1FBQ2RRLFVBQVVQO1FBQ1ZRLGFBQWFOLE1BQU1NO0lBQ3JCO0lBRUFiLE9BQU9jLEdBQUcsQ0FBQ1gsWUFBWU87SUFDdkIsT0FBT0E7QUFDVDtBQUVPLFNBQVNLLFNBQVNaLFVBQWtCLEVBQUVFLE1BQU1DLEtBQUtELEdBQUcsRUFBRTtJQUMzRCxNQUFNSyxNQUFNVixPQUFPUSxHQUFHLENBQUNMO0lBQ3ZCLElBQUksQ0FBQ08sS0FBS0csYUFBYSxPQUFPO0lBQzlCLE9BQU9SLE1BQU1LLElBQUlHLFdBQVc7QUFDOUI7QUFFTyxTQUFTRyxhQUFhYixVQUFrQixFQUFFYyxLQUFhLEVBQUVaLE1BQU1DLEtBQUtELEdBQUcsRUFBRTtJQUM5RSxNQUFNSyxNQUFNVixPQUFPUSxHQUFHLENBQUNMLGVBQWU7UUFDcENBO1FBQ0FNLFNBQVM7UUFDVEUsY0FBYztRQUNkQyxVQUFVUDtJQUNaO0lBQ0FLLElBQUlHLFdBQVcsR0FBR1IsTUFBTWEsS0FBS0MsR0FBRyxDQUFDLEdBQUdGO0lBQ3BDakIsT0FBT2MsR0FBRyxDQUFDWCxZQUFZTztBQUN6QjtBQUVPLFNBQVNVLGVBQWVqQixVQUFrQjtJQUMvQyxNQUFNTyxNQUFNVixPQUFPUSxHQUFHLENBQUNMO0lBQ3ZCLElBQUksQ0FBQ08sS0FBSztJQUNWLE9BQU9BLElBQUlHLFdBQVc7SUFDdEJiLE9BQU9jLEdBQUcsQ0FBQ1gsWUFBWU87QUFDekIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHJ1bnRpbWVcXHJpc2tMZWRnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBCYW5lU2V2ZXJpdHkgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCB0eXBlIFJpc2tSZWNvcmQgPSB7XG4gIGlkZW50aXR5SWQ6IHN0cmluZztcbiAgc3RyaWtlczogbnVtYmVyO1xuICBsYXN0U2V2ZXJpdHk6IEJhbmVTZXZlcml0eTtcbiAgbGFzdFNlZW46IG51bWJlcjtcbiAgbG9ja2VkVW50aWw/OiBudW1iZXI7XG59O1xuXG5jb25zdCBsZWRnZXIgPSBuZXcgTWFwPHN0cmluZywgUmlza1JlY29yZD4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlY29yZFN0cmlrZShcbiAgaWRlbnRpdHlJZDogc3RyaW5nLFxuICBzZXZlcml0eTogQmFuZVNldmVyaXR5LFxuICBub3cgPSBEYXRlLm5vdygpXG4pOiBSaXNrUmVjb3JkIHtcbiAgY29uc3QgcHJldiA9IGxlZGdlci5nZXQoaWRlbnRpdHlJZCk7XG4gIGNvbnN0IHN0cmlrZXMgPSAocHJldj8uc3RyaWtlcyA/PyAwKSArIDE7XG5cbiAgY29uc3QgcmVjOiBSaXNrUmVjb3JkID0ge1xuICAgIGlkZW50aXR5SWQsXG4gICAgc3RyaWtlcyxcbiAgICBsYXN0U2V2ZXJpdHk6IHNldmVyaXR5LFxuICAgIGxhc3RTZWVuOiBub3csXG4gICAgbG9ja2VkVW50aWw6IHByZXY/LmxvY2tlZFVudGlsLFxuICB9O1xuXG4gIGxlZGdlci5zZXQoaWRlbnRpdHlJZCwgcmVjKTtcbiAgcmV0dXJuIHJlYztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTG9ja2VkKGlkZW50aXR5SWQ6IHN0cmluZywgbm93ID0gRGF0ZS5ub3coKSk6IGJvb2xlYW4ge1xuICBjb25zdCByZWMgPSBsZWRnZXIuZ2V0KGlkZW50aXR5SWQpO1xuICBpZiAoIXJlYz8ubG9ja2VkVW50aWwpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIG5vdyA8IHJlYy5sb2NrZWRVbnRpbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvY2tJZGVudGl0eShpZGVudGl0eUlkOiBzdHJpbmcsIHR0bE1zOiBudW1iZXIsIG5vdyA9IERhdGUubm93KCkpIHtcbiAgY29uc3QgcmVjID0gbGVkZ2VyLmdldChpZGVudGl0eUlkKSA/PyB7XG4gICAgaWRlbnRpdHlJZCxcbiAgICBzdHJpa2VzOiAwLFxuICAgIGxhc3RTZXZlcml0eTogJ2hpZ2gnIGFzIEJhbmVTZXZlcml0eSxcbiAgICBsYXN0U2Vlbjogbm93LFxuICB9O1xuICByZWMubG9ja2VkVW50aWwgPSBub3cgKyBNYXRoLm1heCgwLCB0dGxNcyk7XG4gIGxlZGdlci5zZXQoaWRlbnRpdHlJZCwgcmVjKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVubG9ja0lkZW50aXR5KGlkZW50aXR5SWQ6IHN0cmluZykge1xuICBjb25zdCByZWMgPSBsZWRnZXIuZ2V0KGlkZW50aXR5SWQpO1xuICBpZiAoIXJlYykgcmV0dXJuO1xuICBkZWxldGUgcmVjLmxvY2tlZFVudGlsO1xuICBsZWRnZXIuc2V0KGlkZW50aXR5SWQsIHJlYyk7XG59XG4iXSwibmFtZXMiOlsibGVkZ2VyIiwiTWFwIiwicmVjb3JkU3RyaWtlIiwiaWRlbnRpdHlJZCIsInNldmVyaXR5Iiwibm93IiwiRGF0ZSIsInByZXYiLCJnZXQiLCJzdHJpa2VzIiwicmVjIiwibGFzdFNldmVyaXR5IiwibGFzdFNlZW4iLCJsb2NrZWRVbnRpbCIsInNldCIsImlzTG9ja2VkIiwibG9ja0lkZW50aXR5IiwidHRsTXMiLCJNYXRoIiwibWF4IiwidW5sb2NrSWRlbnRpdHkiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/riskLedger.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/safeSideEffects.ts":
/*!************************************************!*\
  !*** ../scing/bane/runtime/safeSideEffects.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   safeSideEffects: () => (/* binding */ safeSideEffects)\n/* harmony export */ });\n/* harmony import */ var _storage_toAuditRecord__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../storage/toAuditRecord */ \"(api-node)/../scing/bane/storage/toAuditRecord.ts\");\n\nfunction safeSideEffects(config, input, out) {\n    // Store: never block, never throw\n    try {\n        const store = config.store;\n        if (store) {\n            const rec = (0,_storage_toAuditRecord__WEBPACK_IMPORTED_MODULE_0__.toAuditRecord)(input, out);\n            void store.appendAudit(rec).catch(()=>{});\n            void store.appendEvent({\n                type: 'BANE_DECISION',\n                traceId: out.traceId,\n                at: Date.now(),\n                data: {\n                    verdict: out.verdict,\n                    severity: out.severity,\n                    enforcementLevel: out.enforcementLevel\n                }\n            }).catch(()=>{});\n        }\n    } catch  {\n    // swallow\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvc2FmZVNpZGVFZmZlY3RzLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRXlEO0FBRWxELFNBQVNDLGdCQUFnQkMsTUFBeUIsRUFBRUMsS0FBZ0IsRUFBRUMsR0FBZTtJQUMxRixrQ0FBa0M7SUFDbEMsSUFBSTtRQUNGLE1BQU1DLFFBQVFILE9BQU9HLEtBQUs7UUFDMUIsSUFBSUEsT0FBTztZQUNULE1BQU1DLE1BQU1OLHFFQUFhQSxDQUFDRyxPQUFPQztZQUNqQyxLQUFLQyxNQUFNRSxXQUFXLENBQUNELEtBQUtFLEtBQUssQ0FBQyxLQUFPO1lBQ3pDLEtBQUtILE1BQ0ZJLFdBQVcsQ0FBQztnQkFDWEMsTUFBTTtnQkFDTkMsU0FBU1AsSUFBSU8sT0FBTztnQkFDcEJDLElBQUlDLEtBQUtDLEdBQUc7Z0JBQ1pDLE1BQU07b0JBQ0pDLFNBQVNaLElBQUlZLE9BQU87b0JBQ3BCQyxVQUFVYixJQUFJYSxRQUFRO29CQUN0QkMsa0JBQWtCZCxJQUFJYyxnQkFBZ0I7Z0JBQ3hDO1lBQ0YsR0FDQ1YsS0FBSyxDQUFDLEtBQU87UUFDbEI7SUFDRixFQUFFLE9BQU07SUFDTixVQUFVO0lBQ1o7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxccnVudGltZVxcc2FmZVNpZGVFZmZlY3RzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZUlucHV0LCBCYW5lT3V0cHV0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBCYW5lUnVudGltZUNvbmZpZyB9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7IHRvQXVkaXRSZWNvcmQgfSBmcm9tICcuLi9zdG9yYWdlL3RvQXVkaXRSZWNvcmQnO1xuXG5leHBvcnQgZnVuY3Rpb24gc2FmZVNpZGVFZmZlY3RzKGNvbmZpZzogQmFuZVJ1bnRpbWVDb25maWcsIGlucHV0OiBCYW5lSW5wdXQsIG91dDogQmFuZU91dHB1dCkge1xuICAvLyBTdG9yZTogbmV2ZXIgYmxvY2ssIG5ldmVyIHRocm93XG4gIHRyeSB7XG4gICAgY29uc3Qgc3RvcmUgPSBjb25maWcuc3RvcmU7XG4gICAgaWYgKHN0b3JlKSB7XG4gICAgICBjb25zdCByZWMgPSB0b0F1ZGl0UmVjb3JkKGlucHV0LCBvdXQpO1xuICAgICAgdm9pZCBzdG9yZS5hcHBlbmRBdWRpdChyZWMpLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgIHZvaWQgc3RvcmVcbiAgICAgICAgLmFwcGVuZEV2ZW50KHtcbiAgICAgICAgICB0eXBlOiAnQkFORV9ERUNJU0lPTicsXG4gICAgICAgICAgdHJhY2VJZDogb3V0LnRyYWNlSWQsXG4gICAgICAgICAgYXQ6IERhdGUubm93KCksXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdmVyZGljdDogb3V0LnZlcmRpY3QsXG4gICAgICAgICAgICBzZXZlcml0eTogb3V0LnNldmVyaXR5LFxuICAgICAgICAgICAgZW5mb3JjZW1lbnRMZXZlbDogb3V0LmVuZm9yY2VtZW50TGV2ZWwsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG4gIH0gY2F0Y2gge1xuICAgIC8vIHN3YWxsb3dcbiAgfVxufVxuIl0sIm5hbWVzIjpbInRvQXVkaXRSZWNvcmQiLCJzYWZlU2lkZUVmZmVjdHMiLCJjb25maWciLCJpbnB1dCIsIm91dCIsInN0b3JlIiwicmVjIiwiYXBwZW5kQXVkaXQiLCJjYXRjaCIsImFwcGVuZEV2ZW50IiwidHlwZSIsInRyYWNlSWQiLCJhdCIsIkRhdGUiLCJub3ciLCJkYXRhIiwidmVyZGljdCIsInNldmVyaXR5IiwiZW5mb3JjZW1lbnRMZXZlbCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/safeSideEffects.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/runtime/throttle.ts":
/*!*****************************************!*\
  !*** ../scing/bane/runtime/throttle.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decideThrottle: () => (/* binding */ decideThrottle),\n/* harmony export */   noteHostileAttempt: () => (/* binding */ noteHostileAttempt)\n/* harmony export */ });\nconst state = new Map();\nfunction key(identityId, ipHash) {\n    return identityId ? `id:${identityId}` : ipHash ? `ip:${ipHash}` : 'anon';\n}\nfunction noteHostileAttempt(params) {\n    const now = params.now ?? Date.now();\n    const k = key(params.identityId, params.ipHash);\n    const prev = state.get(k);\n    const strikes = (prev?.strikes ?? 0) + 1;\n    const next = {\n        strikes,\n        lastAt: now\n    };\n    state.set(k, next);\n    return next;\n}\nfunction decideThrottle(params) {\n    const now = params.now ?? Date.now();\n    const k = key(params.identityId, params.ipHash);\n    const s = state.get(k);\n    if (!s) return {\n        action: 'none'\n    };\n    const delayMs = Math.min(250 * Math.pow(2, Math.max(0, s.strikes - 1)), 8000);\n    const delta = now - s.lastAt;\n    if (delta < 250 && s.strikes >= 3) {\n        return {\n            action: 'block',\n            retryAfterMs: 15000\n        };\n    }\n    return delayMs >= 500 ? {\n        action: 'delay',\n        delayMs\n    } : {\n        action: 'none'\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3J1bnRpbWUvdGhyb3R0bGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFVQSxNQUFNQSxRQUFRLElBQUlDO0FBRWxCLFNBQVNDLElBQUlDLFVBQW1CLEVBQUVDLE1BQWU7SUFDL0MsT0FBT0QsYUFBYSxDQUFDLEdBQUcsRUFBRUEsWUFBWSxHQUFHQyxTQUFTLENBQUMsR0FBRyxFQUFFQSxRQUFRLEdBQUc7QUFDckU7QUFFTyxTQUFTQyxtQkFBbUJDLE1BSWxDO0lBQ0MsTUFBTUMsTUFBTUQsT0FBT0MsR0FBRyxJQUFJQyxLQUFLRCxHQUFHO0lBQ2xDLE1BQU1FLElBQUlQLElBQUlJLE9BQU9ILFVBQVUsRUFBRUcsT0FBT0YsTUFBTTtJQUM5QyxNQUFNTSxPQUFPVixNQUFNVyxHQUFHLENBQUNGO0lBRXZCLE1BQU1HLFVBQVUsQ0FBQ0YsTUFBTUUsV0FBVyxLQUFLO0lBQ3ZDLE1BQU1DLE9BQXNCO1FBQUVEO1FBQVNFLFFBQVFQO0lBQUk7SUFDbkRQLE1BQU1lLEdBQUcsQ0FBQ04sR0FBR0k7SUFDYixPQUFPQTtBQUNUO0FBRU8sU0FBU0csZUFBZVYsTUFJOUI7SUFDQyxNQUFNQyxNQUFNRCxPQUFPQyxHQUFHLElBQUlDLEtBQUtELEdBQUc7SUFDbEMsTUFBTUUsSUFBSVAsSUFBSUksT0FBT0gsVUFBVSxFQUFFRyxPQUFPRixNQUFNO0lBQzlDLE1BQU1hLElBQUlqQixNQUFNVyxHQUFHLENBQUNGO0lBQ3BCLElBQUksQ0FBQ1EsR0FBRyxPQUFPO1FBQUVDLFFBQVE7SUFBTztJQUVoQyxNQUFNQyxVQUFVQyxLQUFLQyxHQUFHLENBQUMsTUFBTUQsS0FBS0UsR0FBRyxDQUFDLEdBQUdGLEtBQUtHLEdBQUcsQ0FBQyxHQUFHTixFQUFFTCxPQUFPLEdBQUcsS0FBSztJQUV4RSxNQUFNWSxRQUFRakIsTUFBTVUsRUFBRUgsTUFBTTtJQUM1QixJQUFJVSxRQUFRLE9BQU9QLEVBQUVMLE9BQU8sSUFBSSxHQUFHO1FBQ2pDLE9BQU87WUFBRU0sUUFBUTtZQUFTTyxjQUFjO1FBQU87SUFDakQ7SUFFQSxPQUFPTixXQUFXLE1BQU07UUFBRUQsUUFBUTtRQUFTQztJQUFRLElBQUk7UUFBRUQsUUFBUTtJQUFPO0FBQzFFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxydW50aW1lXFx0aHJvdHRsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBUaHJvdHRsZURlY2lzaW9uID1cbiAgfCB7IGFjdGlvbjogJ25vbmUnIH1cbiAgfCB7IGFjdGlvbjogJ2RlbGF5JzsgZGVsYXlNczogbnVtYmVyIH1cbiAgfCB7IGFjdGlvbjogJ2Jsb2NrJzsgcmV0cnlBZnRlck1zOiBudW1iZXIgfTtcblxudHlwZSBUaHJvdHRsZVN0YXRlID0ge1xuICBzdHJpa2VzOiBudW1iZXI7XG4gIGxhc3RBdDogbnVtYmVyO1xufTtcblxuY29uc3Qgc3RhdGUgPSBuZXcgTWFwPHN0cmluZywgVGhyb3R0bGVTdGF0ZT4oKTtcblxuZnVuY3Rpb24ga2V5KGlkZW50aXR5SWQ/OiBzdHJpbmcsIGlwSGFzaD86IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBpZGVudGl0eUlkID8gYGlkOiR7aWRlbnRpdHlJZH1gIDogaXBIYXNoID8gYGlwOiR7aXBIYXNofWAgOiAnYW5vbic7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3RlSG9zdGlsZUF0dGVtcHQocGFyYW1zOiB7XG4gIGlkZW50aXR5SWQ/OiBzdHJpbmc7XG4gIGlwSGFzaD86IHN0cmluZztcbiAgbm93PzogbnVtYmVyO1xufSk6IFRocm90dGxlU3RhdGUge1xuICBjb25zdCBub3cgPSBwYXJhbXMubm93ID8/IERhdGUubm93KCk7XG4gIGNvbnN0IGsgPSBrZXkocGFyYW1zLmlkZW50aXR5SWQsIHBhcmFtcy5pcEhhc2gpO1xuICBjb25zdCBwcmV2ID0gc3RhdGUuZ2V0KGspO1xuXG4gIGNvbnN0IHN0cmlrZXMgPSAocHJldj8uc3RyaWtlcyA/PyAwKSArIDE7XG4gIGNvbnN0IG5leHQ6IFRocm90dGxlU3RhdGUgPSB7IHN0cmlrZXMsIGxhc3RBdDogbm93IH07XG4gIHN0YXRlLnNldChrLCBuZXh0KTtcbiAgcmV0dXJuIG5leHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNpZGVUaHJvdHRsZShwYXJhbXM6IHtcbiAgaWRlbnRpdHlJZD86IHN0cmluZztcbiAgaXBIYXNoPzogc3RyaW5nO1xuICBub3c/OiBudW1iZXI7XG59KTogVGhyb3R0bGVEZWNpc2lvbiB7XG4gIGNvbnN0IG5vdyA9IHBhcmFtcy5ub3cgPz8gRGF0ZS5ub3coKTtcbiAgY29uc3QgayA9IGtleShwYXJhbXMuaWRlbnRpdHlJZCwgcGFyYW1zLmlwSGFzaCk7XG4gIGNvbnN0IHMgPSBzdGF0ZS5nZXQoayk7XG4gIGlmICghcykgcmV0dXJuIHsgYWN0aW9uOiAnbm9uZScgfTtcblxuICBjb25zdCBkZWxheU1zID0gTWF0aC5taW4oMjUwICogTWF0aC5wb3coMiwgTWF0aC5tYXgoMCwgcy5zdHJpa2VzIC0gMSkpLCA4MDAwKTtcblxuICBjb25zdCBkZWx0YSA9IG5vdyAtIHMubGFzdEF0O1xuICBpZiAoZGVsdGEgPCAyNTAgJiYgcy5zdHJpa2VzID49IDMpIHtcbiAgICByZXR1cm4geyBhY3Rpb246ICdibG9jaycsIHJldHJ5QWZ0ZXJNczogMTVfMDAwIH07XG4gIH1cblxuICByZXR1cm4gZGVsYXlNcyA+PSA1MDAgPyB7IGFjdGlvbjogJ2RlbGF5JywgZGVsYXlNcyB9IDogeyBhY3Rpb246ICdub25lJyB9O1xufVxuIl0sIm5hbWVzIjpbInN0YXRlIiwiTWFwIiwia2V5IiwiaWRlbnRpdHlJZCIsImlwSGFzaCIsIm5vdGVIb3N0aWxlQXR0ZW1wdCIsInBhcmFtcyIsIm5vdyIsIkRhdGUiLCJrIiwicHJldiIsImdldCIsInN0cmlrZXMiLCJuZXh0IiwibGFzdEF0Iiwic2V0IiwiZGVjaWRlVGhyb3R0bGUiLCJzIiwiYWN0aW9uIiwiZGVsYXlNcyIsIk1hdGgiLCJtaW4iLCJwb3ciLCJtYXgiLCJkZWx0YSIsInJldHJ5QWZ0ZXJNcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/runtime/throttle.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/server/baneGuards.ts":
/*!******************************************!*\
  !*** ../scing/bane/server/baneGuards.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   baneHttpGuard: () => (/* binding */ baneHttpGuard),\n/* harmony export */   baneToolGuard: () => (/* binding */ baneToolGuard)\n/* harmony export */ });\n/* harmony import */ var _integrations_httpMiddleware__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../integrations/httpMiddleware */ \"(api-node)/../scing/bane/integrations/httpMiddleware.ts\");\n/* harmony import */ var _integrations_toolGuard__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../integrations/toolGuard */ \"(api-node)/../scing/bane/integrations/toolGuard.ts\");\n/* harmony import */ var _storage_inMemoryBaneStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../storage/inMemoryBaneStore */ \"(api-node)/../scing/bane/storage/inMemoryBaneStore.ts\");\n/* harmony import */ var _storage_firestoreBaneStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../storage/firestoreBaneStore */ \"(api-node)/../scing/bane/storage/firestoreBaneStore.ts\");\n/* harmony import */ var _firebase_admin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../firebase/admin */ \"(api-node)/../scing/firebase/admin.ts\");\n\n\n\n\n\nfunction buildStore() {\n    try {\n        const db = (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_4__.getAdminFirestore)();\n        return new _storage_firestoreBaneStore__WEBPACK_IMPORTED_MODULE_3__.FirestoreBaneStore(db);\n    } catch  {\n        return new _storage_inMemoryBaneStore__WEBPACK_IMPORTED_MODULE_2__.InMemoryBaneStore();\n    }\n}\n// Server-only singleton guard construction.\nconst config = {\n    profileId: 'bane_fog_v1',\n    store: buildStore()\n};\nconst baneHttpGuard = (0,_integrations_httpMiddleware__WEBPACK_IMPORTED_MODULE_0__.makeBaneHttpGuard)(config);\nconst baneToolGuard = (0,_integrations_toolGuard__WEBPACK_IMPORTED_MODULE_1__.makeBaneToolGuard)(config);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3NlcnZlci9iYW5lR3VhcmRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBbUU7QUFDTDtBQUVHO0FBQ0U7QUFFVjtBQUV6RCxTQUFTSztJQUNQLElBQUk7UUFDRixNQUFNQyxLQUFLRixrRUFBaUJBO1FBQzVCLE9BQU8sSUFBSUQsMkVBQWtCQSxDQUFDRztJQUNoQyxFQUFFLE9BQU07UUFDTixPQUFPLElBQUlKLHlFQUFpQkE7SUFDOUI7QUFDRjtBQUVBLDRDQUE0QztBQUM1QyxNQUFNSyxTQUE0QjtJQUNoQ0MsV0FBVztJQUNYQyxPQUFPSjtBQUNUO0FBRU8sTUFBTUssZ0JBQWdCViwrRUFBaUJBLENBQUNPLFFBQVE7QUFDaEQsTUFBTUksZ0JBQWdCViwwRUFBaUJBLENBQUNNLFFBQVEiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGJhbmVcXHNlcnZlclxcYmFuZUd1YXJkcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtYWtlQmFuZUh0dHBHdWFyZCB9IGZyb20gJy4uL2ludGVncmF0aW9ucy9odHRwTWlkZGxld2FyZSc7XG5pbXBvcnQgeyBtYWtlQmFuZVRvb2xHdWFyZCB9IGZyb20gJy4uL2ludGVncmF0aW9ucy90b29sR3VhcmQnO1xuaW1wb3J0IHR5cGUgeyBCYW5lUnVudGltZUNvbmZpZyB9IGZyb20gJy4uL3J1bnRpbWUvY29uZmlnJztcbmltcG9ydCB7IEluTWVtb3J5QmFuZVN0b3JlIH0gZnJvbSAnLi4vc3RvcmFnZS9pbk1lbW9yeUJhbmVTdG9yZSc7XG5pbXBvcnQgeyBGaXJlc3RvcmVCYW5lU3RvcmUgfSBmcm9tICcuLi9zdG9yYWdlL2ZpcmVzdG9yZUJhbmVTdG9yZSc7XG5cbmltcG9ydCB7IGdldEFkbWluRmlyZXN0b3JlIH0gZnJvbSAnLi4vLi4vZmlyZWJhc2UvYWRtaW4nO1xuXG5mdW5jdGlvbiBidWlsZFN0b3JlKCkge1xuICB0cnkge1xuICAgIGNvbnN0IGRiID0gZ2V0QWRtaW5GaXJlc3RvcmUoKTtcbiAgICByZXR1cm4gbmV3IEZpcmVzdG9yZUJhbmVTdG9yZShkYiBhcyBhbnkpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbmV3IEluTWVtb3J5QmFuZVN0b3JlKCk7XG4gIH1cbn1cblxuLy8gU2VydmVyLW9ubHkgc2luZ2xldG9uIGd1YXJkIGNvbnN0cnVjdGlvbi5cbmNvbnN0IGNvbmZpZzogQmFuZVJ1bnRpbWVDb25maWcgPSB7XG4gIHByb2ZpbGVJZDogJ2JhbmVfZm9nX3YxJyxcbiAgc3RvcmU6IGJ1aWxkU3RvcmUoKSxcbn07XG5cbmV4cG9ydCBjb25zdCBiYW5lSHR0cEd1YXJkID0gbWFrZUJhbmVIdHRwR3VhcmQoY29uZmlnKTtcbmV4cG9ydCBjb25zdCBiYW5lVG9vbEd1YXJkID0gbWFrZUJhbmVUb29sR3VhcmQoY29uZmlnKTtcbiJdLCJuYW1lcyI6WyJtYWtlQmFuZUh0dHBHdWFyZCIsIm1ha2VCYW5lVG9vbEd1YXJkIiwiSW5NZW1vcnlCYW5lU3RvcmUiLCJGaXJlc3RvcmVCYW5lU3RvcmUiLCJnZXRBZG1pbkZpcmVzdG9yZSIsImJ1aWxkU3RvcmUiLCJkYiIsImNvbmZpZyIsInByb2ZpbGVJZCIsInN0b3JlIiwiYmFuZUh0dHBHdWFyZCIsImJhbmVUb29sR3VhcmQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/server/baneGuards.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/storage/collections.ts":
/*!********************************************!*\
  !*** ../scing/bane/storage/collections.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BANE_COLLECTIONS: () => (/* binding */ BANE_COLLECTIONS)\n/* harmony export */ });\nconst BANE_COLLECTIONS = {\n    audits: 'bane_audits',\n    events: 'bane_events',\n    incidents: 'bane_incidents'\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3N0b3JhZ2UvY29sbGVjdGlvbnMudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPLE1BQU1BLG1CQUFtQjtJQUM5QkMsUUFBUTtJQUNSQyxRQUFRO0lBQ1JDLFdBQVc7QUFDYixFQUFXIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxzdG9yYWdlXFxjb2xsZWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgQkFORV9DT0xMRUNUSU9OUyA9IHtcbiAgYXVkaXRzOiAnYmFuZV9hdWRpdHMnLFxuICBldmVudHM6ICdiYW5lX2V2ZW50cycsXG4gIGluY2lkZW50czogJ2JhbmVfaW5jaWRlbnRzJyxcbn0gYXMgY29uc3Q7XG4iXSwibmFtZXMiOlsiQkFORV9DT0xMRUNUSU9OUyIsImF1ZGl0cyIsImV2ZW50cyIsImluY2lkZW50cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/storage/collections.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/storage/firestoreBaneStore.ts":
/*!***************************************************!*\
  !*** ../scing/bane/storage/firestoreBaneStore.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FirestoreBaneStore: () => (/* binding */ FirestoreBaneStore)\n/* harmony export */ });\n/* harmony import */ var _collections__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./collections */ \"(api-node)/../scing/bane/storage/collections.ts\");\n\nfunction asArray(value) {\n    return Array.isArray(value) ? value : [];\n}\nclass FirestoreBaneStore {\n    constructor(db){\n        this.db = db;\n    }\n    async appendAudit(record) {\n        const ref = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.audits).doc();\n        await ref.set({\n            ...record,\n            id: ref.id ?? undefined\n        }, {\n            merge: false\n        });\n    }\n    async appendEvent(event) {\n        const ref = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.events).doc();\n        await ref.set({\n            ...event,\n            id: ref.id ?? undefined\n        }, {\n            merge: false\n        });\n    }\n    async getRecentAudits(limit) {\n        const q = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.audits).orderBy?.('at', 'desc').limit?.(limit);\n        const snap = await (q ?? this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.audits)).get();\n        const docs = asArray(snap?.docs ?? []);\n        return docs.map((d)=>d.data());\n    }\n    async appendIncident(incident) {\n        const ref = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.incidents).doc();\n        await ref.set({\n            ...incident,\n            id: ref.id ?? undefined\n        }, {\n            merge: false\n        });\n    }\n    async getRecentIncidents(limit) {\n        const q = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.incidents).orderBy?.('occurredAt', 'desc').limit?.(limit);\n        const snap = await (q ?? this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.incidents)).get();\n        const docs = asArray(snap?.docs ?? []);\n        return docs.map((d)=>d.data());\n    }\n    async getIncidentByTrace(traceId) {\n        const q = this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.incidents).where?.('traceId', '==', traceId).limit?.(1);\n        const snap = await (q ?? this.db.collection(_collections__WEBPACK_IMPORTED_MODULE_0__.BANE_COLLECTIONS.incidents)).get();\n        const docs = asArray(snap?.docs ?? []);\n        if (!docs.length) return null;\n        return docs[0].data();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3N0b3JhZ2UvZmlyZXN0b3JlQmFuZVN0b3JlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRWlEO0FBMkJqRCxTQUFTQyxRQUFXQyxLQUFjO0lBQ2hDLE9BQU9DLE1BQU1DLE9BQU8sQ0FBQ0YsU0FBVUEsUUFBZ0IsRUFBRTtBQUNuRDtBQUVPLE1BQU1HO0lBR1gsWUFBWUMsRUFBaUIsQ0FBRTtRQUM3QixJQUFJLENBQUNBLEVBQUUsR0FBR0E7SUFDWjtJQUVBLE1BQU1DLFlBQVlDLE1BQXVCLEVBQWlCO1FBQ3hELE1BQU1DLE1BQU0sSUFBSSxDQUFDSCxFQUFFLENBQUNJLFVBQVUsQ0FBQ1YsMERBQWdCQSxDQUFDVyxNQUFNLEVBQUVDLEdBQUc7UUFDM0QsTUFBTUgsSUFBSUksR0FBRyxDQUFDO1lBQUUsR0FBR0wsTUFBTTtZQUFFTSxJQUFJTCxJQUFJSyxFQUFFLElBQUlDO1FBQVUsR0FBRztZQUFFQyxPQUFPO1FBQU07SUFDdkU7SUFFQSxNQUFNQyxZQUFZQyxLQUFzQixFQUFpQjtRQUN2RCxNQUFNVCxNQUFNLElBQUksQ0FBQ0gsRUFBRSxDQUFDSSxVQUFVLENBQUNWLDBEQUFnQkEsQ0FBQ21CLE1BQU0sRUFBRVAsR0FBRztRQUMzRCxNQUFNSCxJQUFJSSxHQUFHLENBQUM7WUFBRSxHQUFHSyxLQUFLO1lBQUVKLElBQUlMLElBQUlLLEVBQUUsSUFBSUM7UUFBVSxHQUFHO1lBQUVDLE9BQU87UUFBTTtJQUN0RTtJQUVBLE1BQU1JLGdCQUFnQkMsS0FBYSxFQUE4QjtRQUMvRCxNQUFNQyxJQUFJLElBQUksQ0FBQ2hCLEVBQUUsQ0FBQ0ksVUFBVSxDQUFDViwwREFBZ0JBLENBQUNXLE1BQU0sRUFBRVksT0FBTyxHQUFHLE1BQU0sUUFBUUYsUUFBUUE7UUFFdEYsTUFBTUcsT0FBTyxNQUFNLENBQUNGLEtBQU0sSUFBSSxDQUFDaEIsRUFBRSxDQUFDSSxVQUFVLENBQUNWLDBEQUFnQkEsQ0FBQ1csTUFBTSxDQUFRLEVBQUdjLEdBQUc7UUFDbEYsTUFBTUMsT0FBT3pCLFFBQXlDLE1BQWV5QixRQUFRLEVBQUU7UUFDL0UsT0FBT0EsS0FBS0MsR0FBRyxDQUFDLENBQUNDLElBQU1BLEVBQUVDLElBQUk7SUFDL0I7SUFFQSxNQUFNQyxlQUFlQyxRQUE0QixFQUFpQjtRQUNoRSxNQUFNdEIsTUFBTSxJQUFJLENBQUNILEVBQUUsQ0FBQ0ksVUFBVSxDQUFDViwwREFBZ0JBLENBQUNnQyxTQUFTLEVBQUVwQixHQUFHO1FBQzlELE1BQU1ILElBQUlJLEdBQUcsQ0FBQztZQUFFLEdBQUdrQixRQUFRO1lBQUVqQixJQUFJTCxJQUFJSyxFQUFFLElBQUlDO1FBQVUsR0FBRztZQUFFQyxPQUFPO1FBQU07SUFDekU7SUFFQSxNQUFNaUIsbUJBQW1CWixLQUFhLEVBQWlDO1FBQ3JFLE1BQU1DLElBQUksSUFBSSxDQUFDaEIsRUFBRSxDQUNkSSxVQUFVLENBQUNWLDBEQUFnQkEsQ0FBQ2dDLFNBQVMsRUFDckNULE9BQU8sR0FBRyxjQUFjLFFBQ3hCRixRQUFRQTtRQUVYLE1BQU1HLE9BQU8sTUFBTSxDQUFDRixLQUFNLElBQUksQ0FBQ2hCLEVBQUUsQ0FBQ0ksVUFBVSxDQUFDViwwREFBZ0JBLENBQUNnQyxTQUFTLENBQVEsRUFBR1AsR0FBRztRQUNyRixNQUFNQyxPQUFPekIsUUFBeUMsTUFBZXlCLFFBQVEsRUFBRTtRQUMvRSxPQUFPQSxLQUFLQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRUMsSUFBSTtJQUMvQjtJQUVBLE1BQU1LLG1CQUFtQkMsT0FBZSxFQUFzQztRQUM1RSxNQUFNYixJQUFJLElBQUksQ0FBQ2hCLEVBQUUsQ0FDZEksVUFBVSxDQUFDViwwREFBZ0JBLENBQUNnQyxTQUFTLEVBQ3JDSSxLQUFLLEdBQUcsV0FBVyxNQUFNRCxTQUN6QmQsUUFBUTtRQUVYLE1BQU1HLE9BQU8sTUFBTSxDQUFDRixLQUFNLElBQUksQ0FBQ2hCLEVBQUUsQ0FBQ0ksVUFBVSxDQUFDViwwREFBZ0JBLENBQUNnQyxTQUFTLENBQVEsRUFBR1AsR0FBRztRQUNyRixNQUFNQyxPQUFPekIsUUFBeUMsTUFBZXlCLFFBQVEsRUFBRTtRQUMvRSxJQUFJLENBQUNBLEtBQUtXLE1BQU0sRUFBRSxPQUFPO1FBQ3pCLE9BQU9YLElBQUksQ0FBQyxFQUFFLENBQUNHLElBQUk7SUFDckI7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcc3RvcmFnZVxcZmlyZXN0b3JlQmFuZVN0b3JlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmFuZVN0b3JlIH0gZnJvbSAnLi9iYW5lU3RvcmUnO1xuaW1wb3J0IHR5cGUgeyBCYW5lQXVkaXRSZWNvcmQsIEJhbmVFdmVudFJlY29yZCwgQmFuZUluY2lkZW50UmVjb3JkIH0gZnJvbSAnLi9yZWNvcmRzJztcbmltcG9ydCB7IEJBTkVfQ09MTEVDVElPTlMgfSBmcm9tICcuL2NvbGxlY3Rpb25zJztcblxudHlwZSBGaXJlc3RvcmVEb2NSZWYgPSB7XG4gIGlkPzogc3RyaW5nO1xuICBzZXQ6IChkYXRhOiB1bmtub3duLCBvcHRzPzogeyBtZXJnZT86IGJvb2xlYW4gfSkgPT4gUHJvbWlzZTx1bmtub3duPjtcbn07XG5cbnR5cGUgRmlyZXN0b3JlUXVlcnlTbmFwID0ge1xuICBkb2NzOiBBcnJheTx7IGlkOiBzdHJpbmc7IGRhdGE6ICgpID0+IGFueSB9PjtcbiAgZm9yRWFjaD86IChjYjogKGQ6IHsgaWQ6IHN0cmluZzsgZGF0YTogKCkgPT4gYW55IH0pID0+IHZvaWQpID0+IHZvaWQ7XG59O1xuXG50eXBlIEZpcmVzdG9yZVF1ZXJ5ID0ge1xuICBvcmRlckJ5PzogKGZpZWxkOiBzdHJpbmcsIGRpcjogJ2FzYycgfCAnZGVzYycpID0+IEZpcmVzdG9yZVF1ZXJ5O1xuICBsaW1pdD86IChuOiBudW1iZXIpID0+IEZpcmVzdG9yZVF1ZXJ5O1xuICB3aGVyZT86IChmaWVsZDogc3RyaW5nLCBvcDogYW55LCB2YWx1ZTogYW55KSA9PiBGaXJlc3RvcmVRdWVyeTtcbiAgZ2V0OiAoKSA9PiBQcm9taXNlPEZpcmVzdG9yZVF1ZXJ5U25hcD47XG59O1xuXG50eXBlIEZpcmVzdG9yZUNvbGxlY3Rpb25SZWYgPSBGaXJlc3RvcmVRdWVyeSAmIHtcbiAgZG9jOiAoaWQ/OiBzdHJpbmcpID0+IEZpcmVzdG9yZURvY1JlZjtcbn07XG5cbnR5cGUgRmlyZXN0b3JlTGlrZSA9IHtcbiAgY29sbGVjdGlvbjogKG5hbWU6IHN0cmluZykgPT4gRmlyZXN0b3JlQ29sbGVjdGlvblJlZjtcbn07XG5cbmZ1bmN0aW9uIGFzQXJyYXk8VD4odmFsdWU6IHVua25vd24pOiBUW10ge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyAodmFsdWUgYXMgVFtdKSA6IFtdO1xufVxuXG5leHBvcnQgY2xhc3MgRmlyZXN0b3JlQmFuZVN0b3JlIGltcGxlbWVudHMgQmFuZVN0b3JlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBkYjogRmlyZXN0b3JlTGlrZTtcblxuICBjb25zdHJ1Y3RvcihkYjogRmlyZXN0b3JlTGlrZSkge1xuICAgIHRoaXMuZGIgPSBkYjtcbiAgfVxuXG4gIGFzeW5jIGFwcGVuZEF1ZGl0KHJlY29yZDogQmFuZUF1ZGl0UmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVmID0gdGhpcy5kYi5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuYXVkaXRzKS5kb2MoKTtcbiAgICBhd2FpdCByZWYuc2V0KHsgLi4ucmVjb3JkLCBpZDogcmVmLmlkID8/IHVuZGVmaW5lZCB9LCB7IG1lcmdlOiBmYWxzZSB9KTtcbiAgfVxuXG4gIGFzeW5jIGFwcGVuZEV2ZW50KGV2ZW50OiBCYW5lRXZlbnRSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZWYgPSB0aGlzLmRiLmNvbGxlY3Rpb24oQkFORV9DT0xMRUNUSU9OUy5ldmVudHMpLmRvYygpO1xuICAgIGF3YWl0IHJlZi5zZXQoeyAuLi5ldmVudCwgaWQ6IHJlZi5pZCA/PyB1bmRlZmluZWQgfSwgeyBtZXJnZTogZmFsc2UgfSk7XG4gIH1cblxuICBhc3luYyBnZXRSZWNlbnRBdWRpdHMobGltaXQ6IG51bWJlcik6IFByb21pc2U8QmFuZUF1ZGl0UmVjb3JkW10+IHtcbiAgICBjb25zdCBxID0gdGhpcy5kYi5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuYXVkaXRzKS5vcmRlckJ5Py4oJ2F0JywgJ2Rlc2MnKS5saW1pdD8uKGxpbWl0KTtcblxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCAocSA/PyAodGhpcy5kYi5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuYXVkaXRzKSBhcyBhbnkpKS5nZXQoKTtcbiAgICBjb25zdCBkb2NzID0gYXNBcnJheTx7IGlkOiBzdHJpbmc7IGRhdGE6ICgpID0+IGFueSB9Pigoc25hcCBhcyBhbnkpPy5kb2NzID8/IFtdKTtcbiAgICByZXR1cm4gZG9jcy5tYXAoKGQpID0+IGQuZGF0YSgpIGFzIEJhbmVBdWRpdFJlY29yZCk7XG4gIH1cblxuICBhc3luYyBhcHBlbmRJbmNpZGVudChpbmNpZGVudDogQmFuZUluY2lkZW50UmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVmID0gdGhpcy5kYi5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuaW5jaWRlbnRzKS5kb2MoKTtcbiAgICBhd2FpdCByZWYuc2V0KHsgLi4uaW5jaWRlbnQsIGlkOiByZWYuaWQgPz8gdW5kZWZpbmVkIH0sIHsgbWVyZ2U6IGZhbHNlIH0pO1xuICB9XG5cbiAgYXN5bmMgZ2V0UmVjZW50SW5jaWRlbnRzKGxpbWl0OiBudW1iZXIpOiBQcm9taXNlPEJhbmVJbmNpZGVudFJlY29yZFtdPiB7XG4gICAgY29uc3QgcSA9IHRoaXMuZGJcbiAgICAgIC5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuaW5jaWRlbnRzKVxuICAgICAgLm9yZGVyQnk/Lignb2NjdXJyZWRBdCcsICdkZXNjJylcbiAgICAgIC5saW1pdD8uKGxpbWl0KTtcblxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCAocSA/PyAodGhpcy5kYi5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuaW5jaWRlbnRzKSBhcyBhbnkpKS5nZXQoKTtcbiAgICBjb25zdCBkb2NzID0gYXNBcnJheTx7IGlkOiBzdHJpbmc7IGRhdGE6ICgpID0+IGFueSB9Pigoc25hcCBhcyBhbnkpPy5kb2NzID8/IFtdKTtcbiAgICByZXR1cm4gZG9jcy5tYXAoKGQpID0+IGQuZGF0YSgpIGFzIEJhbmVJbmNpZGVudFJlY29yZCk7XG4gIH1cblxuICBhc3luYyBnZXRJbmNpZGVudEJ5VHJhY2UodHJhY2VJZDogc3RyaW5nKTogUHJvbWlzZTxCYW5lSW5jaWRlbnRSZWNvcmQgfCBudWxsPiB7XG4gICAgY29uc3QgcSA9IHRoaXMuZGJcbiAgICAgIC5jb2xsZWN0aW9uKEJBTkVfQ09MTEVDVElPTlMuaW5jaWRlbnRzKVxuICAgICAgLndoZXJlPy4oJ3RyYWNlSWQnLCAnPT0nLCB0cmFjZUlkKVxuICAgICAgLmxpbWl0Py4oMSk7XG5cbiAgICBjb25zdCBzbmFwID0gYXdhaXQgKHEgPz8gKHRoaXMuZGIuY29sbGVjdGlvbihCQU5FX0NPTExFQ1RJT05TLmluY2lkZW50cykgYXMgYW55KSkuZ2V0KCk7XG4gICAgY29uc3QgZG9jcyA9IGFzQXJyYXk8eyBpZDogc3RyaW5nOyBkYXRhOiAoKSA9PiBhbnkgfT4oKHNuYXAgYXMgYW55KT8uZG9jcyA/PyBbXSk7XG4gICAgaWYgKCFkb2NzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIGRvY3NbMF0uZGF0YSgpIGFzIEJhbmVJbmNpZGVudFJlY29yZDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkJBTkVfQ09MTEVDVElPTlMiLCJhc0FycmF5IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJGaXJlc3RvcmVCYW5lU3RvcmUiLCJkYiIsImFwcGVuZEF1ZGl0IiwicmVjb3JkIiwicmVmIiwiY29sbGVjdGlvbiIsImF1ZGl0cyIsImRvYyIsInNldCIsImlkIiwidW5kZWZpbmVkIiwibWVyZ2UiLCJhcHBlbmRFdmVudCIsImV2ZW50IiwiZXZlbnRzIiwiZ2V0UmVjZW50QXVkaXRzIiwibGltaXQiLCJxIiwib3JkZXJCeSIsInNuYXAiLCJnZXQiLCJkb2NzIiwibWFwIiwiZCIsImRhdGEiLCJhcHBlbmRJbmNpZGVudCIsImluY2lkZW50IiwiaW5jaWRlbnRzIiwiZ2V0UmVjZW50SW5jaWRlbnRzIiwiZ2V0SW5jaWRlbnRCeVRyYWNlIiwidHJhY2VJZCIsIndoZXJlIiwibGVuZ3RoIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/storage/firestoreBaneStore.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/storage/hash.ts":
/*!*************************************!*\
  !*** ../scing/bane/storage/hash.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sha256Hex: () => (/* binding */ sha256Hex)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction sha256Hex(s) {\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('sha256').update(s).digest('hex');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3N0b3JhZ2UvaGFzaC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBaUM7QUFFMUIsU0FBU0MsVUFBVUMsQ0FBUztJQUNqQyxPQUFPRiw2REFBaUIsQ0FBQyxVQUFVSSxNQUFNLENBQUNGLEdBQUdHLE1BQU0sQ0FBQztBQUN0RCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcc3RvcmFnZVxcaGFzaC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3J5cHRvIGZyb20gJ25vZGU6Y3J5cHRvJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNoYTI1NkhleChzOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShzKS5kaWdlc3QoJ2hleCcpO1xufVxuIl0sIm5hbWVzIjpbImNyeXB0byIsInNoYTI1NkhleCIsInMiLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/storage/hash.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/storage/inMemoryBaneStore.ts":
/*!**************************************************!*\
  !*** ../scing/bane/storage/inMemoryBaneStore.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InMemoryBaneStore: () => (/* binding */ InMemoryBaneStore)\n/* harmony export */ });\nclass InMemoryBaneStore {\n    async appendAudit(record) {\n        this.audits.push(record);\n    }\n    async appendEvent(event) {\n        this.events.push(event);\n    }\n    async getRecentAudits(limit) {\n        return this.audits.slice().sort((a, b)=>b.at - a.at).slice(0, Math.max(1, Math.min(200, limit)));\n    }\n    async appendIncident(incident) {\n        this.incidents.push(incident);\n    }\n    async getRecentIncidents(limit) {\n        return this.incidents.slice().sort((a, b)=>b.occurredAt - a.occurredAt).slice(0, Math.max(1, Math.min(200, limit)));\n    }\n    async getIncidentByTrace(traceId) {\n        return this.incidents.find((i)=>i.traceId === traceId) ?? null;\n    }\n    constructor(){\n        this.audits = [];\n        this.events = [];\n        this.incidents = [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3N0b3JhZ2UvaW5NZW1vcnlCYW5lU3RvcmUudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUdPLE1BQU1BO0lBS1gsTUFBTUMsWUFBWUMsTUFBdUIsRUFBaUI7UUFDeEQsSUFBSSxDQUFDQyxNQUFNLENBQUNDLElBQUksQ0FBQ0Y7SUFDbkI7SUFFQSxNQUFNRyxZQUFZQyxLQUFzQixFQUFpQjtRQUN2RCxJQUFJLENBQUNDLE1BQU0sQ0FBQ0gsSUFBSSxDQUFDRTtJQUNuQjtJQUVBLE1BQU1FLGdCQUFnQkMsS0FBYSxFQUE4QjtRQUMvRCxPQUFPLElBQUksQ0FBQ04sTUFBTSxDQUNmTyxLQUFLLEdBQ0xDLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxFQUFFQyxFQUFFLEdBQUdGLEVBQUVFLEVBQUUsRUFDMUJKLEtBQUssQ0FBQyxHQUFHSyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEtBQUtSO0lBQ3hDO0lBRUEsTUFBTVMsZUFBZUMsUUFBNEIsRUFBaUI7UUFDaEUsSUFBSSxDQUFDQyxTQUFTLENBQUNoQixJQUFJLENBQUNlO0lBQ3RCO0lBRUEsTUFBTUUsbUJBQW1CWixLQUFhLEVBQWlDO1FBQ3JFLE9BQU8sSUFBSSxDQUFDVyxTQUFTLENBQ2xCVixLQUFLLEdBQ0xDLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxFQUFFUyxVQUFVLEdBQUdWLEVBQUVVLFVBQVUsRUFDMUNaLEtBQUssQ0FBQyxHQUFHSyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEtBQUtSO0lBQ3hDO0lBRUEsTUFBTWMsbUJBQW1CQyxPQUFlLEVBQXNDO1FBQzVFLE9BQU8sSUFBSSxDQUFDSixTQUFTLENBQUNLLElBQUksQ0FBQyxDQUFDQyxJQUFNQSxFQUFFRixPQUFPLEtBQUtBLFlBQVk7SUFDOUQ7O2FBaENRckIsU0FBNEIsRUFBRTthQUM5QkksU0FBNEIsRUFBRTthQUM5QmEsWUFBa0MsRUFBRTs7QUErQjlDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hc3RlXFxTQ0lOR09TX1dPUktcXFNjaW5nT1NcXHNjaW5nXFxiYW5lXFxzdG9yYWdlXFxpbk1lbW9yeUJhbmVTdG9yZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVTdG9yZSB9IGZyb20gJy4vYmFuZVN0b3JlJztcbmltcG9ydCB0eXBlIHsgQmFuZUF1ZGl0UmVjb3JkLCBCYW5lRXZlbnRSZWNvcmQsIEJhbmVJbmNpZGVudFJlY29yZCB9IGZyb20gJy4vcmVjb3Jkcyc7XG5cbmV4cG9ydCBjbGFzcyBJbk1lbW9yeUJhbmVTdG9yZSBpbXBsZW1lbnRzIEJhbmVTdG9yZSB7XG4gIHByaXZhdGUgYXVkaXRzOiBCYW5lQXVkaXRSZWNvcmRbXSA9IFtdO1xuICBwcml2YXRlIGV2ZW50czogQmFuZUV2ZW50UmVjb3JkW10gPSBbXTtcbiAgcHJpdmF0ZSBpbmNpZGVudHM6IEJhbmVJbmNpZGVudFJlY29yZFtdID0gW107XG5cbiAgYXN5bmMgYXBwZW5kQXVkaXQocmVjb3JkOiBCYW5lQXVkaXRSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmF1ZGl0cy5wdXNoKHJlY29yZCk7XG4gIH1cblxuICBhc3luYyBhcHBlbmRFdmVudChldmVudDogQmFuZUV2ZW50UmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5ldmVudHMucHVzaChldmVudCk7XG4gIH1cblxuICBhc3luYyBnZXRSZWNlbnRBdWRpdHMobGltaXQ6IG51bWJlcik6IFByb21pc2U8QmFuZUF1ZGl0UmVjb3JkW10+IHtcbiAgICByZXR1cm4gdGhpcy5hdWRpdHNcbiAgICAgIC5zbGljZSgpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5hdCAtIGEuYXQpXG4gICAgICAuc2xpY2UoMCwgTWF0aC5tYXgoMSwgTWF0aC5taW4oMjAwLCBsaW1pdCkpKTtcbiAgfVxuXG4gIGFzeW5jIGFwcGVuZEluY2lkZW50KGluY2lkZW50OiBCYW5lSW5jaWRlbnRSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmluY2lkZW50cy5wdXNoKGluY2lkZW50KTtcbiAgfVxuXG4gIGFzeW5jIGdldFJlY2VudEluY2lkZW50cyhsaW1pdDogbnVtYmVyKTogUHJvbWlzZTxCYW5lSW5jaWRlbnRSZWNvcmRbXT4ge1xuICAgIHJldHVybiB0aGlzLmluY2lkZW50c1xuICAgICAgLnNsaWNlKClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLm9jY3VycmVkQXQgLSBhLm9jY3VycmVkQXQpXG4gICAgICAuc2xpY2UoMCwgTWF0aC5tYXgoMSwgTWF0aC5taW4oMjAwLCBsaW1pdCkpKTtcbiAgfVxuXG4gIGFzeW5jIGdldEluY2lkZW50QnlUcmFjZSh0cmFjZUlkOiBzdHJpbmcpOiBQcm9taXNlPEJhbmVJbmNpZGVudFJlY29yZCB8IG51bGw+IHtcbiAgICByZXR1cm4gdGhpcy5pbmNpZGVudHMuZmluZCgoaSkgPT4gaS50cmFjZUlkID09PSB0cmFjZUlkKSA/PyBudWxsO1xuICB9XG59XG4iXSwibmFtZXMiOlsiSW5NZW1vcnlCYW5lU3RvcmUiLCJhcHBlbmRBdWRpdCIsInJlY29yZCIsImF1ZGl0cyIsInB1c2giLCJhcHBlbmRFdmVudCIsImV2ZW50IiwiZXZlbnRzIiwiZ2V0UmVjZW50QXVkaXRzIiwibGltaXQiLCJzbGljZSIsInNvcnQiLCJhIiwiYiIsImF0IiwiTWF0aCIsIm1heCIsIm1pbiIsImFwcGVuZEluY2lkZW50IiwiaW5jaWRlbnQiLCJpbmNpZGVudHMiLCJnZXRSZWNlbnRJbmNpZGVudHMiLCJvY2N1cnJlZEF0IiwiZ2V0SW5jaWRlbnRCeVRyYWNlIiwidHJhY2VJZCIsImZpbmQiLCJpIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/storage/inMemoryBaneStore.ts\n");

/***/ }),

/***/ "(api-node)/../scing/bane/storage/toAuditRecord.ts":
/*!**********************************************!*\
  !*** ../scing/bane/storage/toAuditRecord.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toAuditRecord: () => (/* binding */ toAuditRecord)\n/* harmony export */ });\n/* harmony import */ var _hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hash */ \"(api-node)/../scing/bane/storage/hash.ts\");\n\nfunction toAuditRecord(input, out) {\n    const rawText = input.text ?? '';\n    const safeText = out.safeText;\n    return {\n        at: Date.now(),\n        traceId: out.traceId,\n        route: String(input.req?.route ?? 'unknown'),\n        requiredCapability: input.req?.requiredCapability,\n        identityId: input.req?.auth?.identityId,\n        verdict: out.verdict,\n        severity: out.severity,\n        enforcementLevel: out.enforcementLevel,\n        inputHash: (0,_hash__WEBPACK_IMPORTED_MODULE_0__.sha256Hex)(rawText),\n        safeTextHash: typeof safeText === 'string' ? (0,_hash__WEBPACK_IMPORTED_MODULE_0__.sha256Hex)(safeText) : undefined,\n        findingsSummary: (out.findings ?? []).map((f)=>({\n                id: f.id,\n                severity: f.severity,\n                verdict: f.verdict\n            }))\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9iYW5lL3N0b3JhZ2UvdG9BdWRpdFJlY29yZC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUVtQztBQUU1QixTQUFTQyxjQUFjQyxLQUFnQixFQUFFQyxHQUFlO0lBQzdELE1BQU1DLFVBQVVGLE1BQU1HLElBQUksSUFBSTtJQUM5QixNQUFNQyxXQUFXSCxJQUFJRyxRQUFRO0lBQzdCLE9BQU87UUFDTEMsSUFBSUMsS0FBS0MsR0FBRztRQUNaQyxTQUFTUCxJQUFJTyxPQUFPO1FBQ3BCQyxPQUFPQyxPQUFPVixNQUFNVyxHQUFHLEVBQUVGLFNBQVM7UUFDbENHLG9CQUFvQlosTUFBTVcsR0FBRyxFQUFFQztRQUMvQkMsWUFBWWIsTUFBTVcsR0FBRyxFQUFFRyxNQUFNRDtRQUM3QkUsU0FBU2QsSUFBSWMsT0FBTztRQUNwQkMsVUFBVWYsSUFBSWUsUUFBUTtRQUN0QkMsa0JBQWtCaEIsSUFBSWdCLGdCQUFnQjtRQUN0Q0MsV0FBV3BCLGdEQUFTQSxDQUFDSTtRQUNyQmlCLGNBQWMsT0FBT2YsYUFBYSxXQUFXTixnREFBU0EsQ0FBQ00sWUFBWWdCO1FBQ25FQyxpQkFBaUIsQ0FBQ3BCLElBQUlxQixRQUFRLElBQUksRUFBRSxFQUFFQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTztnQkFDaERDLElBQUlELEVBQUVDLEVBQUU7Z0JBQ1JULFVBQVVRLEVBQUVSLFFBQVE7Z0JBQ3BCRCxTQUFTUyxFQUFFVCxPQUFPO1lBQ3BCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxzY2luZ1xcYmFuZVxcc3RvcmFnZVxcdG9BdWRpdFJlY29yZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJhbmVJbnB1dCwgQmFuZU91dHB1dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgQmFuZUF1ZGl0UmVjb3JkIH0gZnJvbSAnLi9yZWNvcmRzJztcbmltcG9ydCB7IHNoYTI1NkhleCB9IGZyb20gJy4vaGFzaCc7XG5cbmV4cG9ydCBmdW5jdGlvbiB0b0F1ZGl0UmVjb3JkKGlucHV0OiBCYW5lSW5wdXQsIG91dDogQmFuZU91dHB1dCk6IEJhbmVBdWRpdFJlY29yZCB7XG4gIGNvbnN0IHJhd1RleHQgPSBpbnB1dC50ZXh0ID8/ICcnO1xuICBjb25zdCBzYWZlVGV4dCA9IG91dC5zYWZlVGV4dDtcbiAgcmV0dXJuIHtcbiAgICBhdDogRGF0ZS5ub3coKSxcbiAgICB0cmFjZUlkOiBvdXQudHJhY2VJZCxcbiAgICByb3V0ZTogU3RyaW5nKGlucHV0LnJlcT8ucm91dGUgPz8gJ3Vua25vd24nKSxcbiAgICByZXF1aXJlZENhcGFiaWxpdHk6IGlucHV0LnJlcT8ucmVxdWlyZWRDYXBhYmlsaXR5LFxuICAgIGlkZW50aXR5SWQ6IGlucHV0LnJlcT8uYXV0aD8uaWRlbnRpdHlJZCxcbiAgICB2ZXJkaWN0OiBvdXQudmVyZGljdCxcbiAgICBzZXZlcml0eTogb3V0LnNldmVyaXR5LFxuICAgIGVuZm9yY2VtZW50TGV2ZWw6IG91dC5lbmZvcmNlbWVudExldmVsLFxuICAgIGlucHV0SGFzaDogc2hhMjU2SGV4KHJhd1RleHQpLFxuICAgIHNhZmVUZXh0SGFzaDogdHlwZW9mIHNhZmVUZXh0ID09PSAnc3RyaW5nJyA/IHNoYTI1NkhleChzYWZlVGV4dCkgOiB1bmRlZmluZWQsXG4gICAgZmluZGluZ3NTdW1tYXJ5OiAob3V0LmZpbmRpbmdzID8/IFtdKS5tYXAoKGYpID0+ICh7XG4gICAgICBpZDogZi5pZCxcbiAgICAgIHNldmVyaXR5OiBmLnNldmVyaXR5LFxuICAgICAgdmVyZGljdDogZi52ZXJkaWN0LFxuICAgIH0pKSxcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJzaGEyNTZIZXgiLCJ0b0F1ZGl0UmVjb3JkIiwiaW5wdXQiLCJvdXQiLCJyYXdUZXh0IiwidGV4dCIsInNhZmVUZXh0IiwiYXQiLCJEYXRlIiwibm93IiwidHJhY2VJZCIsInJvdXRlIiwiU3RyaW5nIiwicmVxIiwicmVxdWlyZWRDYXBhYmlsaXR5IiwiaWRlbnRpdHlJZCIsImF1dGgiLCJ2ZXJkaWN0Iiwic2V2ZXJpdHkiLCJlbmZvcmNlbWVudExldmVsIiwiaW5wdXRIYXNoIiwic2FmZVRleHRIYXNoIiwidW5kZWZpbmVkIiwiZmluZGluZ3NTdW1tYXJ5IiwiZmluZGluZ3MiLCJtYXAiLCJmIiwiaWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../scing/bane/storage/toAuditRecord.ts\n");

/***/ }),

/***/ "(api-node)/../scing/firebase/admin.ts":
/*!**********************************!*\
  !*** ../scing/firebase/admin.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAdminApp: () => (/* binding */ getAdminApp),\n/* harmony export */   getAdminFirestore: () => (/* binding */ getAdminFirestore)\n/* harmony export */ });\n// Server-only Firebase Admin wrapper.\n// Uses GOOGLE_APPLICATION_CREDENTIALS or default service account in hosted envs.\n// NOTE: This module intentionally avoids a static import of `firebase-admin` so\n// the base repo does not require firebase-admin as a root dependency.\n// Cloud Functions (and any server host that installs firebase-admin) can use it.\nlet adminMod;\nlet app;\nfunction getAdmin() {\n    if (adminMod) return adminMod;\n    // Avoid bundlers trying to resolve firebase-admin at build time (e.g. Next.js).\n    const req = (0, eval)('require');\n    const loaded = req('firebase-admin');\n    adminMod = loaded?.default ?? loaded;\n    return adminMod;\n}\nfunction getAdminApp() {\n    if (app) return app;\n    const admin = getAdmin();\n    if (!admin.apps || admin.apps.length === 0) {\n        admin.initializeApp();\n    }\n    app = admin.app();\n    return app;\n}\nfunction getAdminFirestore() {\n    return getAdminApp().firestore();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi9zY2luZy9maXJlYmFzZS9hZG1pbi50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLHNDQUFzQztBQUN0QyxpRkFBaUY7QUFFakYsZ0ZBQWdGO0FBQ2hGLHNFQUFzRTtBQUN0RSxpRkFBaUY7QUFRakYsSUFBSUE7QUFDSixJQUFJQztBQUVKLFNBQVNDO0lBQ1AsSUFBSUYsVUFBVSxPQUFPQTtJQUVyQixnRkFBZ0Y7SUFDaEYsTUFBTUcsTUFBTSxDQUFDLEdBQUdDLElBQUcsRUFBRztJQUN0QixNQUFNQyxTQUFTRixJQUFJO0lBQ25CSCxXQUFZSyxRQUFRQyxXQUFXRDtJQUMvQixPQUFPTDtBQUNUO0FBRU8sU0FBU087SUFDZCxJQUFJTixLQUFLLE9BQU9BO0lBRWhCLE1BQU1PLFFBQVFOO0lBRWQsSUFBSSxDQUFDTSxNQUFNQyxJQUFJLElBQUlELE1BQU1DLElBQUksQ0FBQ0MsTUFBTSxLQUFLLEdBQUc7UUFDMUNGLE1BQU1HLGFBQWE7SUFDckI7SUFFQVYsTUFBTU8sTUFBTVAsR0FBRztJQUNmLE9BQU9BO0FBQ1Q7QUFFTyxTQUFTVztJQUNkLE9BQU9MLGNBQWNNLFNBQVM7QUFDaEMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFzdGVcXFNDSU5HT1NfV09SS1xcU2NpbmdPU1xcc2NpbmdcXGZpcmViYXNlXFxhZG1pbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2ZXItb25seSBGaXJlYmFzZSBBZG1pbiB3cmFwcGVyLlxuLy8gVXNlcyBHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFMgb3IgZGVmYXVsdCBzZXJ2aWNlIGFjY291bnQgaW4gaG9zdGVkIGVudnMuXG5cbi8vIE5PVEU6IFRoaXMgbW9kdWxlIGludGVudGlvbmFsbHkgYXZvaWRzIGEgc3RhdGljIGltcG9ydCBvZiBgZmlyZWJhc2UtYWRtaW5gIHNvXG4vLyB0aGUgYmFzZSByZXBvIGRvZXMgbm90IHJlcXVpcmUgZmlyZWJhc2UtYWRtaW4gYXMgYSByb290IGRlcGVuZGVuY3kuXG4vLyBDbG91ZCBGdW5jdGlvbnMgKGFuZCBhbnkgc2VydmVyIGhvc3QgdGhhdCBpbnN0YWxscyBmaXJlYmFzZS1hZG1pbikgY2FuIHVzZSBpdC5cblxudHlwZSBBZG1pbk1vZHVsZSA9IHtcbiAgYXBwczogYW55W107XG4gIGluaXRpYWxpemVBcHA6ICgpID0+IHZvaWQ7XG4gIGFwcDogKCkgPT4gYW55O1xufTtcblxubGV0IGFkbWluTW9kOiBBZG1pbk1vZHVsZSB8IHVuZGVmaW5lZDtcbmxldCBhcHA6IGFueSB8IHVuZGVmaW5lZDtcblxuZnVuY3Rpb24gZ2V0QWRtaW4oKTogQWRtaW5Nb2R1bGUge1xuICBpZiAoYWRtaW5Nb2QpIHJldHVybiBhZG1pbk1vZDtcblxuICAvLyBBdm9pZCBidW5kbGVycyB0cnlpbmcgdG8gcmVzb2x2ZSBmaXJlYmFzZS1hZG1pbiBhdCBidWlsZCB0aW1lIChlLmcuIE5leHQuanMpLlxuICBjb25zdCByZXEgPSAoMCwgZXZhbCkoJ3JlcXVpcmUnKSBhcyAoaWQ6IHN0cmluZykgPT4gYW55O1xuICBjb25zdCBsb2FkZWQgPSByZXEoJ2ZpcmViYXNlLWFkbWluJyk7XG4gIGFkbWluTW9kID0gKGxvYWRlZD8uZGVmYXVsdCA/PyBsb2FkZWQpIGFzIEFkbWluTW9kdWxlO1xuICByZXR1cm4gYWRtaW5Nb2Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZG1pbkFwcCgpOiBhbnkge1xuICBpZiAoYXBwKSByZXR1cm4gYXBwO1xuXG4gIGNvbnN0IGFkbWluID0gZ2V0QWRtaW4oKTtcblxuICBpZiAoIWFkbWluLmFwcHMgfHwgYWRtaW4uYXBwcy5sZW5ndGggPT09IDApIHtcbiAgICBhZG1pbi5pbml0aWFsaXplQXBwKCk7XG4gIH1cblxuICBhcHAgPSBhZG1pbi5hcHAoKTtcbiAgcmV0dXJuIGFwcDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFkbWluRmlyZXN0b3JlKCk6IGFueSB7XG4gIHJldHVybiBnZXRBZG1pbkFwcCgpLmZpcmVzdG9yZSgpO1xufVxuIl0sIm5hbWVzIjpbImFkbWluTW9kIiwiYXBwIiwiZ2V0QWRtaW4iLCJyZXEiLCJldmFsIiwibG9hZGVkIiwiZGVmYXVsdCIsImdldEFkbWluQXBwIiwiYWRtaW4iLCJhcHBzIiwibGVuZ3RoIiwiaW5pdGlhbGl6ZUFwcCIsImdldEFkbWluRmlyZXN0b3JlIiwiZmlyZXN0b3JlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../scing/firebase/admin.ts\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fneural%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cneural%5Cstream.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fneural%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cneural%5Cstream.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_neural_stream_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pages\\api\\neural\\stream.ts */ \"(api-node)/./pages/api/neural/stream.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(api-node)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n// Import the userland code.\n\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_neural_stream_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_neural_stream_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/neural/stream\",\n        pathname: \"/api/neural/stream\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_neural_stream_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\\\\dev\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_7__.addRequestMeta)(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/neural/stream\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/neural/stream\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGbmV1cmFsJTJGc3RyZWFtJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNuZXVyYWwlNUNzdHJlYW0udHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDQztBQUN1QztBQUNyQztBQUMxRDtBQUM0RDtBQUNZO0FBQ0Y7QUFDUDtBQUMvRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsd0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHdEQUFRO0FBQ3BDO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osYUFBYSxZQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9ELENBQUM7QUFDTTtBQUNQO0FBQ0EsUUFBUSw2RUFBYztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxLQUFxQixFQUFFLEVBRTFCO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUF3RDtBQUNwRTtBQUNBO0FBQ0EsdUJBQXVCLDRFQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLDZDQUE2QyxFQUE2QztBQUMxRiw0Q0FBNEMsS0FBd0M7QUFDcEYsaUNBQWlDLEtBQW9DO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnRkFBYztBQUMvRSwrREFBK0QseUNBQXlDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVEsRUFBRSxNQUFNO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVDQUF1QyxRQUFRLEVBQUUsUUFBUTtBQUN6RDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHFFQUFTO0FBQ2pCLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzZW5kRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9hcGktdXRpbHNcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXG5ldXJhbFxcXFxzdHJlYW0udHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGFkZFJlcXVlc3RNZXRhIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVxdWVzdC1tZXRhXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL25ldXJhbC9zdHJlYW1cIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9uZXVyYWwvc3RyZWFtXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmQsXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnXG59KTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgYWRkUmVxdWVzdE1ldGEocmVxLCAnZGV2UmVxdWVzdFRpbWluZ0ludGVybmFsc0VuZCcsIHByb2Nlc3MuaHJ0aW1lLmJpZ2ludCgpKTtcbiAgICB9XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvbmV1cmFsL3N0cmVhbVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHsgcXVlcnksIHBhcmFtcywgcHJlcmVuZGVyTWFuaWZlc3QsIHJvdXRlclNlcnZlckNvbnRleHQgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICAgICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgICAgIGNvbnN0IG9uUmVxdWVzdEVycm9yID0gcm91dGVNb2R1bGUuaW5zdHJ1bWVudGF0aW9uT25SZXF1ZXN0RXJyb3IuYmluZChyb3V0ZU1vZHVsZSk7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT5yb3V0ZU1vZHVsZS5yZW5kZXIocmVxLCByZXMsIHtcbiAgICAgICAgICAgICAgICBxdWVyeToge1xuICAgICAgICAgICAgICAgICAgICAuLi5xdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgLi4ucGFyYW1zXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgICAgICAgYWxsb3dlZFJldmFsaWRhdGVIZWFkZXJLZXlzOiBwcm9jZXNzLmVudi5fX05FWFRfQUxMT1dFRF9SRVZBTElEQVRFX0hFQURFUlMsXG4gICAgICAgICAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlOiBCb29sZWFuKHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREUpLFxuICAgICAgICAgICAgICAgIHRydXN0SG9zdEhlYWRlcjogcHJvY2Vzcy5lbnYuX19ORVhUX1RSVVNUX0hPU1RfSEVBREVSLFxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGdldCB0aGlzIGZyb20gZnJvbSBydW50aW1lIGVudiBzbyBtYW5pZmVzdFxuICAgICAgICAgICAgICAgIC8vIGRvZXNuJ3QgbmVlZCB0byBsb2FkXG4gICAgICAgICAgICAgICAgcHJldmlld1Byb3BzOiBwcmVyZW5kZXJNYW5pZmVzdC5wcmV2aWV3LFxuICAgICAgICAgICAgICAgIHByb3BhZ2F0ZUVycm9yOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkZXY6IHJvdXRlTW9kdWxlLmlzRGV2LFxuICAgICAgICAgICAgICAgIHBhZ2U6IFwiL2FwaS9uZXVyYWwvc3RyZWFtXCIsXG4gICAgICAgICAgICAgICAgaW50ZXJuYWxSZXZhbGlkYXRlOiByb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgb25FcnJvcjogKC4uLmFyZ3MpPT5vblJlcXVlc3RFcnJvcihyZXEsIC4uLmFyZ3MpXG4gICAgICAgICAgICB9KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3NyY1BhZ2V9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3NyY1BhZ2V9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnZva2VSb3V0ZU1vZHVsZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIHdlIHJlLXRocm93IGluIGRldiB0byBzaG93IHRoZSBlcnJvciBvdmVybGF5XG4gICAgICAgIGlmIChyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRoaXMgaXMgdGVjaG5pY2FsbHkgYW4gaW52YXJpYW50IGFzIGVycm9yIGhhbmRsaW5nXG4gICAgICAgIC8vIHNob3VsZCBiZSBkb25lIGluc2lkZSBvZiBhcGktcmVzb2x2ZXIgb25FcnJvclxuICAgICAgICBzZW5kRXJyb3IocmVzLCA1MDAsICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InKTtcbiAgICB9IGZpbmFsbHl7XG4gICAgICAgIC8vIFdlIGRvbid0IGFsbG93IGFueSB3YWl0VW50aWwgd29yayBpbiBwYWdlcyBBUEkgcm91dGVzIGN1cnJlbnRseVxuICAgICAgICAvLyBzbyBpZiBjYWxsYmFjayBpcyBwcmVzZW50IHJldHVybiB3aXRoIHJlc29sdmVkIHByb21pc2Ugc2luY2Ugbm9cbiAgICAgICAgLy8gcGVuZGluZyB3b3JrXG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fneural%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cneural%5Cstream.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/neural/stream.ts":
/*!************************************!*\
  !*** ./pages/api/neural/stream.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _scing_bane_server_baneGuards__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @scing/bane/server/baneGuards */ \"(api-node)/../scing/bane/server/baneGuards.ts\");\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nfunction clamp01(n) {\n    return Math.max(0, Math.min(1, n));\n}\nfunction makeEvent(ts) {\n    const phase = ts / 1000 % (Math.PI * 2);\n    const intensity = clamp01(0.55 + 0.35 * Math.sin(phase));\n    const modes = [\n        'think',\n        'speak',\n        'alert',\n        'idle'\n    ];\n    const mode = modes[Math.floor(ts / 2500 % modes.length)];\n    const channels = {\n        lari: mode === 'think' ? 1 : mode === 'idle' ? 0.35 : 0.15,\n        bane: mode === 'alert' ? 1 : 0.1,\n        io: mode === 'speak' ? 0.75 : 0.25\n    };\n    return {\n        ts,\n        source: 'neural-backend-stub',\n        mode,\n        intensity,\n        channels,\n        payload: {\n            text: mode === 'speak' ? 'demo: speaking' : mode === 'think' ? 'demo: thinking' : undefined,\n            tags: [\n                'demo',\n                `mode:${mode}`\n            ]\n        }\n    };\n}\nfunction writeEvent(res, evt) {\n    res.write(`data: ${JSON.stringify(evt)}\\n\\n`);\n}\nfunction handler(req, res) {\n    res.setHeader('Access-Control-Allow-Origin', '*');\n    res.setHeader('Access-Control-Allow-Methods', 'GET, OPTIONS');\n    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');\n    if (req.method === 'OPTIONS') {\n        res.status(204).end();\n        return;\n    }\n    const host = typeof req.headers.host === 'string' ? req.headers.host : 'localhost';\n    const path = req.url ? new URL(req.url, `http://${host}`).pathname : '/api/neural/stream';\n    const identityId = typeof req.headers['x-bane-identity'] === 'string' ? req.headers['x-bane-identity'] : undefined;\n    const capsHeader = typeof req.headers['x-bane-capabilities'] === 'string' ? req.headers['x-bane-capabilities'] : '';\n    const capabilities = capsHeader ? capsHeader.split(',').map((s)=>s.trim()).filter(Boolean) : undefined;\n    const decision = (0,_scing_bane_server_baneGuards__WEBPACK_IMPORTED_MODULE_0__.baneHttpGuard)({\n        path,\n        bodyText: '',\n        identityId,\n        capabilities,\n        sessionIntegrity: identityId ? {\n            nonceOk: true,\n            signatureOk: true,\n            tokenFresh: true\n        } : {\n            nonceOk: false,\n            signatureOk: false,\n            tokenFresh: false\n        }\n    });\n    if (!decision.ok) {\n        res.setHeader('x-bane-trace-id', decision.traceId);\n        if (decision.retryAfterMs) res.setHeader('retry-after', String(Math.ceil(decision.retryAfterMs / 1000)));\n        res.status(decision.status).json({\n            ok: false,\n            message: decision.message,\n            traceId: decision.traceId\n        });\n        return;\n    }\n    res.setHeader('x-bane-trace-id', decision.traceId);\n    res.writeHead(200, {\n        'Content-Type': 'text/event-stream; charset=utf-8',\n        'Cache-Control': 'no-cache, no-transform',\n        Connection: 'keep-alive'\n    });\n    // Flush headers early.\n    res.flushHeaders?.();\n    // Avoid server-side timeouts killing the stream.\n    try {\n        req.socket.setTimeout(0);\n    } catch  {\n    // ignore\n    }\n    // Initial event.\n    writeEvent(res, makeEvent(Date.now()));\n    // Emit every 5001000ms (jittered).\n    let closed = false;\n    const timers = new Set();\n    const schedule = ()=>{\n        if (closed) return;\n        const delay = 500 + Math.floor(Date.now() % 500);\n        const t = setTimeout(()=>{\n            if (closed) return;\n            // Comment line as keep-alive for proxies.\n            res.write(`: ping ${Date.now()}\\n\\n`);\n            writeEvent(res, makeEvent(Date.now()));\n            schedule();\n        }, delay);\n        timers.add(t);\n    };\n    schedule();\n    const onClose = ()=>{\n        closed = true;\n        for (const t of timers)clearTimeout(t);\n        timers.clear();\n        res.end();\n    };\n    req.on('close', onClose);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9uZXVyYWwvc3RyZWFtLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUM4RDtBQXFCdkQsTUFBTUMsU0FBUztJQUNwQkMsS0FBSztRQUNIQyxZQUFZO0lBQ2Q7QUFDRixFQUFFO0FBRUYsU0FBU0MsUUFBUUMsQ0FBUztJQUN4QixPQUFPQyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEdBQUdIO0FBQ2pDO0FBRUEsU0FBU0ksVUFBVUMsRUFBVTtJQUMzQixNQUFNQyxRQUFRLEtBQU0sT0FBU0wsQ0FBQUEsS0FBS00sRUFBRSxHQUFHO0lBQ3ZDLE1BQU1DLFlBQVlULFFBQVEsT0FBTyxPQUFPRSxLQUFLUSxHQUFHLENBQUNIO0lBRWpELE1BQU1JLFFBQXNCO1FBQUM7UUFBUztRQUFTO1FBQVM7S0FBTztJQUMvRCxNQUFNQyxPQUFPRCxLQUFLLENBQUNULEtBQUtXLEtBQUssQ0FBQyxLQUFNLE9BQVFGLE1BQU1HLE1BQU0sRUFBRTtJQUUxRCxNQUFNQyxXQUFXO1FBQ2ZDLE1BQU1KLFNBQVMsVUFBVSxJQUFJQSxTQUFTLFNBQVMsT0FBTztRQUN0REssTUFBTUwsU0FBUyxVQUFVLElBQUk7UUFDN0JNLElBQUlOLFNBQVMsVUFBVSxPQUFPO0lBQ2hDO0lBRUEsT0FBTztRQUNMTjtRQUNBYSxRQUFRO1FBQ1JQO1FBQ0FIO1FBQ0FNO1FBQ0FLLFNBQVM7WUFDUEMsTUFBTVQsU0FBUyxVQUFVLG1CQUFtQkEsU0FBUyxVQUFVLG1CQUFtQlU7WUFDbEZDLE1BQU07Z0JBQUM7Z0JBQVEsQ0FBQyxLQUFLLEVBQUVYLE1BQU07YUFBQztRQUNoQztJQUNGO0FBQ0Y7QUFFQSxTQUFTWSxXQUFXQyxHQUFvQixFQUFFQyxHQUFnQjtJQUN4REQsSUFBSUUsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFQyxLQUFLQyxTQUFTLENBQUNILEtBQUssSUFBSSxDQUFDO0FBQzlDO0FBRWUsU0FBU0ksUUFBUUMsR0FBbUIsRUFBRU4sR0FBb0I7SUFDdkVBLElBQUlPLFNBQVMsQ0FBQywrQkFBK0I7SUFDN0NQLElBQUlPLFNBQVMsQ0FBQyxnQ0FBZ0M7SUFDOUNQLElBQUlPLFNBQVMsQ0FBQyxnQ0FBZ0M7SUFFOUMsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFdBQVc7UUFDNUJSLElBQUlTLE1BQU0sQ0FBQyxLQUFLQyxHQUFHO1FBQ25CO0lBQ0Y7SUFFQSxNQUFNQyxPQUFPLE9BQU9MLElBQUlNLE9BQU8sQ0FBQ0QsSUFBSSxLQUFLLFdBQVdMLElBQUlNLE9BQU8sQ0FBQ0QsSUFBSSxHQUFHO0lBQ3ZFLE1BQU1FLE9BQU9QLElBQUlRLEdBQUcsR0FBRyxJQUFJQyxJQUFJVCxJQUFJUSxHQUFHLEVBQUUsQ0FBQyxPQUFPLEVBQUVILE1BQU0sRUFBRUssUUFBUSxHQUFHO0lBQ3JFLE1BQU1DLGFBQWEsT0FBT1gsSUFBSU0sT0FBTyxDQUFDLGtCQUFrQixLQUFLLFdBQVdOLElBQUlNLE9BQU8sQ0FBQyxrQkFBa0IsR0FBR2Y7SUFDekcsTUFBTXFCLGFBQWEsT0FBT1osSUFBSU0sT0FBTyxDQUFDLHNCQUFzQixLQUFLLFdBQVdOLElBQUlNLE9BQU8sQ0FBQyxzQkFBc0IsR0FBRztJQUNqSCxNQUFNTyxlQUFlRCxhQUNqQkEsV0FDR0UsS0FBSyxDQUFDLEtBQ05DLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFQyxJQUFJLElBQ2pCQyxNQUFNLENBQUNDLFdBQ1Y1QjtJQUVKLE1BQU02QixXQUFXdkQsNEVBQWFBLENBQUM7UUFDN0IwQztRQUNBYyxVQUFVO1FBQ1ZWO1FBQ0FFO1FBQ0FTLGtCQUFrQlgsYUFDZDtZQUFFWSxTQUFTO1lBQU1DLGFBQWE7WUFBTUMsWUFBWTtRQUFLLElBQ3JEO1lBQUVGLFNBQVM7WUFBT0MsYUFBYTtZQUFPQyxZQUFZO1FBQU07SUFDOUQ7SUFFQSxJQUFJLENBQUNMLFNBQVNNLEVBQUUsRUFBRTtRQUNoQmhDLElBQUlPLFNBQVMsQ0FBQyxtQkFBbUJtQixTQUFTTyxPQUFPO1FBQ2pELElBQUlQLFNBQVNRLFlBQVksRUFBRWxDLElBQUlPLFNBQVMsQ0FBQyxlQUFlNEIsT0FBTzFELEtBQUsyRCxJQUFJLENBQUNWLFNBQVNRLFlBQVksR0FBRztRQUNqR2xDLElBQUlTLE1BQU0sQ0FBQ2lCLFNBQVNqQixNQUFNLEVBQUU0QixJQUFJLENBQUM7WUFBRUwsSUFBSTtZQUFPTSxTQUFTWixTQUFTWSxPQUFPO1lBQUVMLFNBQVNQLFNBQVNPLE9BQU87UUFBQztRQUNuRztJQUNGO0lBRUFqQyxJQUFJTyxTQUFTLENBQUMsbUJBQW1CbUIsU0FBU08sT0FBTztJQUVqRGpDLElBQUl1QyxTQUFTLENBQUMsS0FBSztRQUNqQixnQkFBZ0I7UUFDaEIsaUJBQWlCO1FBQ2pCQyxZQUFZO0lBQ2Q7SUFFQSx1QkFBdUI7SUFDdkJ4QyxJQUFJeUMsWUFBWTtJQUVoQixpREFBaUQ7SUFDakQsSUFBSTtRQUNGbkMsSUFBSW9DLE1BQU0sQ0FBQ0MsVUFBVSxDQUFDO0lBQ3hCLEVBQUUsT0FBTTtJQUNOLFNBQVM7SUFDWDtJQUVBLGlCQUFpQjtJQUNqQjVDLFdBQVdDLEtBQUtwQixVQUFVZ0UsS0FBS0MsR0FBRztJQUVsQyxvQ0FBb0M7SUFDcEMsSUFBSUMsU0FBUztJQUNiLE1BQU1DLFNBQVMsSUFBSUM7SUFFbkIsTUFBTUMsV0FBVztRQUNmLElBQUlILFFBQVE7UUFFWixNQUFNSSxRQUFRLE1BQU16RSxLQUFLVyxLQUFLLENBQUV3RCxLQUFLQyxHQUFHLEtBQUs7UUFDN0MsTUFBTU0sSUFBSVIsV0FBVztZQUNuQixJQUFJRyxRQUFRO1lBRVosMENBQTBDO1lBQzFDOUMsSUFBSUUsS0FBSyxDQUFDLENBQUMsT0FBTyxFQUFFMEMsS0FBS0MsR0FBRyxHQUFHLElBQUksQ0FBQztZQUNwQzlDLFdBQVdDLEtBQUtwQixVQUFVZ0UsS0FBS0MsR0FBRztZQUNsQ0k7UUFDRixHQUFHQztRQUVISCxPQUFPSyxHQUFHLENBQUNEO0lBQ2I7SUFFQUY7SUFFQSxNQUFNSSxVQUFVO1FBQ2RQLFNBQVM7UUFDVCxLQUFLLE1BQU1LLEtBQUtKLE9BQVFPLGFBQWFIO1FBQ3JDSixPQUFPUSxLQUFLO1FBQ1p2RCxJQUFJVSxHQUFHO0lBQ1Q7SUFFQUosSUFBSWtELEVBQUUsQ0FBQyxTQUFTSDtBQUNsQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXN0ZVxcU0NJTkdPU19XT1JLXFxTY2luZ09TXFxjbGllbnRcXHBhZ2VzXFxhcGlcXG5ldXJhbFxcc3RyZWFtLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyBiYW5lSHR0cEd1YXJkIH0gZnJvbSAnQHNjaW5nL2JhbmUvc2VydmVyL2JhbmVHdWFyZHMnO1xyXG5cclxudHlwZSBOZXVyYWxNb2RlID0gJ3RoaW5rJyB8ICdzcGVhaycgfCAnYWxlcnQnIHwgJ2lkbGUnO1xyXG5cclxudHlwZSBOZXVyYWxFdmVudCA9IHtcclxuICB0czogbnVtYmVyO1xyXG4gIHNvdXJjZTogc3RyaW5nO1xyXG4gIG1vZGU6IE5ldXJhbE1vZGU7XHJcbiAgaW50ZW5zaXR5OiBudW1iZXI7XHJcbiAgY2hhbm5lbHM6IHtcclxuICAgIGxhcmk6IG51bWJlcjtcclxuICAgIGJhbmU6IG51bWJlcjtcclxuICAgIGlvOiBudW1iZXI7XHJcbiAgfTtcclxuICBwYXlsb2FkPzoge1xyXG4gICAgdGV4dD86IHN0cmluZztcclxuICAgIHNlc3Npb25JZD86IHN0cmluZztcclxuICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHtcclxuICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxyXG4gIH0sXHJcbn07XHJcblxyXG5mdW5jdGlvbiBjbGFtcDAxKG46IG51bWJlcikge1xyXG4gIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBuKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1ha2VFdmVudCh0czogbnVtYmVyKTogTmV1cmFsRXZlbnQge1xyXG4gIGNvbnN0IHBoYXNlID0gKHRzIC8gMTAwMCkgJSAoTWF0aC5QSSAqIDIpO1xyXG4gIGNvbnN0IGludGVuc2l0eSA9IGNsYW1wMDEoMC41NSArIDAuMzUgKiBNYXRoLnNpbihwaGFzZSkpO1xyXG5cclxuICBjb25zdCBtb2RlczogTmV1cmFsTW9kZVtdID0gWyd0aGluaycsICdzcGVhaycsICdhbGVydCcsICdpZGxlJ107XHJcbiAgY29uc3QgbW9kZSA9IG1vZGVzW01hdGguZmxvb3IoKHRzIC8gMjUwMCkgJSBtb2Rlcy5sZW5ndGgpXTtcclxuXHJcbiAgY29uc3QgY2hhbm5lbHMgPSB7XHJcbiAgICBsYXJpOiBtb2RlID09PSAndGhpbmsnID8gMSA6IG1vZGUgPT09ICdpZGxlJyA/IDAuMzUgOiAwLjE1LFxyXG4gICAgYmFuZTogbW9kZSA9PT0gJ2FsZXJ0JyA/IDEgOiAwLjEsXHJcbiAgICBpbzogbW9kZSA9PT0gJ3NwZWFrJyA/IDAuNzUgOiAwLjI1LFxyXG4gIH07XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB0cyxcclxuICAgIHNvdXJjZTogJ25ldXJhbC1iYWNrZW5kLXN0dWInLFxyXG4gICAgbW9kZSxcclxuICAgIGludGVuc2l0eSxcclxuICAgIGNoYW5uZWxzLFxyXG4gICAgcGF5bG9hZDoge1xyXG4gICAgICB0ZXh0OiBtb2RlID09PSAnc3BlYWsnID8gJ2RlbW86IHNwZWFraW5nJyA6IG1vZGUgPT09ICd0aGluaycgPyAnZGVtbzogdGhpbmtpbmcnIDogdW5kZWZpbmVkLFxyXG4gICAgICB0YWdzOiBbJ2RlbW8nLCBgbW9kZToke21vZGV9YF0sXHJcbiAgICB9LFxyXG4gIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdyaXRlRXZlbnQocmVzOiBOZXh0QXBpUmVzcG9uc2UsIGV2dDogTmV1cmFsRXZlbnQpIHtcclxuICByZXMud3JpdGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZXZ0KX1cXG5cXG5gKTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XHJcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsIE9QVElPTlMnKTtcclxuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJywgJ0NvbnRlbnQtVHlwZScpO1xyXG5cclxuICBpZiAocmVxLm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7XHJcbiAgICByZXMuc3RhdHVzKDIwNCkuZW5kKCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCBob3N0ID0gdHlwZW9mIHJlcS5oZWFkZXJzLmhvc3QgPT09ICdzdHJpbmcnID8gcmVxLmhlYWRlcnMuaG9zdCA6ICdsb2NhbGhvc3QnO1xyXG4gIGNvbnN0IHBhdGggPSByZXEudXJsID8gbmV3IFVSTChyZXEudXJsLCBgaHR0cDovLyR7aG9zdH1gKS5wYXRobmFtZSA6ICcvYXBpL25ldXJhbC9zdHJlYW0nO1xyXG4gIGNvbnN0IGlkZW50aXR5SWQgPSB0eXBlb2YgcmVxLmhlYWRlcnNbJ3gtYmFuZS1pZGVudGl0eSddID09PSAnc3RyaW5nJyA/IHJlcS5oZWFkZXJzWyd4LWJhbmUtaWRlbnRpdHknXSA6IHVuZGVmaW5lZDtcclxuICBjb25zdCBjYXBzSGVhZGVyID0gdHlwZW9mIHJlcS5oZWFkZXJzWyd4LWJhbmUtY2FwYWJpbGl0aWVzJ10gPT09ICdzdHJpbmcnID8gcmVxLmhlYWRlcnNbJ3gtYmFuZS1jYXBhYmlsaXRpZXMnXSA6ICcnO1xyXG4gIGNvbnN0IGNhcGFiaWxpdGllcyA9IGNhcHNIZWFkZXJcclxuICAgID8gY2Fwc0hlYWRlclxyXG4gICAgICAgIC5zcGxpdCgnLCcpXHJcbiAgICAgICAgLm1hcCgocykgPT4gcy50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgOiB1bmRlZmluZWQ7XHJcblxyXG4gIGNvbnN0IGRlY2lzaW9uID0gYmFuZUh0dHBHdWFyZCh7XHJcbiAgICBwYXRoLFxyXG4gICAgYm9keVRleHQ6ICcnLFxyXG4gICAgaWRlbnRpdHlJZCxcclxuICAgIGNhcGFiaWxpdGllcyxcclxuICAgIHNlc3Npb25JbnRlZ3JpdHk6IGlkZW50aXR5SWRcclxuICAgICAgPyB7IG5vbmNlT2s6IHRydWUsIHNpZ25hdHVyZU9rOiB0cnVlLCB0b2tlbkZyZXNoOiB0cnVlIH1cclxuICAgICAgOiB7IG5vbmNlT2s6IGZhbHNlLCBzaWduYXR1cmVPazogZmFsc2UsIHRva2VuRnJlc2g6IGZhbHNlIH0sXHJcbiAgfSk7XHJcblxyXG4gIGlmICghZGVjaXNpb24ub2spIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ3gtYmFuZS10cmFjZS1pZCcsIGRlY2lzaW9uLnRyYWNlSWQpO1xyXG4gICAgaWYgKGRlY2lzaW9uLnJldHJ5QWZ0ZXJNcykgcmVzLnNldEhlYWRlcigncmV0cnktYWZ0ZXInLCBTdHJpbmcoTWF0aC5jZWlsKGRlY2lzaW9uLnJldHJ5QWZ0ZXJNcyAvIDEwMDApKSk7XHJcbiAgICByZXMuc3RhdHVzKGRlY2lzaW9uLnN0YXR1cykuanNvbih7IG9rOiBmYWxzZSwgbWVzc2FnZTogZGVjaXNpb24ubWVzc2FnZSwgdHJhY2VJZDogZGVjaXNpb24udHJhY2VJZCB9KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHJlcy5zZXRIZWFkZXIoJ3gtYmFuZS10cmFjZS1pZCcsIGRlY2lzaW9uLnRyYWNlSWQpO1xyXG5cclxuICByZXMud3JpdGVIZWFkKDIwMCwge1xyXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L2V2ZW50LXN0cmVhbTsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSwgbm8tdHJhbnNmb3JtJyxcclxuICAgIENvbm5lY3Rpb246ICdrZWVwLWFsaXZlJyxcclxuICB9KTtcclxuXHJcbiAgLy8gRmx1c2ggaGVhZGVycyBlYXJseS5cclxuICByZXMuZmx1c2hIZWFkZXJzPy4oKTtcclxuXHJcbiAgLy8gQXZvaWQgc2VydmVyLXNpZGUgdGltZW91dHMga2lsbGluZyB0aGUgc3RyZWFtLlxyXG4gIHRyeSB7XHJcbiAgICByZXEuc29ja2V0LnNldFRpbWVvdXQoMCk7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICAvLyBpZ25vcmVcclxuICB9XHJcblxyXG4gIC8vIEluaXRpYWwgZXZlbnQuXHJcbiAgd3JpdGVFdmVudChyZXMsIG1ha2VFdmVudChEYXRlLm5vdygpKSk7XHJcblxyXG4gIC8vIEVtaXQgZXZlcnkgNTAw4oCTMTAwMG1zIChqaXR0ZXJlZCkuXHJcbiAgbGV0IGNsb3NlZCA9IGZhbHNlO1xyXG4gIGNvbnN0IHRpbWVycyA9IG5ldyBTZXQ8Tm9kZUpTLlRpbWVvdXQ+KCk7XHJcblxyXG4gIGNvbnN0IHNjaGVkdWxlID0gKCkgPT4ge1xyXG4gICAgaWYgKGNsb3NlZCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGRlbGF5ID0gNTAwICsgTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAlIDUwMCkpO1xyXG4gICAgY29uc3QgdCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBpZiAoY2xvc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAvLyBDb21tZW50IGxpbmUgYXMga2VlcC1hbGl2ZSBmb3IgcHJveGllcy5cclxuICAgICAgcmVzLndyaXRlKGA6IHBpbmcgJHtEYXRlLm5vdygpfVxcblxcbmApO1xyXG4gICAgICB3cml0ZUV2ZW50KHJlcywgbWFrZUV2ZW50KERhdGUubm93KCkpKTtcclxuICAgICAgc2NoZWR1bGUoKTtcclxuICAgIH0sIGRlbGF5KTtcclxuXHJcbiAgICB0aW1lcnMuYWRkKHQpO1xyXG4gIH07XHJcblxyXG4gIHNjaGVkdWxlKCk7XHJcblxyXG4gIGNvbnN0IG9uQ2xvc2UgPSAoKSA9PiB7XHJcbiAgICBjbG9zZWQgPSB0cnVlO1xyXG4gICAgZm9yIChjb25zdCB0IG9mIHRpbWVycykgY2xlYXJUaW1lb3V0KHQpO1xyXG4gICAgdGltZXJzLmNsZWFyKCk7XHJcbiAgICByZXMuZW5kKCk7XHJcbiAgfTtcclxuXHJcbiAgcmVxLm9uKCdjbG9zZScsIG9uQ2xvc2UpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJiYW5lSHR0cEd1YXJkIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsImNsYW1wMDEiLCJuIiwiTWF0aCIsIm1heCIsIm1pbiIsIm1ha2VFdmVudCIsInRzIiwicGhhc2UiLCJQSSIsImludGVuc2l0eSIsInNpbiIsIm1vZGVzIiwibW9kZSIsImZsb29yIiwibGVuZ3RoIiwiY2hhbm5lbHMiLCJsYXJpIiwiYmFuZSIsImlvIiwic291cmNlIiwicGF5bG9hZCIsInRleHQiLCJ1bmRlZmluZWQiLCJ0YWdzIiwid3JpdGVFdmVudCIsInJlcyIsImV2dCIsIndyaXRlIiwiSlNPTiIsInN0cmluZ2lmeSIsImhhbmRsZXIiLCJyZXEiLCJzZXRIZWFkZXIiLCJtZXRob2QiLCJzdGF0dXMiLCJlbmQiLCJob3N0IiwiaGVhZGVycyIsInBhdGgiLCJ1cmwiLCJVUkwiLCJwYXRobmFtZSIsImlkZW50aXR5SWQiLCJjYXBzSGVhZGVyIiwiY2FwYWJpbGl0aWVzIiwic3BsaXQiLCJtYXAiLCJzIiwidHJpbSIsImZpbHRlciIsIkJvb2xlYW4iLCJkZWNpc2lvbiIsImJvZHlUZXh0Iiwic2Vzc2lvbkludGVncml0eSIsIm5vbmNlT2siLCJzaWduYXR1cmVPayIsInRva2VuRnJlc2giLCJvayIsInRyYWNlSWQiLCJyZXRyeUFmdGVyTXMiLCJTdHJpbmciLCJjZWlsIiwianNvbiIsIm1lc3NhZ2UiLCJ3cml0ZUhlYWQiLCJDb25uZWN0aW9uIiwiZmx1c2hIZWFkZXJzIiwic29ja2V0Iiwic2V0VGltZW91dCIsIkRhdGUiLCJub3ciLCJjbG9zZWQiLCJ0aW1lcnMiLCJTZXQiLCJzY2hlZHVsZSIsImRlbGF5IiwidCIsImFkZCIsIm9uQ2xvc2UiLCJjbGVhclRpbWVvdXQiLCJjbGVhciIsIm9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/neural/stream.ts\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fneural%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cneural%5Cstream.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();